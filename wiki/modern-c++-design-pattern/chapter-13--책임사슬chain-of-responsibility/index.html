<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://unpkg.com/simpledotcss/simple.css><link rel=stylesheet href=/css/main.css><meta name=generator content="Hugo 0.140.0"><meta name=description content="minuk.dev wiki"><meta name=keywords content="hugo,site,new"><meta name=author content="Min-Uk.Lee"><title>Modern C++ Design Pattern/Chatper 13. 책임사슬(Chain of Responsibility) |
minuk dev wiki
</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script></head><body><header class=header><div class=header_left><a href=/><img class=logo src=/images/Rb.png alt=logo>
MinUk.Dev</a></div><div class=header_middle>Modern C++ Design Pattern/Chatper 13. 책임사슬(Chain of Responsibility)</div></header><main><article class=main><div class=title><h1 class=title-header>Modern C++ Design Pattern/Chatper 13. 책임사슬(Chain of Responsibility)</h1></div><a href=https://github.com/minuk-dev/minuk-dev.github.io/blame/master/content/wiki/Modern%20C++%20Design%20Pattern/Chapter%2013-%20%ec%b1%85%ec%9e%84%ec%82%ac%ec%8a%ac%28Chain%20of%20Responsibility%29.md><h5>created : Sat, 18 Apr 2020 22:14:11 +0900</h5><h5>modified : Sat, 26 Sep 2020 23:22:30 +0900</h5></a><div class=article-meta><div class="breadcumb content"><i class="bi bi-folder"></i>
[[Modern C++ Design Pattern]]</div></div><div class=list-terms><ul><i class="bi bi-tags" title=Tags></i>
<a href=/tags/cpp class=tag-btn>cpp</a>
<a href=/tags/design%20pattern class=tag-btn>design pattern</a>
<a href=/tags/chain%20of%20responsibility class=tag-btn>chain of responsibility</a></ul></div><aside class=navbar id=nav-toc style=text-align:left><nav id=TableOfContents><ul><li><a href=#시나리오>시나리오</a></li><li><a href=#포인터-사슬>포인터 사슬</a></li><li><a href=#브로커-사슬>브로커 사슬</a></li><li><a href=#요약>요약</a></li></ul></nav></aside><div class=content><h2 id=시나리오>시나리오</h2><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=struct%20Creature%0a%7b%0a%20%20string%20name;%0a%20%20int%20attack,%20defense;%0a%20%20//%20Constructor,%20operator...%0a%7d;>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Creature</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  string name;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> attack, defense;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Constructor, operator...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};</span></span></code></pre></div></div><h2 id=포인터-사슬>포인터 사슬</h2><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=#ZgotmplZ>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CreatureModifier</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  CreatureModifier<span style=color:#f92672>*</span> next{<span style=color:#66d9ef>nullptr</span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>protected</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  Creature<span style=color:#f92672>&amp;</span> creture; <span style=color:#75715e>// reference, pointer or shared_ptr
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>explicit</span> CreatureModifier(Creature<span style=color:#f92672>&amp;</span> creature)
</span></span><span style=display:flex><span>    <span style=color:#f92672>:</span> creature(creture) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>add</span>(CreatureModifier<span style=color:#f92672>*</span> cm)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (next) next<span style=color:#f92672>-&gt;</span>add(cm);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> next <span style=color:#f92672>=</span>cm;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>handle</span>()
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (next) next<span style=color:#f92672>-&gt;</span>handle();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};</span></span></code></pre></div></div><ul><li>참조를 넘겨받아 저장하고 변경할 준비</li><li>추상 클래스가 아님</li><li><code>next</code>는 다음 변경 작업을 가리킴</li><li><code>add()</code>를 통해서 작업 사슬에 연결하여 추가</li><li><code>handle()</code> 맴버 함수는 단순히 다음 항목을 처리한다. 원한다면 오버라이딩해서
처리한다.</li></ul><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=#ZgotmplZ>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DoubleAttackModifier</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> CreatureModifier
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>explicit</span> DoubleAttackModifier(Creature<span style=color:#f92672>&amp;</span> creature)
</span></span><span style=display:flex><span>    <span style=color:#f92672>:</span> CreatureModifier(creature) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>handle</span>() <span style=color:#66d9ef>override</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    creature.attack <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    CreatureModifier<span style=color:#f92672>::</span>handle();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};</span></span></code></pre></div></div><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=#ZgotmplZ>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>NoBonusesModifier</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> CreatureModifier
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>explicit</span> NoBonusesModifer(Creature<span style=color:#f92672>&amp;</span> creature)
</span></span><span style=display:flex><span>    <span style=color:#f92672>:</span> CreatureModifier(creature) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>handle</span>() <span style=color:#66d9ef>override</span>
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Do Nothing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>};</span></span></code></pre></div></div><h2 id=브로커-사슬>브로커 사슬</h2><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="struct%20Game%0a%7b%0a%20%20signal%3cvoid%28Query&%29%3e%20queries;%20//%20Boost.Signals2%0a%7d;%0a%0astruct%20Query%0a%7b%0a%20%20string%20creature_name;%0a%20%20enum%20Argumnet%20%7b%20attack,%20defense%20%7d%20argument;%0a%20%20int%20result;%0a%7d;%0a%0aclass%20Creature%0a%7b%0a%20%20Game&%20game;%0a%20%20int%20attack,%20defense;%0apublic:%0a%20%20string%20name;%0a%20%20Creature%28Game&%20game,%20...%29%20:%20game%7bgame%7d,%20...%20%7b%20...%20%7d%0a%20%20//%20Other%20Members%0a%7d;%0a%0aint%20Creature::get_attack%28%29%20const%0a%7b%0a%20%20Query%20q%7b%20name,%20Query::Argument::attack,%20attack%20%7d;%0a%20%20game.queries%28q%29;%0a%20%20return%20q.result;%0a%7d%0a%0aclass%20CreatureModifier%0a%7b%0a%20%20Game&%20game;%0a%20%20Creature&%20creature;%0apublic:%0a%20%20CreatureModifier%28Game&%20game,%20Creature&%20creature%29%0a%20%20%20%20:%20game%28game%29,%20creature%28creature%29%20%7b%7d%0a%7d;%0a%0aclass%20DoubleAttackModifier%20:%20public%20CreatureModifier%0a%7b%0a%20%20connection%20conn;%0apublic:%0a%20%20DoubleAttackModifier%28Game&%20game,%20Creature&%20creature%29%0a%20%20%20%20:%20CreatureModifier%28game,%20creature%29%0a%20%20%7b%0a%20%20%20%20conn%20=%20game.queries.connect%28[&]%28Query&%20q%29%20%7b%0a%20%20%20%20%20%20if%20%28q.creature_name%20==%20creature.name%20&&%0a%20%20%20%20%20%20%20%20q.argument%20==%20Query::Argument::attack%29%0a%20%20%20%20%20%20%20%20q.result%20*=%202;%0a%20%20%20%20%7d%29%0a%20%20%7d%0a%0a%20%20~DoubleAttackModifier%28%29%20%7b%20conn.disconnect%28%29;%20%7d%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Game</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  signal<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>void</span>(Query<span style=color:#f92672>&amp;</span>)<span style=color:#f92672>&gt;</span> queries; <span style=color:#75715e>// Boost.Signals2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Query</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  string creature_name;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>Argumnet</span> { attack, defense } argument;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> result;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Creature</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  Game<span style=color:#f92672>&amp;</span> game;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> attack, defense;
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  string name;
</span></span><span style=display:flex><span>  Creature(Game<span style=color:#f92672>&amp;</span> game, ...) <span style=color:#f92672>:</span> game{game}, ... { ... }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Other Members
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> Creature<span style=color:#f92672>::</span>get_attack() <span style=color:#66d9ef>const</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  Query q{ name, Query<span style=color:#f92672>::</span>Argument<span style=color:#f92672>::</span>attack, attack };
</span></span><span style=display:flex><span>  game.queries(q);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> q.result;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CreatureModifier</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  Game<span style=color:#f92672>&amp;</span> game;
</span></span><span style=display:flex><span>  Creature<span style=color:#f92672>&amp;</span> creature;
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  CreatureModifier(Game<span style=color:#f92672>&amp;</span> game, Creature<span style=color:#f92672>&amp;</span> creature)
</span></span><span style=display:flex><span>    <span style=color:#f92672>:</span> game(game), creature(creature) {}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DoubleAttackModifier</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> CreatureModifier
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  connection conn;
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  DoubleAttackModifier(Game<span style=color:#f92672>&amp;</span> game, Creature<span style=color:#f92672>&amp;</span> creature)
</span></span><span style=display:flex><span>    <span style=color:#f92672>:</span> CreatureModifier(game, creature)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    conn <span style=color:#f92672>=</span> game.queries.connect([<span style=color:#f92672>&amp;</span>](Query<span style=color:#f92672>&amp;</span> q) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (q.creature_name <span style=color:#f92672>==</span> creature.name <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>        q.argument <span style=color:#f92672>==</span> Query<span style=color:#f92672>::</span>Argument<span style=color:#f92672>::</span>attack)
</span></span><span style=display:flex><span>        q.result <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>~</span>DoubleAttackModifier() { conn.disconnect(); }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><h2 id=요약>요약</h2><ul><li>컴포넌트들이 어떤 명령이나 조회 작업을 차례로 처리할 수 있게 하는 매우 단순한
디자인 패턴이다.</li><li>이론적으로 포인터 사슬은 보통 <code>vector</code>나 <code>list</code>로 대체될 수 있다.</li><li>좀 더 복잡한 브로커 사슬의 구현에서는 매개자 패턴과 관찰자 패턴을 활용한다.</li></ul></div><hr><div class=list-files><ul class=section-tree></ul></div></article><script src=/js/wikilink.js></script><div><script src=https://utteranc.es/client.js repo=minuk-dev/minuk-dev.github.io issue-term=pathname theme=github-dark crossorigin=anonymous async></script></div></main><footer class=footer><div class=footer-left></div><div class=footer-right><ul class=social><li><a href=/about>About</a></li><li><a href=https://github.com/minuk-dev>Github</a></li></ul></div></footer></body><script src=/js/dir_toggle.js></script><script src=/js/codeblock_copy.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css><script type=module>
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs";
mermaid.initialize({
  startOnLoad: true,
  theme: "dark",
});
</script></html>
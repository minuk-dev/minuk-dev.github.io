<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Deep Dive into Minikube</title><style>html body{font-family:raleway,sans-serif;background-color:#fff}:root{--accent:#00a3d2;--border-width:5px}</style><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/copy-btn.css><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script src=/js/copy-btn.js></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script>$(document).on("click",function(){$(".collapse").collapse("hide")})</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-98056974-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-98056974-1")</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><meta name=google-site-verification content="g_3tJyj-KkW-_wKx7Ij5GimHV1nKPZXetCz8ydbBAfA"></head><body><nav class="navbar navbar-default navbar-fixed-top"><div class=container><div class=navbar-header><a class="navbar-brand visible-xs" href=#>Deep Dive into Minikube
</a><button class=navbar-toggle data-target=.navbar-collapse data-toggle=collapse>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/wiki/>Wiki</a></li><li><a href=/posts/>Posts</a></li><li><a href=/about/>About</a></li></ul></div></div></nav><main><div class=navigator style=display:flex><div style=display:flex><div class=parent-doc style=flex:none><button class="btn btn-link" onclick='(function(e){e.querySelector("a").click()})(this)'>
<i class="fa fa-arrow-left"></i>
[[kubecon]]</button></div></div></div><div><h2>Deep Dive into Minikube</h2><a href=https://github.com/minuk-dev/minuk-dev.github.io/blame/master/content/wiki/deep-dive-into-minikube.md><h5>created : Wed, 21 Sep 2022 01:59:49 +0900</h5><h5>modified : Wed, 21 Sep 2022 02:58:44 +0900</h5></a><a href=https://minuk.dev/tags/kubecon><kbd class=item-tag>kubecon</kbd></a>
<a href=https://minuk.dev/tags/k8s><kbd class=item-tag>k8s</kbd></a>
<a href=https://minuk.dev/tags/kubernetes><kbd class=item-tag>kubernetes</kbd></a>
<a href=https://minuk.dev/tags/minikube><kbd class=item-tag>minikube</kbd></a></div><aside class=navbar id=nav-toc style=text-align:left><nav id=TableOfContents><ul><li><a href=#it-all-started-in-2016>It all started in 2016</a><ul><li><a href=#ok-google--assist-the-developers-please>OK Google &mldr; Assist the developers please!</a></li></ul></li><li><a href=#primary-goal>Primary Goal</a><ul><li><a href=#our-first-integration-tests-ran-in-the-office>Our first Integration tests ran in the office.</a></li><li><a href=#it-takes-a-village-to-test-minikube>It takes a village to test Minikube</a></li></ul></li><li><a href=#flake-rate-system>Flake Rate System</a><ul><li><a href=#what-is-gopogh---reducing-squinting-for-go-developers>What is Gopogh? - Reducing Squinting for go developers</a></li></ul></li><li><a href=#minikube-speaks-your-language>Minikube speaks your language</a></li><li><a href=#checkout-minikubes-side-project>Checkout Minikube&rsquo;s Side Project!</a></li><li><a href=#the-story-of-kbuernetes-124>The story of Kbuernetes 1.24&mldr;</a><ul><li><a href=#minikube-continues-to-support-docker-env>Minikube continues to support docker-env</a></li></ul></li><li><a href=#minikube-cpu-usage-overtime>Minikube CPU usage overtime</a></li><li><a href=#benchmarking>Benchmarking</a></li><li><a href=#minikubes-base-image>Minikube&rsquo;s Base Image</a><ul><li><a href=#did-you-know-minikube-maintains-its-own-linux>Did you know minikube maintains its own linux?</a></li><li><a href=#types-of-minikube-users>Types of Minikube users</a></li><li><a href=#new-category-of-minikube-users>New category of minikube users!</a></li><li><a href=#minikube-start--no-kubernetes>minikube start -no-kubernetes?</a></li><li><a href=#top-differentiators-minikube-vs-similar-tools>Top differentiators Minikube vs similar tools</a></li></ul></li><li><a href=#advantages-of-vm-drivers>Advantages of VM Drivers</a></li><li><a href=#tens-of-survey-requests-for-vm-driver-on-m1arm64>Tens of Survey Requests for VM driver on M1/Arm64</a><ul><li><a href=#1-try-qemu-driver-on-apple-m1>1. Try Qemu Driver on Apple M1</a></li><li><a href=#challenges-of-adding-arm64-iso>Challenges of adding ARM64 ISO</a></li><li><a href=#2-try-early-prototype-of-minikube-gui>2. Try Early prototype of Minikube-GUI</a></li></ul></li><li><a href=#개인-생각>개인 생각</a></li></ul></nav></aside><div align=start class=content data-spy=scroll data-offset=20 data-target=#nav-toc style=position:relative><ul><li><a href=https://youtu.be/Iyq_MlSku-I>원본</a></li></ul><h2 id=it-all-started-in-2016>It all started in 2016</h2><ul><li>Minkube was created 6 years ago by Google to alleviate the difficulties that developers had when setting up a Kubernetes environment for local development</li></ul><h3 id=ok-google--assist-the-developers-please>OK Google &mldr; Assist the developers please!</h3><ul><li>Google has continued to evolve the Minikube project to grow the Kubernetes ecosystem by making Kubernetes development more attractive and frictionless</li></ul><h2 id=primary-goal>Primary Goal</h2><ul><li>make it simple to run Kubernetes locally for learning and day-to-day development, testing & debugging workflows:<ol><li>inclusive</li><li>Community-driven</li><li>User-friendly</li><li>Support all Kubernetes features</li><li>Cross-platform</li><li>Reliable</li><li>High Performance</li><li>Developer Focused</li></ol></li></ul><h3 id=our-first-integration-tests-ran-in-the-office>Our first Integration tests ran in the office.</h3><ul><li>Minikube&rsquo;s VM drivers needed Baremetal servers with virtualization enabled.</li><li>Nested Virtualization only available for certain Linux Distros</li></ul><h3 id=it-takes-a-village-to-test-minikube>It takes a village to test Minikube</h3><ul><li>Minikube is the most tested local Kubernetes tool.:<ul><li>46 Self-hosted CI VMs in 5 different clouds (GCP, AWS, Equinix Metal, Azure, Macstadium) + Prow and Github Action</li><li>296 end to end tests in integration testing suite</li><li>100 unit tests</li></ul></li></ul><h2 id=flake-rate-system>Flake Rate System</h2><ul><li>Problem:<ul><li>Running hundreds of test cases on dozen platforms, there are always some flaky test that fail 10-15% of the time on Master.</li><li>Reviewer had to have a lot of context to approve a PR with failed test.</li></ul></li><li>Solution:<ul><li>Run tests on master regularly, generate failed rate on master.</li><li>On each PR comments how many of the Failed tests are a known Flake</li><li>Automatically create Github issue for frequently failing test.</li><li>Generate Visualized</li></ul></li><li>Minikube&rsquo;s Flake Rate System is built on top of Gopogh</li></ul><h3 id=what-is-gopogh---reducing-squinting-for-go-developers>What is Gopogh? - Reducing Squinting for go developers</h3><ul><li>Problem: Failed minikube test logs come with thousands of lines of post mortem logs low-level system logs. (sometimes 10K lines) that makes it very hard to see what log is for what!:<ul><li>Created in a hackathon with a funny name</li></ul></li></ul><h2 id=minikube-speaks-your-language>Minikube speaks your language</h2><h2 id=checkout-minikubes-side-project>Checkout Minikube&rsquo;s Side Project!</h2><ul><li>Slow jam</li><li>Triage Party</li><li>Gopogh</li><li>Time To k8s</li><li>Minikube-CI</li><li>Pull Sheet</li></ul><h2 id=the-story-of-kbuernetes-124>The story of Kbuernetes 1.24&mldr;</h2><ul><li>Kubernetes removed the code for supporting docker runtime</li><li>CNI&mldr;</li><li>Cgroup V2&mldr;</li></ul><h3 id=minikube-continues-to-support-docker-env>Minikube continues to support docker-env</h3><ul><li>Users love &ldquo;min8ikube docker-env&rdquo;(building images directly on the cluster) and we can&rsquo;t blame them, it is 36X time faster than Image load.</li></ul><h2 id=minikube-cpu-usage-overtime>Minikube CPU usage overtime</h2><ul><li>Save energy by using these Minikube features Features that can save energy:<ul><li>try &ldquo;minikube pause&rdquo;</li><li>Auto-Pause Addon</li></ul></li></ul><h2 id=benchmarking>Benchmarking</h2><ul><li>Measure Weekly/Daily and per release</li><li>Measure agsinst similar tools</li></ul><h2 id=minikubes-base-image>Minikube&rsquo;s Base Image</h2><h3 id=did-you-know-minikube-maintains-its-own-linux>Did you know minikube maintains its own linux?</h3><ul><li>Hand Crafted - Just enough Linux for Kubernetes</li><li>Small ISO - 280MB</li><li>Based on CoreOS BUildroot</li><li>Might Graduate out of Minikube to is own repo</li><li>Advantages:<ul><li>Granular control of enabled kernel modules and packages</li><li>Tailored for Kubernetes</li></ul></li></ul><h3 id=types-of-minikube-users>Types of Minikube users</h3><ul><li>Learn Kubernetes</li><li>Develop on Kubernetes</li><li>Test/CI</li></ul><h3 id=new-category-of-minikube-users>New category of minikube users!</h3><ul><li>Tens of Blog posts, tweets and survey comments shows that a lot of new users are using minikube merely as a Docker Desktop Replacement.</li></ul><h3 id=minikube-start--no-kubernetes>minikube start -no-kubernetes?</h3><ul><li>IMO : ?? what?</li></ul><h3 id=top-differentiators-minikube-vs-similar-tools>Top differentiators Minikube vs similar tools</h3><ul><li>Multiple container runtimes for Kubernetes</li><li>Direct access to container runtime for faster image build</li><li>Integration tests (most comprehensive)</li></ul><h2 id=advantages-of-vm-drivers>Advantages of VM Drivers</h2><ul><li>No need to have Docker Desktop License</li><li>Less CPU usage</li><li>You can hit the port directly (for example if you have a hotspot service running on port 80 you can curl $(minikube ip):80 on your machine vs Docker Drive that by design needs to be assigned a random port.)</li></ul><h2 id=tens-of-survey-requests-for-vm-driver-on-m1arm64>Tens of Survey Requests for VM driver on M1/Arm64</h2><h3 id=1-try-qemu-driver-on-apple-m1>1. Try Qemu Driver on Apple M1</h3><ul><li>Qemu driver is finally available for Arm64 and M1</li><li>This means on Arm-based machines like Apple M1 you could have a Kbuernetes experience without having to have Docker Desktop.</li></ul><h3 id=challenges-of-adding-arm64-iso>Challenges of adding ARM64 ISO</h3><ul><li>Slow iteration of testing</li><li>BIOS/EFI</li><li>AppArmor</li><li>Lack of team familiarity with Buildroot</li></ul><h3 id=2-try-early-prototype-of-minikube-gui>2. Try Early prototype of Minikube-GUI</h3><ul><li>Go to minikube website</li><li>Search for Minikube GUI</li><li>Things to try:<ul><li>Simplified View (one cluster)</li><li>Advanced View (multi cluster)</li><li>Right click tray icon</li></ul></li></ul><h2 id=개인-생각>개인 생각</h2><ul><li>개인적으로 퀄리티가 굉장히 좋은 강연이였다.</li><li>일단:<ul><li>minikube에 대한 간략한 설명(k8s 에 고통을 덜기위해)</li><li>왜 써야하는지 (안정성)</li><li>겪고 있는 문제(flake, k8s 1.24)</li><li>화제거리(docker 를 사용하기 위해 k8s 없이 minikube 를 돌릴수 있게 해달라)</li><li>새로운 소식(M1 에 대한 지원, GUI 지원)</li></ul></li><li>위 사항들을 모두 요약한 좋은 강연이였다고 생각된다.</li><li>다만 아쉬운 점은 최근 이야기가 많이 나오고 있는 k3s라던가 minikube 가 내부적으로 어떻게 동작하는지에 대한 설명이 있었으면 좋았을 거 같은데, 사실 이건 시간 관계상 하기 어렵기도 하고 minikube 를 사용하는 사람이 아닌 개발하는 사람에게 필요한 내용이므로 적합하지 않다고 생각해서 뺀것 같다. (혹은 예전에 이미 했어서 중복되서 안하거나?)</li><li>이 강연을 통해서 얻게된 내용:<ul><li>minikube 내부구조를 살짝 공부하고, kind(kubernetes in docker) 와 k3s 와 비교해봐야겠다. (목적성이나 구조적인 문제 둘다)</li><li>중간에 소개해줬던 내부 툴 repo를 살펴봤는데, 현재 사용하고 있지만 툴 자체가 발전하지는 않는 상황인것 같다. 살펴봐야겠다.</li></ul></li></ul></div><script src=/js/wikilink.js></script><div><script src=https://utteranc.es/client.js repo=minuk-dev/minuk-dev.github.io issue-term=pathname theme=github-dark crossorigin=anonymous async></script></div></main><footer class=footer><div class=footer-left></div><div class=footer-right><ul class=social><li><a href=/about>About</a></li><li><a href=https://github.com/minuk-dev>Github</a></li></ul></div></footer>
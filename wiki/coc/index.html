<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>coc (vim plugin coc)</title><style>html body{font-family:raleway,sans-serif;background-color:#fff}:root{--accent:#00a3d2;--border-width:5px}</style><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/copy-btn.css><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script src=/js/copy-btn.js></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script>$(document).on("click",function(){$(".collapse").collapse("hide")})</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-98056974-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-98056974-1")</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><meta name=google-site-verification content="g_3tJyj-KkW-_wKx7Ij5GimHV1nKPZXetCz8ydbBAfA"></head><body><nav class="navbar navbar-default navbar-fixed-top"><div class=container><div class=navbar-header><a class="navbar-brand visible-xs" href=#>coc (vim plugin coc)</a>
<button class=navbar-toggle data-target=.navbar-collapse data-toggle=collapse>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/wiki/>Wiki</a></li><li><a href=/posts/>Posts</a></li><li><a href=/about/>About</a></li></ul></div></div></nav><main><div class=navigator style=display:flex><div style=display:flex><div class=parent-doc style=flex:none><button class="btn btn-link" onclick='(function(e){e.querySelector("a").click()})(this)'>
<i class="fa fa-arrow-left"></i>
[[vim]]</button></div></div></div><div><h2>coc (vim plugin coc)</h2><a href=https://github.com/minuk-dev/minuk-dev.github.io/blame/master/content/wiki/coc.md><h5>created : Wed, 15 Apr 2020 23:13:04 +0900</h5><h5>modified : Fri, 04 Dec 2020 13:12:09 +0900</h5></a><a href=https://minuk.dev/tags/coc><kbd class=item-tag>coc</kbd></a>
<a href=https://minuk.dev/tags/vim><kbd class=item-tag>vim</kbd></a></div><aside class=navbar id=nav-toc style=text-align:left><nav id=TableOfContents><ul><li><a href=#간단-설명>간단 설명</a></li><li><a href=#설치하기>설치하기</a><ul><li><a href=#설치-삽질기>설치 삽질기</a></li></ul></li><li><a href=#설정하기>설정하기</a></li><li><a href=#language-server-설치>Language Server 설치</a><ul><li><a href=#c-language-server-설치>C++ Language Server 설치</a></li></ul></li><li><a href=#원하는-폴더-헤더파일로-잡아주기>원하는 폴더 헤더파일로 잡아주기</a></li></ul></nav></aside><div align=start class=content data-spy=scroll data-offset=20 data-target=#nav-toc style=position:relative><h2 id=간단-설명>간단 설명</h2><ul><li>Visual Studio Code 와 동시에 나온 Language Server (동시에 나왔는지는 확실치 않음)을 vim에도 적용하는 플러그인이다.</li><li>일부 언어들은 이미 이 플러그인을 만든 사람이 쉽게쉽게 설치 가능하도록 해놨다.</li><li>다른 언어는 삽질을 해서 알아냈다.</li></ul><h2 id=설치하기>설치하기</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>Plug</span> <span style=color:#e6db74>&#39;neoclide/coc.nvim&#39;</span>, { <span style=color:#e6db74>&#39;do&#39;</span>: <span style=color:#e6db74>&#39;./install.sh&#39;</span> }
</span></span></code></pre></div><ul><li>vimrc에 추가했다. 공식 github를 참고한거랑 다르게 썻는데, 공식에 나온대로 하니 잘 설치가 안되서 하다보니 저렇게 해서 됬다.</li></ul><h3 id=설치-삽질기>설치 삽질기</h3><ul><li>Vim-Plug가 말썽을 부린건지, git clone 과정에서 자꾸 실패했다. 그냥 vim 플러그인 디렉토리로 가서 디렉토리를 밀어버리고 다시 하니 정상적으로 됬다.</li><li>vimrc에서 최하단에 추가했는데 Coc Command가 하나도 동작하지 않았다. vimrc의 맨 윗부분으로 올리니 잘 작동된다.</li></ul><h2 id=설정하기>설정하기</h2><ul><li>공식에 나와있는거 + 맨 아랫줄 delimitMate만 추가해줬다.(Q&amp;A에 있길래 하란대로 했다.)</li></ul><pre tabindex=0><code>&#34; TextEdit might fail if hidden is not set.
set hidden

&#34; Some servers have issues with backup files, see #649.
set nobackup
set nowritebackup

&#34; Give more space for displaying messages.
set cmdheight=2

&#34; Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable
&#34; delays and poor user experience.
set updatetime=300

&#34; Don&#39;t pass messages to |ins-completion-menu|.
set shortmess+=c

&#34; Always show the signcolumn, otherwise it would shift the text each time
&#34; diagnostics appear/become resolved.
set signcolumn=yes

&#34; Use tab for trigger completion with characters ahead and navigate.
&#34; NOTE: Use command &#39;:verbose imap &lt;tab&gt;&#39; to make sure tab is not mapped by
&#34; other plugin before putting this into your config.
inoremap &lt;silent&gt;&lt;expr&gt; &lt;TAB&gt;
      \ pumvisible() ? &#34;\&lt;C-n&gt;&#34; :
      \ &lt;SID&gt;check_back_space() ? &#34;\&lt;TAB&gt;&#34; :
      \ coc#refresh()
inoremap &lt;expr&gt;&lt;S-TAB&gt; pumvisible() ? &#34;\&lt;C-p&gt;&#34; : &#34;\&lt;C-h&gt;&#34;

function! s:check_back_space() abort
  let col = col(&#39;.&#39;) - 1
  return !col || getline(&#39;.&#39;)[col - 1]  =~# &#39;\s&#39;
endfunction

&#34; Use &lt;c-space&gt; to trigger completion.
inoremap &lt;silent&gt;&lt;expr&gt; &lt;c-space&gt; coc#refresh()

&#34; Use &lt;cr&gt; to confirm completion, `&lt;C-g&gt;u` means break undo chain at current
&#34; position. Coc only does snippet and additional edit on confirm.
if exists(&#39;*complete_info&#39;)
  inoremap &lt;expr&gt; &lt;cr&gt; complete_info()[&#34;selected&#34;] != &#34;-1&#34; ? &#34;\&lt;C-y&gt;&#34; : &#34;\&lt;C-g&gt;u\&lt;CR&gt;&#34;
else
  imap &lt;expr&gt; &lt;cr&gt; pumvisible() ? &#34;\&lt;C-y&gt;&#34; : &#34;\&lt;C-g&gt;u\&lt;CR&gt;&#34;
endif

&#34; Use `[g` and `]g` to navigate diagnostics
nmap &lt;silent&gt; [g &lt;Plug&gt;(coc-diagnostic-prev)
nmap &lt;silent&gt; ]g &lt;Plug&gt;(coc-diagnostic-next)

&#34; GoTo code navigation.
nmap &lt;silent&gt; gd &lt;Plug&gt;(coc-definition)
nmap &lt;silent&gt; gy &lt;Plug&gt;(coc-type-definition)
nmap &lt;silent&gt; gi &lt;Plug&gt;(coc-implementation)
nmap &lt;silent&gt; gr &lt;Plug&gt;(coc-references)

&#34; Use K to show documentation in preview window.
nnoremap &lt;silent&gt; K :call &lt;SID&gt;show_documentation()&lt;CR&gt;

function! s:show_documentation()
  if (index([&#39;vim&#39;,&#39;help&#39;], &amp;filetype) &gt;= 0)
    execute &#39;h &#39;.expand(&#39;&lt;cword&gt;&#39;)
  else
    call CocAction(&#39;doHover&#39;)
  endif
endfunction

&#34; Highlight the symbol and its references when holding the cursor.
autocmd CursorHold * silent call CocActionAsync(&#39;highlight&#39;)

&#34; Symbol renaming.
nmap &lt;leader&gt;rn &lt;Plug&gt;(coc-rename)

&#34; Formatting selected code.
xmap &lt;leader&gt;f  &lt;Plug&gt;(coc-format-selected)
nmap &lt;leader&gt;f  &lt;Plug&gt;(coc-format-selected)

augroup mygroup
  autocmd!
  &#34; Setup formatexpr specified filetype(s).
  autocmd FileType typescript,json setl formatexpr=CocAction(&#39;formatSelected&#39;)
  &#34; Update signature help on jump placeholder.
  autocmd User CocJumpPlaceholder call CocActionAsync(&#39;showSignatureHelp&#39;)
augroup end

&#34; Applying codeAction to the selected region.
&#34; Example: `&lt;leader&gt;aap` for current paragraph
xmap &lt;leader&gt;a  &lt;Plug&gt;(coc-codeaction-selected)
nmap &lt;leader&gt;a  &lt;Plug&gt;(coc-codeaction-selected)

&#34; Remap keys for applying codeAction to the current line.
nmap &lt;leader&gt;ac  &lt;Plug&gt;(coc-codeaction)
&#34; Apply AutoFix to problem on the current line.
nmap &lt;leader&gt;qf  &lt;Plug&gt;(coc-fix-current)

&#34; Introduce function text object
&#34; NOTE: Requires &#39;textDocument.documentSymbol&#39; support from the language server.
xmap if &lt;Plug&gt;(coc-funcobj-i)
xmap af &lt;Plug&gt;(coc-funcobj-a)
omap if &lt;Plug&gt;(coc-funcobj-i)
omap af &lt;Plug&gt;(coc-funcobj-a)

&#34; Use &lt;TAB&gt; for selections ranges.
&#34; NOTE: Requires &#39;textDocument/selectionRange&#39; support from the language server.
&#34; coc-tsserver, coc-python are the examples of servers that support it.
nmap &lt;silent&gt; &lt;TAB&gt; &lt;Plug&gt;(coc-range-select)
xmap &lt;silent&gt; &lt;TAB&gt; &lt;Plug&gt;(coc-range-select)

&#34; Add `:Format` command to format current buffer.
command! -nargs=0 Format :call CocAction(&#39;format&#39;)

&#34; Add `:Fold` command to fold current buffer.
command! -nargs=? Fold :call     CocAction(&#39;fold&#39;, &lt;f-args&gt;)

&#34; Add `:OR` command for organize imports of the current buffer.
command! -nargs=0 OR   :call     CocAction(&#39;runCommand&#39;, &#39;editor.action.organizeImport&#39;)

&#34; Add (Neo)Vim&#39;s native statusline support.
&#34; NOTE: Please see `:h coc-status` for integrations with external plugins that
&#34; provide custom statusline: lightline.vim, vim-airline.
set statusline^=%{coc#status()}%{get(b:,&#39;coc_current_function&#39;,&#39;&#39;)}

&#34; Mappings using CoCList:
&#34; Show all diagnostics.
nnoremap &lt;silent&gt; &lt;space&gt;a  :&lt;C-u&gt;CocList diagnostics&lt;cr&gt;
&#34; Manage extensions.
nnoremap &lt;silent&gt; &lt;space&gt;e  :&lt;C-u&gt;CocList extensions&lt;cr&gt;
&#34; Show commands.
nnoremap &lt;silent&gt; &lt;space&gt;c  :&lt;C-u&gt;CocList commands&lt;cr&gt;
&#34; Find symbol of current document.
nnoremap &lt;silent&gt; &lt;space&gt;o  :&lt;C-u&gt;CocList outline&lt;cr&gt;
&#34; Search workspace symbols.
nnoremap &lt;silent&gt; &lt;space&gt;s  :&lt;C-u&gt;CocList -I symbols&lt;cr&gt;
&#34; Do default action for next item.
nnoremap &lt;silent&gt; &lt;space&gt;j  :&lt;C-u&gt;CocNext&lt;CR&gt;
&#34; Do default action for previous item.
nnoremap &lt;silent&gt; &lt;space&gt;k  :&lt;C-u&gt;CocPrev&lt;CR&gt;
&#34; Resume latest coc list.
nnoremap &lt;silent&gt; &lt;space&gt;p  :&lt;C-u&gt;CocListResume&lt;CR&gt;
imap &lt;expr&gt; &lt;cr&gt; pumvisible() ? &#34;\&lt;C-y&gt;&#34; : &#34;\&lt;C-g&gt;u\&lt;Plug&gt;delimitMateCR&#34;
</code></pre><h2 id=language-server-설치>Language Server 설치</h2><p>CocInstall coc-html
CocInstall coc-snippet</p><ul><li>위에 있는 것 이외에도 공식 github에서 지원한다는거 그냥 다 깔았다. 귀찮더라</li></ul><h3 id=c-language-server-설치>C++ Language Server 설치</h3><ul><li>찾아보니 c++은 기본으로 되있는게 없어서 찾아보니 <code>ccls</code>라고 있어서 더 찾기도 귀찮고 깔아봐서 잘 되서 사용중이다.</li><li>대부분 <code>brew</code>기반으로 알려주는데 나는 우분투 서버기반이라서, 다른 방법을 찾아봤다.</li><li><code>snap install ccls --classic</code>을 실행했다.</li><li>이제 언어서버를 연결해줘야한다.</li><li>CocConfig 를 vim에서 실행한다.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;languageserver&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;ccls&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;ccls&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;filetypes&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;c&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;cpp&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;objc&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;objcpp&#34;</span>
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;rootPatterns&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;.ccls&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;compile_commands.json&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;.vim/&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;.git/&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;.hg/&#34;</span>
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;initializationOptions&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;cache&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;directory&#34;</span>: <span style=color:#e6db74>&#34;/tmp/ccls&#34;</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>찾아보니 프로젝트 폴더에서도 뭔가를 만들어 줘야한다고 하는데 따로 설정 안해도 잘 돌아서 냅뒀다.</li></ul><h2 id=원하는-폴더-헤더파일로-잡아주기>원하는 폴더 헤더파일로 잡아주기</h2><ul><li><code>CocLocalConfig</code>라는 명령어로 local vim을 설정해줄수 있다.</li><li>아래 나와있는 extraArgs 부분에 추가해줘서 적용했다.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;languageserver&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;ccls&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;ccls&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;filetypes&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;c&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;cpp&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;objc&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;objcpp&#34;</span>
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;rootPatterns&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;.ccls&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;compile_commands.json&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;.vim/&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;.git/&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;.hg/&#34;</span>
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;initializationOptions&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;cache&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;directory&#34;</span>: <span style=color:#e6db74>&#34;/tmp/ccls&#34;</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;clang&#34;</span>: {
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&#34;resourceDir&#34;</span>: <span style=color:#e6db74>&#34;.&#34;</span>,
</span></span><span style=display:flex><span>                  <span style=color:#f92672>&#34;extraArgs&#34;</span>: [<span style=color:#e6db74>&#34;-isystem./&#34;</span>, <span style=color:#e6db74>&#34;-isystem./lib/kernel&#34;</span>, <span style=color:#e6db74>&#34;-isystem./lib&#34;</span>]
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>CMake 를 쓸때의 방법</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cmake -H. -BDebug -DCMAKE_BUILD_TYPE<span style=color:#f92672>=</span>Debug -DCMAKE_EXPORT_COMPILE_COMMANDS<span style=color:#f92672>=</span>YES
</span></span><span style=display:flex><span>$ ln -s Debug/compile_commands.json .
</span></span></code></pre></div></div><script src=/js/wikilink.js></script><div><script src=https://utteranc.es/client.js repo=minuk-dev/minuk-dev.github.io issue-term=pathname theme=github-dark crossorigin=anonymous async></script></div></main><footer class=footer><div class=footer-left></div><div class=footer-right><ul class=social><li><a href=/about>About</a></li><li><a href=https://github.com/minuk-dev>Github</a></li></ul></div></footer>
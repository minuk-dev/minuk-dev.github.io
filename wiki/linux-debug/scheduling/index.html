<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css><meta name=generator content="Hugo 0.140.0"><meta name=description content="minuk.dev wiki"><meta name=keywords content="hugo,site,new"><meta name=author content="Min-Uk.Lee"><title>linux-debug/scheduling |
minuk dev wiki
</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script></head><body><header class=header><div class=header_left></div><div class=header_middle>linux-debug/scheduling -
minuk dev wiki</div></header><main><aside class=sidebar><ul class=section-tree><li class="dir opened-dir"><span class=dir-text>Front Page</span><ul class=section-tree><li class=file><a href=https://minuk.dev/wiki/kubernetes-community-day-korea/ title=./wiki/kubernetes-community-day-korea/>Kubernetes Community Day 2024</a></li><li class=file><a href=https://minuk.dev/wiki/observability-engineering-kr/ title=./wiki/observability-engineering-kr/>Observability Engineering</a></li><li class=file><a href=https://minuk.dev/wiki/learning-opentelemetry/ title=./wiki/learning-opentelemetry/>Learning OpenTelemetry</a></li><li class=file><a href=https://minuk.dev/wiki/prometheus-native-histograms-in-production/ title=./wiki/prometheus-native-histograms-in-production/>prometheus-native-histograms-in-proudction</a></li><li class=file><a href=https://minuk.dev/wiki/making-sense-of-your-vital-signals-the-future-of-pod-and-containers-monitoring/ title=./wiki/making-sense-of-your-vital-signals-the-future-of-pod-and-containers-monitoring/>Making Sense of Your Vital Signals - The Future of Pod and Containers Monitoring</a></li><li class=file><a href=https://minuk.dev/wiki/defining-a-common-observability-query-language-and-other-observability-tag-updates/ title=./wiki/defining-a-common-observability-query-language-and-other-observability-tag-updates/>Defining A Common Observability Query Language and Other observability TAG Updates</a></li><li class=file><a href=https://minuk.dev/wiki/beyond-tracing-what-do-we-do-with-all-this-data/ title=./wiki/beyond-tracing-what-do-we-do-with-all-this-data/>Beyond Tracing - What do we do with all this data</a></li><li class=file><a href=https://minuk.dev/wiki/grafanacon/ title=./wiki/grafanacon/>grafanacon</a></li><li class=file><a href=https://minuk.dev/wiki/observability-engineering/ title=./wiki/observability-engineering/>Observability Engineering</a></li><li class=file><a href=https://minuk.dev/wiki/rust/ title=./wiki/rust/>rust</a></li><li class=file><a href=https://minuk.dev/wiki/opentelemetry-metrics-deep-dive/ title=./wiki/opentelemetry-metrics-deep-dive/>opentelemetry metrics deep dive</a></li><li class=file><a href=https://minuk.dev/wiki/armeria/ title=./wiki/armeria/>armeria</a></li><li class=file><a href=https://minuk.dev/wiki/kotlin/ title=./wiki/kotlin/>kotlin</a></li><li class=file><a href=https://minuk.dev/wiki/loki-best-practices/ title=./wiki/loki-best-practices/>loki label best practices</a></li><li class=file><a href=https://minuk.dev/wiki/loki/ title=./wiki/loki/>loki</a></li><li class=file><a href=https://minuk.dev/wiki/grafana-loki-like-prometheus-but-for-logs/ title=./wiki/grafana-loki-like-prometheus-but-for-logs/>Grafana Loki - Like Prometheus, But for logs.</a></li><li class=file><a href=https://minuk.dev/wiki/spring-boot-cli/ title=./wiki/spring-boot-cli/>spring boot cli</a></li><li class=file><a href=https://minuk.dev/wiki/autoconf/ title=./wiki/autoconf/>autoconf</a></li><li class=file><a href=https://minuk.dev/wiki/re-minuk-k8s/ title=./wiki/re-minuk-k8s/>다시 시작하는 쿠버네티스 세팅</a></li><li class=file><a href=https://minuk.dev/wiki/cloud-native-go/ title=./wiki/cloud-native-go/>Cloud Native Go</a></li><li class=file><a href=https://minuk.dev/wiki/overlayfs/ title=./wiki/overlayfs/>overlayfs</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/design-pattern/ title=./wiki/lectures/design-pattern/>lectures/design-pattern</a></li><li class=file><a href=https://minuk.dev/wiki/site-reliability-engineering/ title=./wiki/site-reliability-engineering/>사이트 신뢰성 엔지니어링</a></li><li class=file><a href=https://minuk.dev/wiki/to-ipv6-the-dual-stack-adoption-advisory-panel/ title=./wiki/to-ipv6-the-dual-stack-adoption-advisory-panel/>To IPv6 - The Dual-stack Adoption Advisory Panel</a></li><li class=file><a href=https://minuk.dev/wiki/prometheus-intro-and-deep-dive/ title=./wiki/prometheus-intro-and-deep-dive/>Prometheus Intro and Deep Dive</a></li><li class=file><a href=https://minuk.dev/wiki/cs/ title=./wiki/cs/>cs 기본</a></li><li class=file><a href=https://minuk.dev/wiki/coredns/ title=./wiki/coredns/>learning-coredns</a></li><li class=file><a href=https://minuk.dev/wiki/coredns-into-and-deep-dive/ title=./wiki/coredns-into-and-deep-dive/>CoreDNS - Intro and Deep Dive</a></li><li class=file><a href=https://minuk.dev/wiki/deep-dive-into-minikube/ title=./wiki/deep-dive-into-minikube/>Deep Dive into Minikube</a></li><li class=file><a href=https://minuk.dev/wiki/making-your-apps-and-infrastructure-services-failure-resilient-with-dapr/ title=./wiki/making-your-apps-and-infrastructure-services-failure-resilient-with-dapr/>Making Your Apps and Infrastructure Services Failure-Resilient with Dapr</a></li><li class=file><a href=https://minuk.dev/wiki/make-cloud-native-chaos-engineering-easier-deep-dive-into-chaos-mesh/ title=./wiki/make-cloud-native-chaos-engineering-easier-deep-dive-into-chaos-mesh/>Make Cloud Native Chaos Engineering Easier Deep Dive into Chaos Mesh</a></li><li class=file><a href=https://minuk.dev/wiki/selinux/ title=./wiki/selinux/>selinux</a></li><li class=file><a href=https://minuk.dev/wiki/http-go/ title=./wiki/http-go/>go snippet for go</a></li><li class=file><a href=https://minuk.dev/wiki/curl/ title=./wiki/curl/>curl</a></li><li class=file><a href=https://minuk.dev/wiki/volcano-intro-and-deep-dive/ title=./wiki/volcano-intro-and-deep-dive/>Volcano - Intro & Deep Dive</a></li><li class=file><a href=https://minuk.dev/wiki/intro-to-kubernetes-gitops-and-observability-hands-on-tutorial/ title=./wiki/intro-to-kubernetes-gitops-and-observability-hands-on-tutorial/>Intro to Kubernetes, GitOps, and Observability Hands-On Tutorial</a></li><li class=file><a href=https://minuk.dev/wiki/kubespray/ title=./wiki/kubespray/>kubespray</a></li><li class=file><a href=https://minuk.dev/wiki/spark-on-kubernetes-the-elastic-story/ title=./wiki/spark-on-kubernetes-the-elastic-story/>Spark on Kubernetes - The Elastic Story</a></li><li class=file><a href=https://minuk.dev/wiki/devops%EC%99%80-se%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%A6%AC%EB%88%85%EC%8A%A4-%EC%BB%A4%EB%84%90-%EC%9D%B4%EC%95%BC%EA%B8%B0/ title=./wiki/devops%EC%99%80-se%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%A6%AC%EB%88%85%EC%8A%A4-%EC%BB%A4%EB%84%90-%EC%9D%B4%EC%95%BC%EA%B8%B0/>DevOps와 SE를 위한 리눅스 커널 이야기</a></li><li class=file><a href=https://minuk.dev/wiki/running-containerd-and-k3s-on-macos/ title=./wiki/running-containerd-and-k3s-on-macos/>Running Containerd and k3s on MacOS</a></li><li class=file><a href=https://minuk.dev/wiki/twelve-factor-app/ title=./wiki/twelve-factor-app/>12요소 어플리케이션</a></li><li class=file><a href=https://minuk.dev/wiki/vim-go/ title=./wiki/vim-go/>vim/vim-go</a></li><li class=file><a href=https://minuk.dev/wiki/kubernetes-patterns/ title=./wiki/kubernetes-patterns/>쿠버네티스 패턴</a></li><li class=file><a href=https://minuk.dev/wiki/horizontalpodautoscaler/ title=./wiki/horizontalpodautoscaler/>Horizontal Pod AutoScaler</a></li><li class=file><a href=https://minuk.dev/wiki/what-if-kube-apiserver-could-be-extended-via-webassembly/ title=./wiki/what-if-kube-apiserver-could-be-extended-via-webassembly/>What If… Kube-Apiserver Could be Extended Via WebAssembly?</a></li><li class=file><a href=https://minuk.dev/wiki/the-future-of-reproducible-research-powered-by-kubeflow/ title=./wiki/the-future-of-reproducible-research-powered-by-kubeflow/>The Future Of Reproducible Research - Powered by Kubeflow</a></li><li class=file><a href=https://minuk.dev/wiki/this-is-the-way-a-crash-course-on-intricacies-of-managing-cpus/ title=./wiki/this-is-the-way-a-crash-course-on-intricacies-of-managing-cpus/>This is The Way- A Crash Course on the Intricacies of Managing CPUs in K8s</a></li><li class=file><a href=https://minuk.dev/wiki/kubernetes-graceful-shutdown/ title=./wiki/kubernetes-graceful-shutdown/>kubernetes-graceful-shutdown</a></li><li class=file><a href=https://minuk.dev/wiki/dockerfile/ title=./wiki/dockerfile/>dockerfile</a></li><li class=file><a href=https://minuk.dev/wiki/automated-progressive-delivery-using-gitops-and-service-mesh/ title=./wiki/automated-progressive-delivery-using-gitops-and-service-mesh/>Automated Progressive Delivery Using GitOps and Service Mesh</a></li><li class=file><a href=https://minuk.dev/wiki/containerd-proejct-update-and-deep-dive/ title=./wiki/containerd-proejct-update-and-deep-dive/>containerd Project Update and Deep Dive</a></li><li class=file><a href=https://minuk.dev/wiki/http2/ title=./wiki/http2/>http2 탐구</a></li><li class=file><a href=https://minuk.dev/wiki/grpc-for-microservices/ title=./wiki/grpc-for-microservices/>gRPC For Microservices Service-mesh and Observability</a></li><li class=file><a href=https://minuk.dev/wiki/kubecon/ title=./wiki/kubecon/>kubecon</a></li><li class=file><a href=https://minuk.dev/wiki/go-http/ title=./wiki/go-http/>go-http</a></li><li class=file><a href=https://minuk.dev/wiki/go/ title=./wiki/go/>go</a></li><li class=file><a href=https://minuk.dev/wiki/cri/ title=./wiki/cri/>CRI(Container Runtime Interface)</a></li><li class=file><a href=https://minuk.dev/wiki/vagrant/ title=./wiki/vagrant/>vagrant</a></li><li class=file><a href=https://minuk.dev/wiki/jsonpath/ title=./wiki/jsonpath/>jsonpath</a></li><li class=file><a href=https://minuk.dev/wiki/systemctl/ title=./wiki/systemctl/>systemctl 중요한것만 정리</a></li><li class=file><a href=https://minuk.dev/wiki/init/ title=./wiki/init/>linux init 요약</a></li><li class=file><a href=https://minuk.dev/wiki/process-cli/ title=./wiki/process-cli/>process 관련된 명령어 모음</a></li><li class=file><a href=https://minuk.dev/wiki/process-status/ title=./wiki/process-status/>process-status</a></li><li class=file><a href=https://minuk.dev/wiki/teamnote-go/ title=./wiki/teamnote-go/>teamnote-go</a></li><li class=file><a href=https://minuk.dev/wiki/cgroups/ title=./wiki/cgroups/>cgroup</a></li><li class=file><a href=https://minuk.dev/wiki/namespaces/ title=./wiki/namespaces/>namespaces</a></li><li class=file><a href=https://minuk.dev/wiki/lxc/ title=./wiki/lxc/>LXC</a></li><li class=file><a href=https://minuk.dev/wiki/devops/ title=./wiki/devops/>devops</a></li><li class=file><a href=https://minuk.dev/wiki/ringle/supply-and-demand/ title=./wiki/ringle/supply-and-demand/>Supply and Demand</a></li><li class=file><a href=https://minuk.dev/wiki/ringle/the-metaverse/ title=./wiki/ringle/the-metaverse/>ringle/The metaverse</a></li><li class=file><a href=https://minuk.dev/wiki/ringle/microsoft-x-activision-blizzard/ title=./wiki/ringle/microsoft-x-activision-blizzard/>ringle/Microsoft x Activision Blizzard</a></li><li class=file><a href=https://minuk.dev/wiki/topcit/ title=./wiki/topcit/>topcit 간략 공부</a></li><li class=file><a href=https://minuk.dev/wiki/software-engineering-at-google/ title=./wiki/software-engineering-at-google/>구글 엔지니어는 이렇게 일한다</a></li><li class=file><a href=https://minuk.dev/wiki/k8s-in-rpi/ title=./wiki/k8s-in-rpi/>k8s-in-rpi</a></li><li class=file><a href=https://minuk.dev/wiki/kubernetes/ title=./wiki/kubernetes/>kubernetes</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/numerical_analysis/ title=./wiki/lectures/numerical_analysis/>수치해석</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/information_security_theory/ title=./wiki/lectures/information_security_theory/>2022-1 정보보호이론</a></li><li class=file><a href=https://minuk.dev/wiki/%EC%A0%9C%ED%85%94%EC%B9%B4%EC%8A%A4%ED%85%90/ title=./wiki/%EC%A0%9C%ED%85%94%EC%B9%B4%EC%8A%A4%ED%85%90/>제텔카스텐</a></li><li class=file><a href=https://minuk.dev/wiki/%EB%A7%81%EA%B8%80/autonomous/ title=./wiki/%EB%A7%81%EA%B8%80/autonomous/>링글/Autonomous</a></li><li class=file><a href=https://minuk.dev/wiki/%EB%A7%81%EA%B8%80/metaverse/ title=./wiki/%EB%A7%81%EA%B8%80/metaverse/>링글/Metaverse</a></li><li class=file><a href=https://minuk.dev/wiki/algorithm/ title=./wiki/algorithm/>algorithm</a></li><li class=file><a href=https://minuk.dev/wiki/study-note/ title=./wiki/study-note/>study-note</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/machine-learning/ title=./wiki/lectures/machine-learning/>2022 1학기 머신러닝</a></li><li class=file><a href=https://minuk.dev/wiki/kubernetes-in-action/ title=./wiki/kubernetes-in-action/>Kubernetes in action</a></li><li class=file><a href=https://minuk.dev/wiki/effective-java/ title=./wiki/effective-java/>Effective Java</a></li><li class=file><a href=https://minuk.dev/wiki/kafka/ title=./wiki/kafka/>Kafka</a></li><li class=file><a href=https://minuk.dev/wiki/%EB%A9%B4%EC%A0%91%EC%A4%80%EB%B9%84/ title=./wiki/%EB%A9%B4%EC%A0%91%EC%A4%80%EB%B9%84/>면접 준비 자료</a></li><li class=file><a href=https://minuk.dev/wiki/zsh/ title=./wiki/zsh/>zsh</a></li><li class=file><a href=https://minuk.dev/wiki/simple-file/ title=./wiki/simple-file/>Simple한 File Server</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2021-12-03/ title=./wiki/%ED%9A%8C%EA%B3%A0/2021-12-03/>회고/2021-12-03</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/bayesian/week3/ title=./wiki/lectures/bayesian/week3/>bayesian/week3</a></li><li class=file><a href=https://minuk.dev/wiki/jupyter/ title=./wiki/jupyter/>jupyter notebook</a></li><li class=file><a href=https://minuk.dev/wiki/ffmpeg/ title=./wiki/ffmpeg/>ffmpeg 를 사용한 convert 요약</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/bayesian/week2/ title=./wiki/lectures/bayesian/week2/>bayesian/week2</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/bayesian/week1/ title=./wiki/lectures/bayesian/week1/>bayesian/week1</a></li><li class=file><a href=https://minuk.dev/wiki/pdf-test/ title=./wiki/pdf-test/>pdf-test</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/automata/ title=./wiki/lectures/automata/>오토마타와 형식언어 정리</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/computer-communication/ title=./wiki/lectures/computer-communication/>컴퓨터통신</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/introduction-to-statistical-learning/ title=./wiki/lectures/introduction-to-statistical-learning/>통계학습개론(Introduction to statistical learnning) 수업 정리</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/bayesian-statistics/ title=./wiki/lectures/bayesian-statistics/>베이지안 통계학(Bayesian Statistics)</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/multi-variant-statistical-analysis/ title=./wiki/lectures/multi-variant-statistical-analysis/>Multi Variant Statistical Analysis</a></li><li class=file><a href=https://minuk.dev/wiki/comment/ title=./wiki/comment/>주석 관련 좋은 글</a></li><li class=file><a href=https://minuk.dev/wiki/ssh/ title=./wiki/ssh/>ssh 관련 명령어 모음</a></li><li class=file><a href=https://minuk.dev/wiki/msk/ title=./wiki/msk/>amazon msk 삽질</a></li><li class=file><a href=https://minuk.dev/wiki/keras-book/ title=./wiki/keras-book/>케라스 창시자에게 배우는 딥러닝 책 공부</a></li><li class=file><a href=https://minuk.dev/wiki/msa-from-ddd/ title=./wiki/msa-from-ddd/>도메인 주도 설계로 시작하는 마이크로서비스 개발</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2021-07-18/ title=./wiki/%ED%9A%8C%EA%B3%A0/2021-07-18/>2021-07-21 회고</a></li><li class=file><a href=https://minuk.dev/wiki/iamroot19/ title=./wiki/iamroot19/>아이엠루트 스터디 자료 정리</a></li><li class=file><a href=https://minuk.dev/wiki/boj-9019/ title=./wiki/boj-9019/>boj-9019</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2021-06-19/ title=./wiki/%ED%9A%8C%EA%B3%A0/2021-06-19/>2021년 6월 19일 회고</a></li><li class=file><a href=https://minuk.dev/wiki/%EB%8F%85%EC%84%B1%EB%A7%90%ED%88%AC/ title=./wiki/%EB%8F%85%EC%84%B1%EB%A7%90%ED%88%AC/>독성말투</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/regression/ title=./wiki/lectures/regression/>Regression Analysis</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%94%BC%EC%8B%9C%EC%8B%A4/ title=./wiki/%ED%94%BC%EC%8B%9C%EC%8B%A4/>피시실</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/multicore/ title=./wiki/lectures/multicore/>Multicore Computing</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/ns3/ title=./wiki/lectures/ns3/>Network Simulator 3</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/nonparametric-statistic/ title=./wiki/lectures/nonparametric-statistic/>비모수 통계학</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/wireless/ title=./wiki/lectures/wireless/>wireless 무선이동통신 수업</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/database_system/ title=./wiki/lectures/database_system/>Database System</a></li><li class=file><a href=https://minuk.dev/wiki/%EC%B9%B4%EC%B9%B4%EC%98%A4%EC%9B%8C%ED%81%AC/ title=./wiki/%EC%B9%B4%EC%B9%B4%EC%98%A4%EC%9B%8C%ED%81%AC/>카카오워크</a></li><li class=file><a href=https://minuk.dev/wiki/soma/ title=./wiki/soma/>소프트웨어 마에스트로</a></li><li class=file><a href=https://minuk.dev/wiki/linux_kakaotalk/ title=./wiki/linux_kakaotalk/>리눅스 카카오톡</a></li><li class=file><a href=https://minuk.dev/wiki/latina/ title=./wiki/latina/>라틴어</a></li><li class=file><a href=https://minuk.dev/wiki/blk-mq/ title=./wiki/blk-mq/>Multi-Queue Block IO Queueing (blk-mq)</a></li><li class=file><a href=https://minuk.dev/wiki/linux-study/ title=./wiki/linux-study/>linux-study</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-12-20/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-12-20/>2020-12-20 회고</a></li><li class=file><a href=https://minuk.dev/wiki/linux-debug/scheduling/ title=./wiki/linux-debug/scheduling/>linux-debug/scheduling</a></li><li class=file><a href=https://minuk.dev/wiki/linux-debug/synchronization/ title=./wiki/linux-debug/synchronization/>linux-debug/synchronization</a></li><li class=file><a href=https://minuk.dev/wiki/linux-debug/timer/ title=./wiki/linux-debug/timer/>linux-debug/timer</a></li><li class=file><a href=https://minuk.dev/wiki/linux-debug/workqueue/ title=./wiki/linux-debug/workqueue/>linux-debug/workqueue</a></li><li class=file><a href=https://minuk.dev/wiki/linux-debug/interrupt/ title=./wiki/linux-debug/interrupt/>linux-debug/interrupt</a></li><li class=file><a href=https://minuk.dev/wiki/linux-debug/process/ title=./wiki/linux-debug/process/>linux-debug/process</a></li><li class=file><a href=https://minuk.dev/wiki/input-method/ title=./wiki/input-method/>linux input-method 삽질</a></li><li class=file><a href=https://minuk.dev/wiki/assembly/ title=./wiki/assembly/>assembly</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-10-24/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-10-24/>2020-10-24 회고</a></li><li class=file><a href=https://minuk.dev/wiki/contextmenu/ title=./wiki/contextmenu/>contextmenu</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-10-09/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-10-09/>2020-10-09 회고</a></li><li class=file><a href=https://minuk.dev/wiki/others/ title=./wiki/others/>others</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-09-18/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-09-18/>2020-09-18 회고</a></li><li class=file><a href=https://minuk.dev/wiki/seccomp/ title=./wiki/seccomp/>seccomp</a></li><li class=file><a href=https://minuk.dev/wiki/debug-linux/ title=./wiki/debug-linux/>디버깅을 통해 배우는 리눅스 커널의 구조와 원리</a></li><li class=file><a href=https://minuk.dev/wiki/fuse/ title=./wiki/fuse/>Filesystem in Userspace</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-08-30/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-08-30/>회고/2020-08-30</a></li><li class=file><a href=https://minuk.dev/wiki/raid/ title=./wiki/raid/>RAID(Redundant Array of Independent Disks)</a></li><li class=file><a href=https://minuk.dev/wiki/storage/ title=./wiki/storage/>Storage</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-08-17/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-08-17/>2020-08-17 회고</a></li><li class=file><a href=https://minuk.dev/wiki/teamnote/ title=./wiki/teamnote/>teamnote</a></li><li class=file><a href=https://minuk.dev/wiki/git/ title=./wiki/git/>git</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-07-31/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-07-31/>2020년 7월 31일자 회고</a></li><li class=file><a href=https://minuk.dev/wiki/3%EA%B3%B5%EB%85%B8%ED%8A%B8/ title=./wiki/3%EA%B3%B5%EB%85%B8%ED%8A%B8/>3공 노트</a></li><li class=file><a href=https://minuk.dev/wiki/nas/ title=./wiki/nas/>NAS</a></li><li class=file><a href=https://minuk.dev/wiki/lfs/ title=./wiki/lfs/>LFS Paper</a></li><li class=file><a href=https://minuk.dev/wiki/ftl/ title=./wiki/ftl/>Flash Translation Layer</a></li><li class=file><a href=https://minuk.dev/wiki/ppn/ title=./wiki/ppn/>PPN(Physical Page Number)</a></li><li class=file><a href=https://minuk.dev/wiki/lpn/ title=./wiki/lpn/>LPN(Logical Page Number)</a></li><li class=file><a href=https://minuk.dev/wiki/load-balance/ title=./wiki/load-balance/>Load Balance</a></li><li class=file><a href=https://minuk.dev/wiki/cache/ title=./wiki/cache/>Cache</a></li><li class=file><a href=https://minuk.dev/wiki/uart/ title=./wiki/uart/>UART (Universal asynchronous receiver/transmitter)</a></li><li class=file><a href=https://minuk.dev/wiki/vhdci/ title=./wiki/vhdci/>VHDCI (Very-high-dencity cable interconnect)</a></li><li class=file><a href=https://minuk.dev/wiki/boxplot/ title=./wiki/boxplot/>boxplot</a></li><li class=file><a href=https://minuk.dev/wiki/quartile/ title=./wiki/quartile/>quartile (사분위수)</a></li><li class=file><a href=https://minuk.dev/wiki/statistics/ title=./wiki/statistics/>statistics</a></li><li class=file><a href=https://minuk.dev/wiki/fsm/ title=./wiki/fsm/>FSM (Finite State machine)</a></li><li class=file><a href=https://minuk.dev/wiki/open-nvm/ title=./wiki/open-nvm/>open-nvm</a></li><li class=file><a href=https://minuk.dev/wiki/mram/ title=./wiki/mram/>MRAM (Magnetic Random Access Memory)</a></li><li class=file><a href=https://minuk.dev/wiki/file/ title=./wiki/file/>vfs - file</a></li><li class=file><a href=https://minuk.dev/wiki/kiocb/ title=./wiki/kiocb/>kiocb</a></li><li class=file><a href=https://minuk.dev/wiki/vfs/ title=./wiki/vfs/>VFS-Virtual File System</a></li><li class=file><a href=https://minuk.dev/wiki/linux/ title=./wiki/linux/>linux</a></li><li class=file><a href=https://minuk.dev/wiki/f2fs-paper/ title=./wiki/f2fs-paper/>F2FS- A New File System for Flash Storage</a></li><li class=file><a href=https://minuk.dev/wiki/english/proverb/ title=./wiki/english/proverb/>english/proverb</a></li><li class=file><a href=https://minuk.dev/wiki/english/ title=./wiki/english/>english</a></li><li class=file><a href=https://minuk.dev/wiki/tool/ title=./wiki/tool/>tool</a></li><li class=file><a href=https://minuk.dev/wiki/verilog/ title=./wiki/verilog/>verilog (베릴로그)</a></li><li class=file><a href=https://minuk.dev/wiki/iommu/ title=./wiki/iommu/>IOMMU (Input Output Memory Management Unit)</a></li><li class=file><a href=https://minuk.dev/wiki/delayed_work/ title=./wiki/delayed_work/>delayed work</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-06-21/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-06-21/>회고/2020-06-21</a></li><li class=file><a href=https://minuk.dev/wiki/jwt/ title=./wiki/jwt/>json web token(jwt)</a></li><li class=file><a href=https://minuk.dev/wiki/tmuxinator/ title=./wiki/tmuxinator/>tmuxinator</a></li><li class=file><a href=https://minuk.dev/wiki/vim-staritfy/ title=./wiki/vim-staritfy/>vim-startify</a></li><li class=file><a href=https://minuk.dev/wiki/my-page/ title=./wiki/my-page/>my-page (나만의 홈페이지 만들기)</a></li><li class=file><a href=https://minuk.dev/wiki/blk_mq/ title=./wiki/blk_mq/>blk_mq</a></li><li class=file><a href=https://minuk.dev/wiki/prp/ title=./wiki/prp/>PRP (Physical Region Page)</a></li><li class=file><a href=https://minuk.dev/wiki/numa/ title=./wiki/numa/>NUMA</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-06-17/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-06-17/>회고/2020-06-17</a></li><li class=file><a href=https://minuk.dev/wiki/block-layer/ title=./wiki/block-layer/>block layer</a></li><li class=file><a href=https://minuk.dev/wiki/workqueue/ title=./wiki/workqueue/>workqueue</a></li><li class=file><a href=https://minuk.dev/wiki/nvme/ title=./wiki/nvme/>nvme</a></li><li class=file><a href=https://minuk.dev/wiki/gem5/ title=./wiki/gem5/>gem5</a></li><li class=file><a href=https://minuk.dev/wiki/simplessd/ title=./wiki/simplessd/>simple-ssd</a></li><li class=file><a href=https://minuk.dev/wiki/mmap/ title=./wiki/mmap/>mmap</a></li><li class=file><a href=https://minuk.dev/wiki/b+tree/ title=./wiki/b+tree/>B+ Tree</a></li><li class=file><a href=https://minuk.dev/wiki/database/ title=./wiki/database/>Database</a></li><li class=file><a href=https://minuk.dev/wiki/memory-cache-clean/ title=./wiki/memory-cache-clean/>memory cache 비우기 (linux command)</a></li><li class=file><a href=https://minuk.dev/wiki/free/ title=./wiki/free/>free (linux command)</a></li><li class=file><a href=https://minuk.dev/wiki/clflush/ title=./wiki/clflush/>clflush (cache line flush)</a></li><li class=file><a href=https://minuk.dev/wiki/c++/ title=./wiki/c++/>C++ Language</a></li><li class=file><a href=https://minuk.dev/wiki/%EC%82%AC%EC%A7%80%EB%B0%A9/ title=./wiki/%EC%82%AC%EC%A7%80%EB%B0%A9/>사지방</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/3%EC%9B%94/ title=./wiki/%ED%9A%8C%EA%B3%A0/3%EC%9B%94/>2020년 3월 회고</a></li><li class=file><a href=https://minuk.dev/wiki/mysql/ title=./wiki/mysql/>mysql (storage engine)</a></li><li class=file><a href=https://minuk.dev/wiki/block-group/ title=./wiki/block-group/>block group</a></li><li class=file><a href=https://minuk.dev/wiki/journal/ title=./wiki/journal/>journal(journaling)</a></li><li class=file><a href=https://minuk.dev/wiki/group-descriptor-table/ title=./wiki/group-descriptor-table/>group descriptor table</a></li><li class=file><a href=https://minuk.dev/wiki/inode/ title=./wiki/inode/>inode</a></li><li class=file><a href=https://minuk.dev/wiki/superblock/ title=./wiki/superblock/>Superblock</a></li><li class=file><a href=https://minuk.dev/wiki/ext4/ title=./wiki/ext4/>The new ext4 filesystem: current status and future plans</a></li><li class=file><a href=https://minuk.dev/wiki/%EA%B3%84%EB%A3%A1-%EA%B0%9C%EB%B0%9C-%EB%AA%A8%EC%9E%84/ title=./wiki/%EA%B3%84%EB%A3%A1-%EA%B0%9C%EB%B0%9C-%EB%AA%A8%EC%9E%84/>계룡 개발 모임</a></li><li class=file><a href=https://minuk.dev/wiki/ssd/ title=./wiki/ssd/>SSD</a></li><li class=file><a href=https://minuk.dev/wiki/gutentags/ title=./wiki/gutentags/>gutentags</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-18--%EB%A9%94%EB%A9%98%ED%86%A0/ title=./wiki/modern-c++-design-pattern/chapter-18--%EB%A9%94%EB%A9%98%ED%86%A0/>Modern C++ Design Pattern/Chatper 18. 메멘토</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-17--%EB%A7%A4%EA%B0%9C%EC%9E%90/ title=./wiki/modern-c++-design-pattern/chapter-17--%EB%A7%A4%EA%B0%9C%EC%9E%90/>Modern C++ Design Pattern/Chatper 17. 매개자</a></li><li class=file><a href=https://minuk.dev/wiki/boj/ title=./wiki/boj/>boj</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-16--%EB%B0%98%EB%B3%B5%EC%9E%90/ title=./wiki/modern-c++-design-pattern/chapter-16--%EB%B0%98%EB%B3%B5%EC%9E%90/>Modern C++ Design Pattern/Chatper 16. 반복자</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-04-20/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-04-20/>회고/2020.04.20</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-15--%EC%9D%B8%ED%84%B0%ED%94%84%EB%A6%AC%ED%84%B0/ title=./wiki/modern-c++-design-pattern/chapter-15--%EC%9D%B8%ED%84%B0%ED%94%84%EB%A6%AC%ED%84%B0/>Modern C++ Design Pattern/Chatper 15. 인터프리터</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-14--%EC%BB%A4%EB%A7%A8%EB%93%9C/ title=./wiki/modern-c++-design-pattern/chapter-14--%EC%BB%A4%EB%A7%A8%EB%93%9C/>Modern C++ Design Pattern/Chatper 14. 커맨드</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-13--%EC%B1%85%EC%9E%84%EC%82%AC%EC%8A%ACchain-of-responsibility/ title=./wiki/modern-c++-design-pattern/chapter-13--%EC%B1%85%EC%9E%84%EC%82%AC%EC%8A%ACchain-of-responsibility/>Modern C++ Design Pattern/Chatper 13. 책임사슬(Chain of Responsibility)</a></li><li class=file><a href=https://minuk.dev/wiki/coc/ title=./wiki/coc/>coc (vim plugin coc)</a></li><li class=file><a href=https://minuk.dev/wiki/regex/ title=./wiki/regex/>Regular Expression (regex)</a></li><li class=file><a href=https://minuk.dev/wiki/glob/ title=./wiki/glob/>glob</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-12--%ED%94%84%EB%A1%9D%EC%8B%9C/ title=./wiki/modern-c++-design-pattern/chapter-12--%ED%94%84%EB%A1%9D%EC%8B%9C/>Modern C++ Design Pattern/Chapter 12. 프록시</a></li><li class=file><a href=https://minuk.dev/wiki/hugo/ title=./wiki/hugo/>hugo</a></li><li class=file><a href=https://minuk.dev/wiki/tee/ title=./wiki/tee/>tee (Linux Command)</a></li><li class=file><a href=https://minuk.dev/wiki/rm/ title=./wiki/rm/>rm (Linux Command)</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-11--%ED%94%8C%EB%9D%BC%EC%9D%B4%EC%9B%A8%EC%9D%B4%ED%8A%B8/ title=./wiki/modern-c++-design-pattern/chapter-11--%ED%94%8C%EB%9D%BC%EC%9D%B4%EC%9B%A8%EC%9D%B4%ED%8A%B8/>Modern C++ Design Pattern/Chapter 11. 플라이웨이트</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-10--%ED%8D%BC%EC%82%AC%EB%93%9C/ title=./wiki/modern-c++-design-pattern/chapter-10--%ED%8D%BC%EC%82%AC%EB%93%9C/>Modern C++ Design Pattern/Chapter 10. 퍼사드</a></li><li class=file><a href=https://minuk.dev/wiki/effective-debugging/chapter-7--%EC%8B%A4%ED%96%89-%EC%8B%9C%EA%B0%84-%EA%B8%B0%EB%B2%95/ title=./wiki/effective-debugging/chapter-7--%EC%8B%A4%ED%96%89-%EC%8B%9C%EA%B0%84-%EA%B8%B0%EB%B2%95/>Effective Debugging/Chatper 7. 컴파일 시간 기법</a></li><li class=file><a href=https://minuk.dev/wiki/effective-debugging/chapter-8--%EB%A9%80%ED%8B%B0%EC%8A%A4%EB%A0%88%EB%93%9C-%EC%BD%94%EB%93%9C-%EB%94%94%EB%B2%84%EA%B9%85/ title=./wiki/effective-debugging/chapter-8--%EB%A9%80%ED%8B%B0%EC%8A%A4%EB%A0%88%EB%93%9C-%EC%BD%94%EB%93%9C-%EB%94%94%EB%B2%84%EA%B9%85/>Effective Debugging/Chatper 8. 멀티스레드 코드 디버깅</a></li><li class=file><a href=https://minuk.dev/wiki/todo/ title=./wiki/todo/>TODO Lists</a></li><li class=file><a href=https://minuk.dev/wiki/vim/ title=./wiki/vim/>vim</a></li><li class=file><a href=https://minuk.dev/wiki/vimwiki/ title=./wiki/vimwiki/>vimwiki</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-04-08/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-04-08/>회고/2020-04-08</a></li><li class=file><a href=https://minuk.dev/wiki/cloudatcost/ title=./wiki/cloudatcost/>cloudatcost</a></li><li class=file><a href=https://minuk.dev/wiki/web/ title=./wiki/web/>web</a></li><li class=file><a href=https://minuk.dev/wiki/nginx/ title=./wiki/nginx/>nginx</a></li><li class=file><a href=https://minuk.dev/wiki/understanding-linux-kernel/ title=./wiki/understanding-linux-kernel/>Understanding Linux Kernel</a></li><li class=file><a href=https://minuk.dev/wiki/mathematical-statistics/ title=./wiki/mathematical-statistics/>Mathematical Statistics</a></li><li class=file><a href=https://minuk.dev/wiki/effective-debugging/ title=./wiki/effective-debugging/>Effective Debugging</a></li><li class=file><a href=https://minuk.dev/wiki/effective-debugging/chapter-1--%EA%B3%A0%EC%B0%A8%EC%9B%90-%EC%A0%84%EB%9E%B5/ title=./wiki/effective-debugging/chapter-1--%EA%B3%A0%EC%B0%A8%EC%9B%90-%EC%A0%84%EB%9E%B5/>Effective Debugging/Chapter 1. 고차원 전략</a></li><li class=file><a href=https://minuk.dev/wiki/effective-debugging/chapter-2--%EB%B2%94%EC%9A%A9%EC%A0%81%EC%9D%B8-%EB%94%94%EB%B2%84%EA%B9%85-%EA%B8%B0%EB%B2%95/ title=./wiki/effective-debugging/chapter-2--%EB%B2%94%EC%9A%A9%EC%A0%81%EC%9D%B8-%EB%94%94%EB%B2%84%EA%B9%85-%EA%B8%B0%EB%B2%95/>Effective Debugging/Chapter 2. 범용적인 디버깅 기법</a></li><li class=file><a href=https://minuk.dev/wiki/effective-debugging/chapter-3--%EB%B2%94%EC%9A%A9-%EB%8F%84%EA%B5%AC%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EA%B8%B0%EB%B2%95/ title=./wiki/effective-debugging/chapter-3--%EB%B2%94%EC%9A%A9-%EB%8F%84%EA%B5%AC%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EA%B8%B0%EB%B2%95/>Effective Debugging/Chapter 3. 범용 도구를 활용한 기법</a></li><li class=file><a href=https://minuk.dev/wiki/effective-debugging/chapter-5--%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EA%B8%B0%EB%B2%95/ title=./wiki/effective-debugging/chapter-5--%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EA%B8%B0%EB%B2%95/>Effective Debugging/Chapter 5. 프로그래밍 기법</a></li><li class=file><a href=https://minuk.dev/wiki/effective-debugging/chatper-4--%EB%94%94%EB%B2%84%EA%B1%B0-%ED%99%9C%EC%9A%A9%EB%B2%95/ title=./wiki/effective-debugging/chatper-4--%EB%94%94%EB%B2%84%EA%B1%B0-%ED%99%9C%EC%9A%A9%EB%B2%95/>Effective Debugging/Chatper 4. 디버거 활용법</a></li><li class=file><a href=https://minuk.dev/wiki/effective-debugging/chatper-6--%EC%BB%B4%ED%8C%8C%EC%9D%BC-%EC%8B%9C%EA%B0%84-%EA%B8%B0%EB%B2%95/ title=./wiki/effective-debugging/chatper-6--%EC%BB%B4%ED%8C%8C%EC%9D%BC-%EC%8B%9C%EA%B0%84-%EA%B8%B0%EB%B2%95/>Effective Debugging/Chatper 6. 컴파일 시간 기법</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/ title=./wiki/modern-c++-design-pattern/>Modern C++ Design Pattern</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-1--%EA%B0%9C%EC%9A%94/ title=./wiki/modern-c++-design-pattern/chapter-1--%EA%B0%9C%EC%9A%94/>Modern C++ Design Pattern/Chatper 1. 개요</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-2--%EB%B9%8C%EB%8D%94/ title=./wiki/modern-c++-design-pattern/chapter-2--%EB%B9%8C%EB%8D%94/>Modern C++ Design Pattern/Chatper 2. 빌더</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-4--%ED%94%84%EB%A1%9C%ED%86%A0%ED%83%80%EC%9E%85/ title=./wiki/modern-c++-design-pattern/chapter-4--%ED%94%84%EB%A1%9C%ED%86%A0%ED%83%80%EC%9E%85/>Modern C++ Design Pattern/Chatper 4. 프로토타입</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-5--%EC%8B%B1%EA%B8%80%ED%84%B4/ title=./wiki/modern-c++-design-pattern/chapter-5--%EC%8B%B1%EA%B8%80%ED%84%B4/>Modern C++ Design Pattern/Chatper 5. 싱글턴</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-6--%EC%96%B4%EB%8C%91%ED%84%B0/ title=./wiki/modern-c++-design-pattern/chapter-6--%EC%96%B4%EB%8C%91%ED%84%B0/>Modern C++ Design Pattern/Chatper 6. 어댑터</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-7--%EB%B8%8C%EB%A6%BF%EC%A7%80/ title=./wiki/modern-c++-design-pattern/chapter-7--%EB%B8%8C%EB%A6%BF%EC%A7%80/>Modern C++ Design Pattern/Chatper 7. 브릿지</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-8--%EC%BB%B4%ED%8F%AC%EC%A7%80%ED%8A%B8/ title=./wiki/modern-c++-design-pattern/chapter-8--%EC%BB%B4%ED%8F%AC%EC%A7%80%ED%8A%B8/>Modern C++ Design Pattern/Chatper 8. 컴포지트</a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-9--%EB%8D%B0%EC%BD%94%EB%A0%88%EC%9D%B4%ED%84%B0/ title=./wiki/modern-c++-design-pattern/chapter-9--%EB%8D%B0%EC%BD%94%EB%A0%88%EC%9D%B4%ED%84%B0/>Modern C++ Design Pattern/Chatper 9. 데코레이터</a></li><li class=file><a href=https://minuk.dev/wiki/book-reviews/ title=./wiki/book-reviews/>Book Review</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/algorithm/ title=./wiki/lectures/algorithm/>lectures/algorithm</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/computer-architecture/ title=./wiki/lectures/computer-architecture/>lectures/computer architecture</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/image-processing/ title=./wiki/lectures/image-processing/>lectures/image processing</a></li><li class=file><a href=https://minuk.dev/wiki/lectures/ title=./wiki/lectures/>학교 수업</a></li><li class=file><a href=https://minuk.dev/wiki/tool-configuration/ title=./wiki/tool-configuration/>Tool configuration</a></li><li class=file><a href=https://minuk.dev/wiki/ssh-server/ title=./wiki/ssh-server/>SSH Server Configuration</a></li><li class=file><a href=https://minuk.dev/wiki/firewall/ title=./wiki/firewall/>Firewall (방화벽) Configuration</a></li><li class=file><a href=https://minuk.dev/wiki/ftp/ title=./wiki/ftp/>ftp server command</a></li><li class=file><a href=https://minuk.dev/wiki/user/ title=./wiki/user/>linux user command</a></li><li class=file><a href=https://minuk.dev/wiki/brightness/ title=./wiki/brightness/>Brightness (화면 밝기 조절) command</a></li><li class=file><a href=https://minuk.dev/wiki/wifi-command-line/ title=./wiki/wifi-command-line/>Wifi commands</a></li><li class=file><a href=https://minuk.dev/wiki/wifi/ title=./wiki/wifi/>Wifi commands</a></li><li class=file><a href=https://minuk.dev/wiki/linux-command/ title=./wiki/linux-command/>Linux Command 모음</a></li><li class=file><a href=https://minuk.dev/wiki/docker/ title=./wiki/docker/>docker</a></li><li class=file><a href=https://minuk.dev/wiki/sql/ title=./wiki/sql/>SQL</a></li><li class=file><a href=https://minuk.dev/wiki/typescript/function/ title=./wiki/typescript/function/>Typescript/Function</a></li><li class=file><a href=https://minuk.dev/wiki/typescript/class/ title=./wiki/typescript/class/>Typescript/Class</a></li><li class=file><a href=https://minuk.dev/wiki/typescript/interface/ title=./wiki/typescript/interface/>Typescript/Interface</a></li><li class=file><a href=https://minuk.dev/wiki/typescript/variable-declaration/ title=./wiki/typescript/variable-declaration/>Typescript/Variable Declaration</a></li><li class=file><a href=https://minuk.dev/wiki/typescript/types/ title=./wiki/typescript/types/>Typescript/Types</a></li><li class=file><a href=https://minuk.dev/wiki/typescript/ title=./wiki/typescript/>Typescript</a></li><li class=file><a href=https://minuk.dev/wiki/graphql-typescript/ title=./wiki/graphql-typescript/>graphql typescript (deprecated)</a></li><li class=file><a href=https://minuk.dev/wiki/winston/ title=./wiki/winston/>winston</a></li><li class=file><a href=https://minuk.dev/wiki/jest/ title=./wiki/jest/>Jest</a></li><li class=file><a href=https://minuk.dev/wiki/sequelize/ title=./wiki/sequelize/>Sequelize</a></li><li class=file><a href=https://minuk.dev/wiki/fetch/ title=./wiki/fetch/>Fetch 문법 간단 정리</a></li><li class=file><a href=https://minuk.dev/wiki/promise/ title=./wiki/promise/>Promise 정리</a></li><li class=file><a href=https://minuk.dev/wiki/javascript/ title=./wiki/javascript/>JavaScript</a></li><li class=file><a href=https://minuk.dev/wiki/nexus/ title=./wiki/nexus/>Nexus</a></li><li class=file><a href=https://minuk.dev/wiki/ssdsolid-state-drive/ title=./wiki/ssdsolid-state-drive/>SSD(Solid-State Drive)</a></li><li class=file><a href=https://minuk.dev/wiki/pintos/ title=./wiki/pintos/>Pintos</a></li><li class=file><a href=https://minuk.dev/wiki/%EB%B2%84%EC%8A%A4-%EC%8B%9C%EA%B0%84-%EB%A9%94%EB%AA%A8/ title=./wiki/%EB%B2%84%EC%8A%A4-%EC%8B%9C%EA%B0%84-%EB%A9%94%EB%AA%A8/>Bus 시간 메모</a></li><li class=file><a href=https://minuk.dev/wiki/5-articles-per-week/ title=./wiki/5-articles-per-week/>5 articles per week</a></li><li class=file><a href=https://minuk.dev/wiki/%EC%8D%A9%EC%96%B4%EB%B2%84%EB%A6%B0-query-language/ title=./wiki/%EC%8D%A9%EC%96%B4%EB%B2%84%EB%A6%B0-query-language/>썩어버린 Query Language</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/ title=./wiki/%ED%9A%8C%EA%B3%A0/>회고 모음</a></li><li class=file><a href=https://minuk.dev/wiki/memory_leak/ title=./wiki/memory_leak/>Javascript Memory Leak</a></li><li class=file><a href=https://minuk.dev/wiki/%EC%86%A1%ED%8E%B8%EB%8C%80%ED%9A%8C/ title=./wiki/%EC%86%A1%ED%8E%B8%EB%8C%80%ED%9A%8C/>송편 생성기 (추석 대회)</a></li><li class=file><a href=https://minuk.dev/wiki/endurable_transient_inconsistency_in_byte_addressable_persistent_b+-tree/ title=./wiki/endurable_transient_inconsistency_in_byte_addressable_persistent_b+-tree/>Endurable Transient Inconsistency in Byte Addressable Persistent B+-Tree</a></li><li class=file><a href=https://minuk.dev/wiki/ssd-%EA%B3%B5%EB%B6%80%EC%9E%90%EB%A3%8C-%EB%AA%A8%EC%9D%8C/ title=./wiki/ssd-%EA%B3%B5%EB%B6%80%EC%9E%90%EB%A3%8C-%EB%AA%A8%EC%9D%8C/>SSD 공부 자료 모음</a></li><li class=file><a href=https://minuk.dev/wiki/%EA%B0%9C%EB%B0%9C_todo/ title=./wiki/%EA%B0%9C%EB%B0%9C_todo/>개발 TODO</a></li><li class=file><a href=https://minuk.dev/wiki/f2fs/ title=./wiki/f2fs/>F2FS</a></li><li class=file><a href=https://minuk.dev/wiki/%EC%84%A4%EB%8C%80%ED%9A%8C/ title=./wiki/%EC%84%A4%EB%8C%80%ED%9A%8C/>설대회</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-01-01/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-01-01/>회고/2020-01-01</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-01-17/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-01-17/>회고/2020-01-17</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2019-11-24/ title=./wiki/%ED%9A%8C%EA%B3%A0/2019-11-24/>회고/2019.11.24</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2019-10-19/ title=./wiki/%ED%9A%8C%EA%B3%A0/2019-10-19/>회고/2019.10.19</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2019-09-19/ title=./wiki/%ED%9A%8C%EA%B3%A0/2019-09-19/>회고/2019.09.19</a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2019-09-18/ title=./wiki/%ED%9A%8C%EA%B3%A0/2019-09-18/>회고/2019.09.18</a></li><li class=file><a href=https://minuk.dev/wiki/2024-12-23/ title=./wiki/2024-12-23/></a></li><li class=file><a href=https://minuk.dev/wiki/2025-01-05/ title=./wiki/2025-01-05/></a></li><li class=file><a href=https://minuk.dev/wiki/daily/2025-01-10/ title=./wiki/daily/2025-01-10/></a></li><li class=file><a href=https://minuk.dev/wiki/daily/drawing-2025-01-05-06.04.41.excalidraw/ title=./wiki/daily/drawing-2025-01-05-06.04.41.excalidraw/></a></li><li class=file><a href=https://minuk.dev/wiki/daily/drawing-2025-01-05-06.04.49.excalidraw/ title=./wiki/daily/drawing-2025-01-05-06.04.49.excalidraw/></a></li><li class=file><a href=https://minuk.dev/wiki/daily/drawing-2025-01-05-06.04.59.excalidraw/ title=./wiki/daily/drawing-2025-01-05-06.04.59.excalidraw/></a></li><li class=file><a href=https://minuk.dev/wiki/drawings/drawing-2025-01-05-05.12.23.excalidraw/ title=./wiki/drawings/drawing-2025-01-05-05.12.23.excalidraw/></a></li><li class=file><a href=https://minuk.dev/wiki/drawings/drawing-2025-01-05-05.54.32.excalidraw/ title=./wiki/drawings/drawing-2025-01-05-05.54.32.excalidraw/></a></li><li class=file><a href=https://minuk.dev/wiki/excalidraw/test-draw/ title=./wiki/excalidraw/test-draw/></a></li><li class=file><a href=https://minuk.dev/wiki/ipad/ title=./wiki/ipad/></a></li><li class=file><a href=https://minuk.dev/wiki/jekyll-%EA%B8%B0%EB%B0%98-wiki-%EC%97%90%EC%84%9C-hugo-%EB%A1%9C-%EB%84%98%EC%96%B4%EA%B0%80%EA%B8%B0/ title=./wiki/jekyll-%EA%B8%B0%EB%B0%98-wiki-%EC%97%90%EC%84%9C-hugo-%EB%A1%9C-%EB%84%98%EC%96%B4%EA%B0%80%EA%B8%B0/></a></li><li class=file><a href=https://minuk.dev/wiki/lectures/compiler/ title=./wiki/lectures/compiler/></a></li><li class=file><a href=https://minuk.dev/wiki/lectures/signal_and_system/ title=./wiki/lectures/signal_and_system/></a></li><li class=file><a href=https://minuk.dev/wiki/macos-initialization/ title=./wiki/macos-initialization/></a></li><li class=file><a href=https://minuk.dev/wiki/modern-c++-design-pattern/chapter-3--%ED%8C%A9%ED%86%A0%EB%A6%AC/ title=./wiki/modern-c++-design-pattern/chapter-3--%ED%8C%A9%ED%86%A0%EB%A6%AC/></a></li><li class=file><a href=https://minuk.dev/wiki/test.excalidraw/ title=./wiki/test.excalidraw/></a></li><li class=file><a href=https://minuk.dev/wiki/test/ title=./wiki/test/></a></li><li class=file><a href=https://minuk.dev/wiki/ucpc_2018_%EC%98%88%EC%84%A0/ title=./wiki/ucpc_2018_%EC%98%88%EC%84%A0/></a></li><li class=file><a href=https://minuk.dev/wiki/%EB%8D%B0%EC%A4%91%EC%96%B4%EC%84%A4/ title=./wiki/%EB%8D%B0%EC%A4%91%EC%96%B4%EC%84%A4/></a></li><li class=file><a href=https://minuk.dev/wiki/%EC%9D%98%EA%B2%AC-%EB%A9%94%EB%AA%A8/ title=./wiki/%EC%9D%98%EA%B2%AC-%EB%A9%94%EB%AA%A8/></a></li><li class=file><a href=https://minuk.dev/wiki/%EC%A3%BC%EC%9E%A5-%EB%A9%94%EB%AA%A8/ title=./wiki/%EC%A3%BC%EC%9E%A5-%EB%A9%94%EB%AA%A8/></a></li><li class=file><a href=https://minuk.dev/wiki/%ED%82%A4%EC%9B%8C%EB%93%9C-%EB%A9%94%EB%AA%A8/ title=./wiki/%ED%82%A4%EC%9B%8C%EB%93%9C-%EB%A9%94%EB%AA%A8/></a></li><li class=file><a href=https://minuk.dev/wiki/%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9A%A9/ title=./wiki/%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9A%A9/></a></li><li class=file><a href=https://minuk.dev/wiki/%ED%9A%8C%EA%B3%A0/2020-05-30/ title=./wiki/%ED%9A%8C%EA%B3%A0/2020-05-30/></a></li><li class=file><a href=https://minuk.dev/wiki/tags/ title=./wiki/tags/>tag page</a></li></ul></li><li class=file><a href=https://minuk.dev/about/ title=./about/>about</a></li></ul></aside><aside class=exapandable></aside><article class=main><button class=sidebar-toggle-btn type=menu aria-expanded=false aria-haspopup=true>
<i class="bi bi-list"></i></button><div class=title><h1 class=title-header>linux-debug/scheduling</h1></div><a href=https://github.com/minuk-dev/minuk-dev.github.io/blame/master/src/content/wiki/linux-debug/scheduling.md><h5>created : Wed, 09 Dec 2020 13:30:45 +0900</h5><h5>modified : Wed, 23 Jun 2021 15:35:51 +0900</h5></a><div class=article-meta><div class="breadcumb content"><i class="bi bi-folder"></i>
Front Page
[[linux-debug]]</div></div><div class=list-terms><ul><i class="bi bi-tags" title=Tags></i>
<a href=/tags/linux class=tag-btn>linux</a></ul></div><aside class=navbar id=nav-toc style=text-align:left><nav id=TableOfContents><ul><li><a href=#주요-키워드>주요 키워드</a><ul><li><a href=#선점-스케쥴링과-비선점-스케쥴링-비교>선점 스케쥴링과 비선점 스케쥴링 비교</a></li></ul></li><li><a href=#스케줄링-정책>스케줄링 정책</a><ul><li><a href=#스케줄러-클래스>스케줄러 클래스</a></li><li><a href=#런큐>런큐</a></li><li><a href=#우선순위nice>우선순위(nice)</a></li></ul></li><li><a href=#프로세스-상태-관리>프로세스 상태 관리</a><ul><li><a href=#프로세스-상태>프로세스 상태</a></li><li><a href=#프로세스-상태-변화>프로세스 상태 변화</a></li><li><a href=#프로세스-상태-변화-함수-목록>프로세스 상태 변화 함수 목록</a></li><li><a href=#task_running실행-대기으로-바뀔-때-호출되는-함수>TASK_RUNNING(실행 대기)으로 바뀔 때 호출되는 함수</a></li><li><a href=#task_runningcpu-실행로-바뀔-때-호출하는-함수>TASK_RUNNING(CPU 실행)로 바뀔 때 호출하는 함수</a></li><li><a href=#task_interruptible-상태로-바뀔-때-호출하는-함수>TASK_INTERRUPTIBLE 상태로 바뀔 때 호출하는 함수</a></li><li><a href=#task_uninterruptible-상태로-바뀔-때-호출하는-함수>TASK_UNINTERRUPTIBLE 상태로 바뀔 때 호출하는 함수</a></li></ul></li><li><a href=#스케줄러-클래스-1>스케줄러 클래스</a><ul><li><a href=#sched_class-구조체>sched_class 구조체</a></li><li><a href=#5가지-스케줄러-클래스>5가지 스케줄러 클래스</a></li><li><a href=#프로세스를-스케줄러에-등록>프로세스를 스케줄러에 등록</a></li><li><a href=#세부-함수-호출>세부 함수 호출</a></li></ul></li><li><a href=#런큐-1>런큐</a><ul><li><a href=#runqueues-변수>runqueues 변수</a></li></ul></li><li><a href=#cfs-스케줄러>CFS 스케줄러</a><ul><li><a href=#cfs-스케줄러-알고리즘>CFS 스케줄러 알고리즘</a></li><li><a href=#cfs-관련-세부-함수>CFS 관련 세부 함수</a></li></ul></li><li><a href=#선점-스케줄링>선점 스케줄링</a><ul><li><a href=#선점-스케줄링-진입점>선점 스케줄링 진입점</a></li></ul></li></ul></nav></aside><div class=content><h2 id=주요-키워드>주요 키워드</h2><ul><li>scheduling : 실행 대기 중인 프로세스 중에서 우선순위가 가장 높은 프로세스를 선택해 CPU에서 실행시킴<ul><li>Preemptive Scheduling : 강제로 CPU에서 실행 중인 프로세스를 비우고 새로운 프로세스 실행</li><li>Non-Preemptive Scheduling : 프로세스가 자발적으로 스케줄링 요청</li></ul></li><li>context-switching : cpu에서 실행 중인 프로세스의 레지스터 세트를 비우고 새로운 프로세스 레지스터 세트를 채우는 동작, 아키텍쳐마다 구현 방식이 다름</li><li>scheduling policy : 스케쥴링 시 어떤 방식과 규칙으로 다음에 실행할 프로세스를 선택할지 결정</li><li>scheduler class : 5가지 커널 스케쥴러 세부동작을 모듈화한 자료구조 이자 인터페이스, 프로세스는 스케쥴러 클레스를 우선순위에 따라 선택할 수 있음</li><li>run queue : 실행 대기 중인 프로세스를 관리하는 자료구조, percpu 타입 변수</li><li>proirity : 유저 공간에서 설정한 nice와 커널 우선순위가 존재</li></ul><h3 id=선점-스케쥴링과-비선점-스케쥴링-비교>선점 스케쥴링과 비선점 스케쥴링 비교</h3><ul><li>Preemptive Scheduling<ul><li>실행 중인 프로세스를 강제로 CPU에서 실행 중지</li><li>새로운 프로세스가 CPU에서 실행</li><li>선점 스케쥴링 시작점<ul><li>인터럽트 핸들러를 처리하고 난 후 인터럽트가 발생하기 전에 코드로 되돌아가기 직전</li><li>시스템 콜의 핸들러 함수를 처리하고 난 후 유저 공간으로 복귀하기 직전</li></ul></li></ul></li><li>비선점 스케쥴링<ul><li>프로세스가 자발적으로 스케줄링 요청</li><li>비선점 스케줄링 시작점<ul><li>입출력(I/O) 동작을 시작할 때</li><li>뮤텍스를 획득하지 못하고 휴먼 상태에 진입할 때</li></ul></li></ul></li></ul><h2 id=스케줄링-정책>스케줄링 정책</h2><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=#define%20SCHED_NORMAL%20%20%20%200%0a#define%20SCHED_FIFO%20%20%20%20%20%201%0a#define%20SCHED_RR%20%20%20%20%20%20%20%202%0a#define%20SCHED_BATCH%20%20%20%20%203%0a#define%20SCHED_IDLE%20%20%20%20%20%205%0a#define%20SCHED_DEADLINE%20%206>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#define SCHED_NORMAL    0
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define SCHED_FIFO      1
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define SCHED_RR        2
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define SCHED_BATCH     3
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define SCHED_IDLE      5
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define SCHED_DEADLINE  6</span></span></span></code></pre></div></div><h3 id=스케줄러-클래스>스케줄러 클래스</h3><ul><li><p>stop 스케줄러</p><ul><li><a href=http://jake.dothome.co.kr/stop-sched/>참고- 문C 블로그</a></li><li>어떠한 스케줄러보다 우선 순위가 더 높아 preemption 되지 않으며, 다른 cpu로 migration도 허용되지 않다. 모든 요청에 대해 대부분 거절하거나 아무런 일도 하지 않는다.</li></ul></li><li><p>deadline 스케줄러</p><ul><li><a href=http://jake.dothome.co.kr/dl-scheduler/>참고- 문C 블로그</a></li><li>2013년 3월 Kernel v3.14에서 소개</li><li>EDF + CBS 알고리즘 기반<ul><li>EDF(Earliest Deadline First)<ul><li>작업이 N 개일때 복잡도는 O(n^2) 로 알려져 있으며, 수학적으로 최적이라는 것이 증명되어 있지만, 현실적으로 프로세스의 마감시간을 예측하는 것이 어렵다.</li><li>예시 : P1이 수행시간이 1, 주기가 8, P2가 수행시간이 2, 주기가 5, P3가 수행시간이 4, 주기가 10이고, 1단위 시간이 10ms 일때 CPU 사용량은 1/8 + 2/5 + 4/10 = 0.925이기에 스케줄링이 가능하다고 판단하며 스케줄링한다.</li></ul></li><li>CBS(Constatn Bandwidth Server)<ul><li>자료가 안나오길래 아래 적어둔 논문 기반으로 정보를 적는다.</li><li>논문 : Intergrating multimedia applications in hard real-time systems</li><li>1998년도에 소개된 예약기반(reservation-based) 스케줄링 알고리즘</li><li>$$\text{ a budget } c_s \text{ and by a ordered pair } (Q_s, T_s), \text{ where } Q_s \text{ is the maximum budget and } T_s \text{ is the period of the server }$$</li><li>$$\text{ server bandwidth } U_s = Q_s / T_s$$</li><li>$$\text{ At each instant, a fixed deadline } d_{s, k}$$</li><li>$$\text{ Initially, } d_{s, 0} = 0$$</li><li>각 작업들은 동적인 마감시간(deadline)을 가지고 있고 이는 초기에는 현제 서버의 마감시간과 동일하게 된다.</li><li>작업들이 실행되면 그와 같은 양이 예산에서 빠지며, 예산이 0이 됬을 때 서버의 최대 예산인 Q_s를 다시 채우고, 새로운 서버 마감시간이 생기게된다. 이 때 새로운 마감시간은 T_s만큼 더한것이다. \(d_{s, k + 1} = d_{s, k} + T_s \)</li><li>흐으으음&mldr; 이 이상 자세히 적을 필요는 없을 듯, 그냥 대충 예산 개념이 존재해서 스케줄링 한다? 정도까지만 정리함. 사실상 정리하면 그냥 논문 번역이 될듯</li></ul></li></ul></li><li>처음에는 UP 시스템용으로 구현되었다가 SMP 시스템에서도 채용함. 각 cpu의 earliest deadline을 관리하고 다른 CPU로 전달하여 효과적으로 스케줄링한다.</li><li>상당히 최신에 추가된 내용이며, 2017년에도 새 버전의 deadline 스케줄러가 소개됬다고 한다.</li><li>Stop 스케줄러 바로 다음의 우선순위를 가짐</li></ul></li><li><p>RT 스케줄러</p><ul><li>stop - deadline 다음 순서의 우선순위를 가지고 있다.</li><li>rt 런큐는 CPU 수만큼 생성된다.</li></ul></li><li><p>CFS 스케줄러</p><ul><li><a href=https://goodgid.github.io/Scheduler-CFS/>참고</a></li><li>rb 데이터 구조를 사용하며 O(logN) 성능을 가지는 스케줄러</li><li>특징<ul><li>공평한 CPU 시간</li><li>가상 런타임</li><li>대기자 공평성</li><li>RB-트리</li></ul></li></ul></li><li><p>Idle 스케줄러</p><ul><li><a href=http://jake.dothome.co.kr/idle-sched/>참고- 문C 블로그</a></li><li>어떠한 스케줄러보다 우선순위가 낮다.</li><li>core 마다 1개씩 지정되어 있어 다른 cpu로의 migration이 필요 없다.</li></ul></li></ul><h3 id=런큐>런큐</h3><ul><li>실행 대기상태 프로세스와 CPU에서 실행 중인 프로세스를 관리하는 자료구조</li></ul><h3 id=우선순위nice>우선순위(nice)</h3><ul><li>-20 ~ 19의 값을 가지며 커널공간에서 100 ~ 139 범위 값으로 변환되어 관리된다.(0 ~ 99 는 RT)</li><li>RT(Real-Time) 프로세스의 우선순위 범위<ul><li>0 ~ 99 사이의 우선순위를 가짐</li><li>SCHED_FIFO 이며, 우선순위가 더 높은 RT 프로세스가 없으면 계속 CPU를 점유해 사용한다.</li></ul></li></ul><h2 id=프로세스-상태-관리>프로세스 상태 관리</h2><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=#define%20TASK_RUNNING%20%20%20%20%20%20%20%20%20%200x0000%0a#define%20TASK_INTERRUPTIBLE%20%20%20%200x0001%0a#define%20TASK_UNINTERRUPTIBLE%20%200x0002%0a#define%20__TASK_STOPPED%20%20%20%20%20%20%20%200x0004%0a#define%20__TASK_TRACED%20%20%20%20%20%20%20%20%200x0008>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#define TASK_RUNNING          0x0000
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define TASK_INTERRUPTIBLE    0x0001
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define TASK_UNINTERRUPTIBLE  0x0002
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define __TASK_STOPPED        0x0004
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define __TASK_TRACED         0x0008</span></span></span></code></pre></div></div><h3 id=프로세스-상태>프로세스 상태</h3><ul><li>TASK_RUNNING : 실행대기<ul><li>프로세스가 런큐에 삽입된 후 실행을 기다리는 상태</li><li>스케줄러는 TASK_RUNNING(실행 대기)상태에 있는 프로세스 중에서 CPU에서 실행할 프로세스를 선택</li></ul></li><li>TASK_RUNNING : CPU 실행<ul><li>프로세스가 CPU에서 실행 중인 상태</li><li>CPU 레지스터 세트에는 현재 실행 중인 프로세스의 상태 정보로 채워짐</li></ul></li><li>TASK_INTERRUPTIBLE<ul><li>프로세스가 휴면 상태에 진입한 상태</li><li>프로세스를 깨우면 다시 TASK_RUNNING(실행 대기) 상태로 변경됨</li></ul></li><li>TASK_UNINTERRUPTIBLE<ul><li>프로세스가 특정 조건으로 깨워나고 싶을 때 설정하는 상태</li><li>보통 스스로 깨어날 조건을 설정한 다음에 TASK_UNINTERRUPTIBLE 상태로 변경</li><li>뮤텍스를 얻지 못하거나 입출력(I/O) 동작 중에 TASK_UNINTERRUPTIBLE 상태로 변경</li></ul></li></ul><h4 id=task_interruptible과-task_uninterruptible-상태의-차이점>TASK_INTERRUPTIBLE과 TASK_UNINTERRUPTIBLE 상태의 차이점</h4><ul><li>I/O 나 mutex 같이 깨어나봤자 의미가 없을때, 자신을 깨울수 있는 방법과 시기(I/O가 종료되거나, mutex를 획득할수 있어질때)를 설정하고 TASK_UNINTERRUPTIBLE 로 둔다.</li><li>TASK_UNINTERRUPTIBLE 상태의 프로세스가 비정상으로 많은 경우<ul><li>다수의 프로세스들이 뮤텍스를 획득하지 못해 자신을 TASK_UNINTERRUPTIBLE 상태로 바꾸고 휴면 상태에 진입</li><li>I/O 동작 중에 외부 장치와 인터페이싱에 문제가 있음</li></ul></li><li>TASK_RUNNING 상태의 프로세스가 비정상으로 많은 경우<ul><li>특정 프로세스가 CPU를 계속 점유하고 실행중</li><li>인터럽트가 비정상적으로 많이 발생해서 프로세스 선점 스케줄링이 제대로 수행되지 못함.</li></ul></li></ul><h3 id=프로세스-상태-변화>프로세스 상태 변화</h3><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=#ZgotmplZ>
<i class="bi bi-copy"></i></button></div><pre><code>@startuml
[*] --&gt; TASK_RUNNING_실행대기
TASK_RUNNING_실행대기 --&gt; TASK_RUNNING_CPU실행 : 1
TASK_RUNNING_CPU실행 --&gt; TASK_INTERRUPTIBLE : 2
TASK_RUNNING_CPU실행 --&gt; TASK_UNINTERRUPTIBLE : 3
TASK_INTERRUPTIBLE --&gt; TASK_RUNNING_실행대기 : 4
TASK_RUNNING_CPU실행 --&gt; TASK_DEAD : 5
TASK_UNINTERRUPTIBLE --&gt; TASK_RUNNING_실행대기
TASK_DEAD --&gt; [*]
@enduml</code></pre></div><ul><li><ol><li>실행대기(TASK_RUNNING) -> CPU 실행중(TASK_RUNNING)</li></ol><ul><li>context switching 이라 부르며, CPU register sets을 저장하고, 다음 실행될 THREAD의 CPU register sets을 불러온다.</li></ul></li><li><ol start=2><li>CPU 실행(TASK_RUNNING) -> 휴면(TASK_INTERRUPTIBLE)</li></ol></li><li><ol start=3><li>CPU 실행(TASK_RUNNING) -> 휴면(TASK_UNINTERRUPTIBLE)</li></ol><ul><li>특정 조건에서만 깨어날수 있게 됨</li><li>자신이 깨어날 조건 설정 -> TASK_UNINTERRUPTIBLE 상태로 변경 -> <code>schedule()</code> 함수를 호출해 휴면상태에 진입</li><li>I/O를 실행할때, 뮤텍스를 획득하지 못했을 때</li></ul></li><li><ol start=4><li>휴면(TASK_INTERRUPTIBLE) -> 실행 대기(TASK_RUNNING)</li></ol><ul><li><code>wake_up_process()</code> 함수를 호출해서 프로세스를 깨울때의 상황</li></ul></li><li><ol start=5><li>휴면(TASK_UNINTERRUPTIBLE) -> 실행 대기(TASK_RUNNING)</li></ol><ul><li>I/O 실행 완료 또는 뮤텍스를 해제한 프로세스가 뮤텍스를 기다리고 있는 프로세스를 깨울때</li></ul></li></ul><h3 id=프로세스-상태-변화-함수-목록>프로세스 상태 변화 함수 목록</h3><ul><li>TASK_RUNNING(실행 대기)<ul><li>wake_up_interruptible()</li><li>wake_up_new_task()</li><li>wake_up_process()</li><li>yeild()</li><li>do_nanosleep()</li></ul></li><li>TASK_RUNNING(CPU 실행)<ul><li>schedule()</li></ul></li><li>TASK_INTERRUPTIBLE<ul><li>wait_event_interruptible()</li><li>do_sigtimedwiat()</li><li>sys_pause()</li><li>do_nano_sleep()</li></ul></li><li>TASK_UNINTERRUPTIBLE<ul><li>io_wait_event()</li><li>mutex_lock()</li><li>usleep_range()</li><li>msleep()</li><li>wait_for_completion()</li></ul></li></ul><h3 id=task_running실행-대기으로-바뀔-때-호출되는-함수>TASK_RUNNING(실행 대기)으로 바뀔 때 호출되는 함수</h3><ul><li><p>프로세스를 깨울때</p></li><li><p>프로세스를 처음 생성하고 실행 요청을 할 때</p></li><li><p>프로세스 관련 정보를 업데이트 할때</p></li><li><p>wake_up_new_task()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="void%20wake_up_new_task%28struct%20task_struct%20*p%29%0a%7b%0a%20%20struct%20rq_flags%20rf;%0a%20%20struct%20rq%20*rq;%0a%0a%20%20raw_spin_lock_irqsave%28&amp;p-%3epi_lock,%20rf.flags%29;%0a%20%20p-%3estate%20=%20TASK_RUNNING;%0a%20%20/*%20skip%20*/%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>wake_up_new_task</span>(<span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rq_flags rf;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>raw_spin_lock_irqsave</span>(<span style=color:#f92672>&amp;</span>p<span style=color:#f92672>-&gt;</span>pi_lock, rf.flags);
</span></span><span style=display:flex><span>  p<span style=color:#f92672>-&gt;</span>state <span style=color:#f92672>=</span> TASK_RUNNING;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><ul><li>_do_fork 에서 호출됨</li></ul></li><li><p>wake_up_process()</p><ul><li>wake_up_process() -> try_to_wake_up() -> ttwu_do_activate() -> ttwu_do_wakeup()</li><li>ttwu : try to wake up 의 약어</li></ul><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%20ttwu_do_wakeup%28struct%20rq%20*rq,%20struct%20task_struct%20*p,%20int%20wake_flags,%0a%20%20struct%20rq_flags%20*rf%29%0a%7b%0a%20%20check_preempt_curr%28rq,%20p,%20wake_flags%29;/%0a%20%20p-%3estate%20=%20TASK_RUNNING;%0a%20%20trace_sched_wakeup%28p%29;%0a%20%20/*%20skip%20*/%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>ttwu_do_wakeup</span>(<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p, <span style=color:#66d9ef>int</span> wake_flags,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rq_flags <span style=color:#f92672>*</span>rf)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>check_preempt_curr</span>(rq, p, wake_flags);<span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>  p<span style=color:#f92672>-&gt;</span>state <span style=color:#f92672>=</span> TASK_RUNNING;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>trace_sched_wakeup</span>(p);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li><p>yield()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=void%20__sched%20yield%28void%29%0a%7b%0a%20%20set_current_state%28TASK_RUNNING%29;%0a%20%20do_sched_yield%28%29;%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> __sched <span style=color:#a6e22e>yield</span>(<span style=color:#66d9ef>void</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>set_current_state</span>(TASK_RUNNING);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>do_sched_yield</span>();
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li><p>do_nanosleep()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=static%20int%20__sched%20do_nanosleep%28struct%20hrttimer_sleepr%20*t,%20enum%20hrtimer_mode%20mode%29%0a%7b%0a%20%20struct%20restart_block%20*restart;%0a%20%20/*%20skip%20*/%0a%20%20__set_current_state%28TASK_RUNNING%29;%0a%20%20/*%20skip%20*/%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> __sched <span style=color:#a6e22e>do_nanosleep</span>(<span style=color:#66d9ef>struct</span> hrttimer_sleepr <span style=color:#f92672>*</span>t, <span style=color:#66d9ef>enum</span> hrtimer_mode mode)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> restart_block <span style=color:#f92672>*</span>restart;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>__set_current_state</span>(TASK_RUNNING);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li></ul><h3 id=task_runningcpu-실행로-바뀔-때-호출하는-함수>TASK_RUNNING(CPU 실행)로 바뀔 때 호출하는 함수</h3><ul><li>schedule()</li></ul><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%20__sched%20notrace%20__schedule%28bool%20preempt%29%0a%7b%0a%20%20struct%20rq%20*rq;%0a%20%20int%20cput;%0a%0a%20%20cpu%20=%20smp_processor_id%28%29;%0a%20%20rq%20=%20cpu_rq%28cpu%29;%0a%0a%20%20if%20%28likely%28prev%20!=%20next%29%29%20%7b%0a%20%20%20%20rq-%3enr_switches%20++;%0a%20%20%20%20rq-%3ecurr%20=%20next;%0a%0a%20%20%20%20/*%20Also%20unlocks%20the%20rq:%20*/%0a%20%20%20%20rq%20=%20context_switch%28rq,%20prev,%20next,%20&amp;rf%29;%0a%20%20%7d%20else%20%7b%0a%20%20/*%20skip%20*/%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> __sched notrace <span style=color:#a6e22e>__schedule</span>(<span style=color:#66d9ef>bool</span> preempt)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> cput;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  cpu <span style=color:#f92672>=</span> <span style=color:#a6e22e>smp_processor_id</span>();
</span></span><span style=display:flex><span>  rq <span style=color:#f92672>=</span> <span style=color:#a6e22e>cpu_rq</span>(cpu);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>likely</span>(prev <span style=color:#f92672>!=</span> next)) {
</span></span><span style=display:flex><span>    rq<span style=color:#f92672>-&gt;</span>nr_switches <span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    rq<span style=color:#f92672>-&gt;</span>curr <span style=color:#f92672>=</span> next;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* Also unlocks the rq: */</span>
</span></span><span style=display:flex><span>    rq <span style=color:#f92672>=</span> <span style=color:#a6e22e>context_switch</span>(rq, prev, next, <span style=color:#f92672>&amp;</span>rf);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><h3 id=task_interruptible-상태로-바뀔-때-호출하는-함수>TASK_INTERRUPTIBLE 상태로 바뀔 때 호출하는 함수</h3><ul><li>wait_event_interruptible()</li></ul><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="#define%20wait_event_interruptible%28wq_head,%20condition%29%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%28%7b%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20int%20__ret%20=%200;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20might_sleep%28%29;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20if%20%28!%28condition%29%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20%20%20__retval%20=%20__wait_event_interruptible%28wq_head,%20condition%29;%20%20%5c%0a%20%20__ret;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%7d%29%0a%0a#define%20__wait_event_interruptible%28wq_head,%20condition%29%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20___wait_event%28wq_head,%20condition,%20TASK_INTERRUPTIBLE,%200,%200,%20%20%20%5c%0a%20%20%20%20schedule%28%29%29">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#define wait_event_interruptible(wq_head, condition)            \
</span></span></span><span style=display:flex><span><span style=color:#75715e>({                                                              \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  int __ret = 0;                                                \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  might_sleep();                                                \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  if (!(condition))                                             \
</span></span></span><span style=display:flex><span><span style=color:#75715e>    __retval = __wait_event_interruptible(wq_head, condition);  \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  __ret;                                                        \
</span></span></span><span style=display:flex><span><span style=color:#75715e>})
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define __wait_event_interruptible(wq_head, condition)          \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  ___wait_event(wq_head, condition, TASK_INTERRUPTIBLE, 0, 0,   \
</span></span></span><span style=display:flex><span><span style=color:#75715e>    schedule())</span></span></span></code></pre></div></div><ul><li>___wait_event()</li></ul><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="#define%20___wait_event%28wq_head,%20condition,%20state,%20exclusive,%20ret,%20cmd%29%20%20%5c%0a%28%7b%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20__label__%20__out;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20struct%20wait_queue_entry%20__wq_entry;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20long%20__ret%20=%20ret;%20/*%20explicit%20shadow%20*/%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20init_wait_entry%28&__wq_entry,%20exclusive%20?%20WQ_FLAG_EXCLUSIVE%20:%200%29;%20%20%20%20%20%5c%0a%20%20for%20%28;;%29%20%7b%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20%20%20long%20__int%20=%20prepare_to_wait_event%28&amp;wq_head,%20&__wq_entry,%20state%29;%20%20%5c%0a%20%20%20%20/*%20skip%20*/%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20%7d%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20finish_wait%28&amp;wq_head,%20&__wq_entry%29;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a__out:%20__ret;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%7d%29">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#define ___wait_event(wq_head, condition, state, exclusive, ret, cmd)  \
</span></span></span><span style=display:flex><span><span style=color:#75715e>({                                                                     \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  __label__ __out;                                                     \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  struct wait_queue_entry __wq_entry;                                  \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  long __ret = ret; </span><span style=color:#75715e>/* explicit shadow */</span><span style=color:#75715e>                              \
</span></span></span><span style=display:flex><span><span style=color:#75715e>                                                                       \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  init_wait_entry(&amp;__wq_entry, exclusive ? WQ_FLAG_EXCLUSIVE : 0);     \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  for (;;) {                                                           \
</span></span></span><span style=display:flex><span><span style=color:#75715e>    long __int = prepare_to_wait_event(&amp;wq_head, &amp;__wq_entry, state);  \
</span></span></span><span style=display:flex><span><span style=color:#75715e>    </span><span style=color:#75715e>/* skip */</span><span style=color:#75715e>                                                         \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  }                                                                    \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  finish_wait(&amp;wq_head, &amp;__wq_entry);                                  \
</span></span></span><span style=display:flex><span><span style=color:#75715e>__out: __ret;                                                          \
</span></span></span><span style=display:flex><span><span style=color:#75715e>})</span></span></span></code></pre></div></div><ul><li>prepare_to_wait_event()</li></ul><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="long%20prepare_to_wait_event%28struct%20wait_queue_head%20*wq_head,%20struct%20wait_queue_entry%20*wq_entry.%0a%20%20int%20saste%29%0a%7b%0a%20%20unsigned%20long%20flags;%0a%20%20long%20ret%20=%200;%0a%0a%20%20spin_lock_irqsave%28&amp;wq_head-%3elock,%20flags%29;%0a%20%20if%20%28unlikely%28signal_pending_state%28state,%20current%29%29%29%20%7b%0a%20%20%20%20/*%20skip%20*/%0a%20%20%7d%20else%20%7b%0a%20%20%20%20if%20%28list_empty%28&amp;wq_entry-%3eentry%29%29%20%7b%0a%20%20%20%20%20%20if%20%28wq_entry-%3eflags%20&%20WQ_FLAGS_EXCLUSIVE%29%0a%20%20%20%20%20%20%20%20__add_wait_queue_entry_tail%28wq_head,%20wq_entry%29;%0a%20%20%20%20%20%20else%0a%20%20%20%20%20%20%20%20__add_wait_queue%28wq_head,%20wq_entry%29;%0a%20%20%20%20%7d%0a%20%20%20%20set_current_state%28state%29;%0a%20%20%7d%0a%20%20/*%20skip%20*/%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>long</span> <span style=color:#a6e22e>prepare_to_wait_event</span>(<span style=color:#66d9ef>struct</span> wait_queue_head <span style=color:#f92672>*</span>wq_head, <span style=color:#66d9ef>struct</span> wait_queue_entry <span style=color:#f92672>*</span>wq_entry.
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> saste)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> flags;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>spin_lock_irqsave</span>(<span style=color:#f92672>&amp;</span>wq_head<span style=color:#f92672>-&gt;</span>lock, flags);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>unlikely</span>(<span style=color:#a6e22e>signal_pending_state</span>(state, current))) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>list_empty</span>(<span style=color:#f92672>&amp;</span>wq_entry<span style=color:#f92672>-&gt;</span>entry)) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (wq_entry<span style=color:#f92672>-&gt;</span>flags <span style=color:#f92672>&amp;</span> WQ_FLAGS_EXCLUSIVE)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>__add_wait_queue_entry_tail</span>(wq_head, wq_entry);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>__add_wait_queue</span>(wq_head, wq_entry);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>set_current_state</span>(state);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><ul><li>do_sigtimedwait()</li><li>sys_pause()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=SYSCALL_DEFINE0%28pause%29%0a%7b%0a%20%20while%20%28!signal_pending%28current%29%29%20%7b%0a%20%20%20%20__set_current_state%28TASK_INTERRUPTIBLE%29;%0a%20%20%20%20schedule%28%29;%0a%20%20%7d%0a%20%20return%20-ERESTARTNOHAND;%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#a6e22e>SYSCALL_DEFINE0</span>(pause)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>signal_pending</span>(current)) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>__set_current_state</span>(TASK_INTERRUPTIBLE);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>schedule</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span>ERESTARTNOHAND;
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><ul><li>펜딩된 시그널(자신에게 전달된 시그널)이 없는지 점검</li><li>자신을 TASK_INTERRUPTIBLE(휴면 상태)로 변경</li><li>schedule() 함수를 호출해 휴면상태로 진입</li></ul></li><li>do_nanosleep()</li></ul><h3 id=task_uninterruptible-상태로-바뀔-때-호출하는-함수>TASK_UNINTERRUPTIBLE 상태로 바뀔 때 호출하는 함수</h3><ul><li><p>io_wait_event()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=#define%20io_wait_event%28wq_head,%20condition%29%20%20%20%20%20%20%20%20%5c%0ado%20%7b%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20might_sleep%28%29;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20if%20%28condition%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20%20%20break;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%20%20__io_wait_event%28wq_head,%20condition%29;%20%20%20%20%20%20%20%20%20%20%20%5c%0a%7d%20while%20%280%29%0a%0a#define%20__io_wait_event%28wq_head,%20condition%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5c%0a%28void%29__wait_event%28wq_head,%20condition,%20TASK_UNINTERRUPTIBLE,%200,%200,%20%5c%0a%20%20io_schedule%28%29%29>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#define io_wait_event(wq_head, condition)        \
</span></span></span><span style=display:flex><span><span style=color:#75715e>do {                                             \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  might_sleep();                                 \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  if (condition)                                 \
</span></span></span><span style=display:flex><span><span style=color:#75715e>    break;                                       \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  __io_wait_event(wq_head, condition);           \
</span></span></span><span style=display:flex><span><span style=color:#75715e>} while (0)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define __io_wait_event(wq_head, condition)                        \
</span></span></span><span style=display:flex><span><span style=color:#75715e>(void)__wait_event(wq_head, condition, TASK_UNINTERRUPTIBLE, 0, 0, \
</span></span></span><span style=display:flex><span><span style=color:#75715e>  io_schedule())</span></span></span></code></pre></div></div></li><li><p>mutex_lock()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=static%20int%20__sched%0a__mutex_lock%28struct%20mutex%20*lock,%20long%20state,%20unsgined%20int%20subclass,%0a%20%20struct%20lockdep_map%20*nest_lock,%20unsigned%20long%20ip%29%0a%7b%0a%20%20return%20__mutex_lock_common%28lock,%20state,%20subclass,%20nest_lock,%20ip,%20NULL,%20false%29;%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> __sched
</span></span><span style=display:flex><span><span style=color:#a6e22e>__mutex_lock</span>(<span style=color:#66d9ef>struct</span> mutex <span style=color:#f92672>*</span>lock, <span style=color:#66d9ef>long</span> state, unsgined <span style=color:#66d9ef>int</span> subclass,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> lockdep_map <span style=color:#f92672>*</span>nest_lock, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> ip)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>__mutex_lock_common</span>(lock, state, subclass, nest_lock, ip, NULL, false);
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=static%20__always_inline%20int%20__sched%0a__mutex_lock_common%28struct%20mutex%20*lock,%20long%20state,%20unsigned%20int%20subclass,%0a%20%20struct%20lockdep_map%20*nest_lock,%20unsigned%20long%20ip,%0a%20%20struct%20ww_acquire_ctx%20*ww_ctx,%20const%20bool%20use_ww_ctx%29%0a%7b%0a%20%20/*%20skip%20*/%0a%20%20set_current_state%28state%29;%0a%20%20for%20%28;;%29%20%7b%0a%20%20%20%20/*%20skip%20*/%0a%20%20%20%20schedule_preempt_disabled%28%29;%0a%20%20%20%20/*%20skip%20*/%0a%20%20%7d%0a%20%20/*%20skip%20*/%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> __always_inline <span style=color:#66d9ef>int</span> __sched
</span></span><span style=display:flex><span><span style=color:#a6e22e>__mutex_lock_common</span>(<span style=color:#66d9ef>struct</span> mutex <span style=color:#f92672>*</span>lock, <span style=color:#66d9ef>long</span> state, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> subclass,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> lockdep_map <span style=color:#f92672>*</span>nest_lock, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> ip,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> ww_acquire_ctx <span style=color:#f92672>*</span>ww_ctx, <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>bool</span> use_ww_ctx)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>set_current_state</span>(state);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (;;) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>schedule_preempt_disabled</span>();
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li><p>usleep_range()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="void%20__sched%20usleep_range%28unsigned%20long%20min,%20unsigned%20long%20max%29%0a%7b%0a%20%20ktime_t%20exp%20=%20ktime_add_us%28ktime_get%28%29,%20min%29;%0a%20%20u64%20delta%20=%20%28u64%29%28max%20-%20min%29%20*%20NSEC_PER_USEC;%0a%0a%20%20for%20%28;;%29%20%7b%0a%20%20%20%20__set_current_state%28TASK_UNINTERRUPTIBLE%29;%0a%20%20%20%20/*%20Do%20not%20return%20before%20teh%20requested%20sleep%20time%20has%20elapsed%20*/%0a%20%20%20%20if%20%28!schedule_hrtimeout_range%28&%20exp,%20delta,%20HRTIMER_MODE_ABS%29%29%0a%20%20%20%20%20%20break;%0a%20%20%7d%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> __sched <span style=color:#a6e22e>usleep_range</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> min, <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> max)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>ktime_t</span> exp <span style=color:#f92672>=</span> <span style=color:#a6e22e>ktime_add_us</span>(<span style=color:#a6e22e>ktime_get</span>(), min);
</span></span><span style=display:flex><span>  u64 delta <span style=color:#f92672>=</span> (u64)(max <span style=color:#f92672>-</span> min) <span style=color:#f92672>*</span> NSEC_PER_USEC;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (;;) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>__set_current_state</span>(TASK_UNINTERRUPTIBLE);
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* Do not return before teh requested sleep time has elapsed */</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>schedule_hrtimeout_range</span>(<span style=color:#f92672>&amp;</span> exp, delta, HRTIMER_MODE_ABS))
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li><p>msleep()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="void%20msleep%28unsigned%20int%20msec%29%0a%7b%0a%20%20unsigned%20long%20timeout%20=%20msecs_to_jiffies%28msecs%29%20+%201;%0a%0a%20%20while%20%28timeout%29%0a%20%20%20%20timeout%20=%20schedule_timeout_uninterruptible%28timeout%29;%0a%7d%0a%0asigned%20long%20__sched%20schedule_timeout_uninterruptible%28signed%20long%20timeout%29%0a%7b%0a%20%20__set_current_state%28TASK_UNINTERRUPTIBLE%29;%0a%20%20return%20schedule_timeout%28timeout%29;%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>msleep</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> msec)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> timeout <span style=color:#f92672>=</span> <span style=color:#a6e22e>msecs_to_jiffies</span>(msecs) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> (timeout)
</span></span><span style=display:flex><span>    timeout <span style=color:#f92672>=</span> <span style=color:#a6e22e>schedule_timeout_uninterruptible</span>(timeout);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>signed</span> <span style=color:#66d9ef>long</span> __sched <span style=color:#a6e22e>schedule_timeout_uninterruptible</span>(<span style=color:#66d9ef>signed</span> <span style=color:#66d9ef>long</span> timeout)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>__set_current_state</span>(TASK_UNINTERRUPTIBLE);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>schedule_timeout</span>(timeout);
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li><p>wait_for_completion()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=void%20__sched%20wait_for_completion%28struct%20completion%20*x%29%0a%7b%0a%20%20wait_for_common%28x,%20MAX_SCHEDULE_TIMEOUT,%20TASK_UNINTERRUPTIBLE%29;%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> __sched <span style=color:#a6e22e>wait_for_completion</span>(<span style=color:#66d9ef>struct</span> completion <span style=color:#f92672>*</span>x)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>wait_for_common</span>(x, MAX_SCHEDULE_TIMEOUT, TASK_UNINTERRUPTIBLE);
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li></ul><h2 id=스케줄러-클래스-1>스케줄러 클래스</h2><ul><li>프로세스가 스케줄러 클래스르 ㄹ통해 유연하게 스케줄러를 바꾸게 지원하기 위해서</li></ul><h3 id=sched_class-구조체>sched_class 구조체</h3><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=struct%20sched_class%20%7b%0a%20%20const%20struct%20sched_class%20*next;%0a%0a%20%20void%20%28*enqueue_task%29%20%28struct%20rq%20*rq,%20struct%20task_struct%20*p,%20int%20flags%29;%0a%20%20void%20%28*dequeue_task%29%20%28struct%20rq%20*rq,%20struct%20task_struct%20*p,%20int%20flags%29;%0a%20%20void%20%28*yield_task%29%20%28struct%20rq%20*rq%29;%0a%20%20bool%20%28*yeild_to_task%29%20%28struct%20rq%20*rq,%20struct%20task_struct%20*p,%20bool%20preempt%29;%0a%0a%20%20void%20%28*check_preempt_curr%29%20%28struct%20rq%20*rq,%20struct%20task_struct%20*p,%20int%20flags%29;%0a%0a%20%20struct%20task_struct%20*%20%28*pick_next_task%29%20%28struct%20rq%20*rq,%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20struct%20task_struct%20*prev,%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20struct%20rq_flags%20*rf%29;%0a%20%20void%20%28*put_prev_task%29%20%28struct%20rq%20*rq,%20struct%20task_struct%20*p%29;%0a%20%20int%20%28*select_task_rq%29%20%28struct%20task_struct%20*p,%20int%20task_cpu,%20int%20sd_flag,%20int%20flags%29;%0a%20%20void%20%28*migrate_task_rq%29%20%28struct%20task_struct%20*p%29;%0a%20%20void%20%28*task_woken%29%20%28struct%20rq%20*this_rq,%20struct%20task_struct%20*task%29;%0a%20%20void%20%28*set_cpus_allowed%29%28struct%20task_struct%20*p,%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20struct%20cpumask%20*newmask%29;%0a%20%20/*%20skip%20*/%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> sched_class {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>struct</span> sched_class <span style=color:#f92672>*</span>next;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> (<span style=color:#f92672>*</span>enqueue_task) (<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p, <span style=color:#66d9ef>int</span> flags);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> (<span style=color:#f92672>*</span>dequeue_task) (<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p, <span style=color:#66d9ef>int</span> flags);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> (<span style=color:#f92672>*</span>yield_task) (<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>bool</span> (<span style=color:#f92672>*</span>yeild_to_task) (<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p, <span style=color:#66d9ef>bool</span> preempt);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> (<span style=color:#f92672>*</span>check_preempt_curr) (<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p, <span style=color:#66d9ef>int</span> flags);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span> (<span style=color:#f92672>*</span>pick_next_task) (<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq,
</span></span><span style=display:flex><span>                                       <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>prev,
</span></span><span style=display:flex><span>                                       <span style=color:#66d9ef>struct</span> rq_flags <span style=color:#f92672>*</span>rf);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> (<span style=color:#f92672>*</span>put_prev_task) (<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> (<span style=color:#f92672>*</span>select_task_rq) (<span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p, <span style=color:#66d9ef>int</span> task_cpu, <span style=color:#66d9ef>int</span> sd_flag, <span style=color:#66d9ef>int</span> flags);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> (<span style=color:#f92672>*</span>migrate_task_rq) (<span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> (<span style=color:#f92672>*</span>task_woken) (<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>this_rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>task);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> (<span style=color:#f92672>*</span>set_cpus_allowed)(<span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p,
</span></span><span style=display:flex><span>                       <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>struct</span> cpumask <span style=color:#f92672>*</span>newmask);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><ul><li>enqueue_task : 프로세스가 실행 가능한 상태로 진입</li><li>dequeue_task : 프로세스가 더 이상 실행 가능한 상태가 아닐 때</li><li>yeild_task : 프로세스가 스스로 yield() 시스템 콜을 실행했을 때</li><li>check_preempt_curr : 현재 실행 중인 프로세스를 선점할 수 있는지 검사</li><li>pick_next_task : 실행할 다음 프로세스를 선택</li><li>put_prev_task : 실행 중인 프로세스를 다시 내부 자료구조(런큐)에 삽입</li><li>load_balance : 코어 스케줄러가 태스크 부하를 분산하고자 할 때<ul><li><a href=http://jake.dothome.co.kr/load-balance-1/>참고-문C블로그</a></li><li>Passive Balancing : Fork Balancing, Exec Balancing, Wake Balancing, Idle Balancing</li><li>Periodic Balancing</li></ul></li><li>set_current_task : 프로세스의 스케줄러 클래스나 태스크 그룹을 바꿀 때</li><li>task_tick : 타이머 틱 함수를 호출</li></ul><h3 id=5가지-스케줄러-클래스>5가지 스케줄러 클래스</h3><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=extern%20const%20struct%20sched_class%20stop_sched_class;%0aextern%20const%20struct%20sched_class%20dl_sched_class;%0aextern%20const%20struct%20sched_class%20rt_sched_class;%0aextern%20const%20struct%20sched_class%20fair_sched_class;%0aextern%20const%20struct%20sched_class%20idle_sched_class;>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>struct</span> sched_class stop_sched_class;
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>struct</span> sched_class dl_sched_class;
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>struct</span> sched_class rt_sched_class;
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>struct</span> sched_class fair_sched_class;
</span></span><span style=display:flex><span><span style=color:#66d9ef>extern</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>struct</span> sched_class idle_sched_class;</span></span></code></pre></div></div><ul><li>리눅스 시스템에서 전체 프로세스 가운데 RT 클래스 프로세스와 CFS 클래스 프로세스의 비율 : 99% 는 CFS, 1%정도가 나머지 그마저도 대부분 RT</li></ul><h4 id=스케줄러-클래스의-우선-순위>스케줄러 클래스의 우선 순위</h4><ul><li>stop -> dl -> rt -> fair -> idle</li><li>struct 내부 변수 next를 사용해서 다음 우선 순위의 스케줄러를 가르킨다.</li></ul><h3 id=프로세스를-스케줄러에-등록>프로세스를 스케줄러에 등록</h3><ul><li><ol><li>스케줄러 클래스 설정</li></ol><ul><li>sched_fork()</li></ul><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="int%20sched_fork%28unsigned%20long%20clone_flags,%20struct%20task_struct%20*p%29%0a%7b%0a%20%20unsigned%20long%20flags;%0a%20%20/*%20skip%20*/%0a%20%20if%20%28dl_prio%28p-%3eprio%29%29%0a%20%20%20%20return%20-EAGAIN;%0a%20%20else%20if%20%28rt_prio%28p-%3eprio%29%29%0a%20%20%20%20p-%3esched_class%20=%20&amp;rt_sched_class;%0a%20%20else%0a%20%20%20%20p-%3esched_class%20=%20&amp;fair_sched_class;%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>sched_fork</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> clone_flags, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> flags;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>dl_prio</span>(p<span style=color:#f92672>-&gt;</span>prio))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span>EAGAIN;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>rt_prio</span>(p<span style=color:#f92672>-&gt;</span>prio))
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>sched_class <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>rt_sched_class;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>sched_class <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>fair_sched_class;
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li><ol start=2><li>스케줄러 클래스 변경</li></ol><ul><li>__setscheduler()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%20__setscheduler%28struct%20rq%20*rq,%20struct%20task_struct%20*p,%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20struct%20sched_attr%20*attr,%20bool%20keep_boost%29%0a%7b%0a%20%20__setscheduler_params%28p,%20attr%29;%0a%0a%20%20p-%3eprio%20=%20normal_prio%28p%29;%0a%20%20if%20%28keep_boost%29%0a%20%20%20%20p-%3eprio%20=%20rt_effective_prio%28p,%20p-%3eprio%29;%0a%0a%20%20if%20%28dl_prio%28p-%3eprio%29%29%0a%20%20%20%20p-%3esched_class%20=%20&amp;dl_sched_class;%0a%20%20else%20if%20%28rt_prio%28p-%3eprio%29%29%0a%20%20%20%20p-%3esched_class%20=%20&amp;rt_sched_class;%0a%20%20else%0a%20%20%20%20p-%3esched_class%20=%20&amp;fair_sched_class;%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>__setscheduler</span>(<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p,
</span></span><span style=display:flex><span>               <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>struct</span> sched_attr <span style=color:#f92672>*</span>attr, <span style=color:#66d9ef>bool</span> keep_boost)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>__setscheduler_params</span>(p, attr);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  p<span style=color:#f92672>-&gt;</span>prio <span style=color:#f92672>=</span> <span style=color:#a6e22e>normal_prio</span>(p);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (keep_boost)
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>prio <span style=color:#f92672>=</span> <span style=color:#a6e22e>rt_effective_prio</span>(p, p<span style=color:#f92672>-&gt;</span>prio);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>dl_prio</span>(p<span style=color:#f92672>-&gt;</span>prio))
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>sched_class <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>dl_sched_class;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>rt_prio</span>(p<span style=color:#f92672>-&gt;</span>prio))
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>sched_class <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>rt_sched_class;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>sched_class <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>fair_sched_class;
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li></ul></li></ul><h3 id=세부-함수-호출>세부 함수 호출</h3><ul><li>enqueue_task()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=static%20inline%20void%20enqueue_task%28struct%20rq%20*rq,%20struct%20task_struct%20*p,%20int%20flags%29%0a%7b%0a%20%20if%20%28!%28flags%20&%20ENQUEUE_NOCLOCK%29%29%0a%20%20%20%20update_rq_clock%28rq%29;%0a%20%20if%20%28!%28flags%20&%20ENQUEUE_RESTOR%29%29%0a%20%20%20%20sched_info_queued%28rq,%20p%29;%0a%0a%20%20p-%3esched_class-%3eenqueue_task%28rq,%20p,%20flags%29;%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>inline</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>enqueue_task</span>(<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p, <span style=color:#66d9ef>int</span> flags)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>(flags <span style=color:#f92672>&amp;</span> ENQUEUE_NOCLOCK))
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>update_rq_clock</span>(rq);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>(flags <span style=color:#f92672>&amp;</span> ENQUEUE_RESTOR))
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sched_info_queued</span>(rq, p);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  p<span style=color:#f92672>-&gt;</span>sched_class<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>enqueue_task</span>(rq, p, flags);
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li>dequeue_task()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=static%20inline%20void%20dequeue_task%28struct%20rq%20*rq,%20struct%20task_struct%20*p,%20int%20flags%29%0a%7b%0a%20%20if%20%28!flags%20&%20DEQUEUE_NOCLOCK%29%0a%20%20%20%20update_rq_clock%28rq%29;%0a%20%20if%20%28!%28flags%20&%20DEQUEUE_SAVE%29%29%0a%20%20%20%20sched_info_dequeued%28rq,%20p%29;%0a%0a%20%20p-%3eshced_class-%3edequeue_task%28rq,%20p,%20flags%29;%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>inline</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>dequeue_task</span>(<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p, <span style=color:#66d9ef>int</span> flags)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>flags <span style=color:#f92672>&amp;</span> DEQUEUE_NOCLOCK)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>update_rq_clock</span>(rq);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>(flags <span style=color:#f92672>&amp;</span> DEQUEUE_SAVE))
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sched_info_dequeued</span>(rq, p);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  p<span style=color:#f92672>-&gt;</span>shced_class<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>dequeue_task</span>(rq, p, flags);
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li></ul><h2 id=런큐-1>런큐</h2><ul><li>percpu 타입의 전역변수</li><li>RT, CFS, Deadline 서브 런큐를 관리</li><li>실행 요청을 한 프로세스가 런큐에 삽입됨</li><li>CPU를 점유하면서 실행 중인 current 프로세스를 관리</li></ul><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=struct%20rq%20%7b%0a%20%20raw_spinlock_t%20lock;%0a%0a%20%20unsigned%20int%20nr_running;%0a%20%20/*%20skip%20*/%0a%20%20struct%20load_wait%20load;%0a%20%20unsigned%20long%20nr_load_updates;%0a%20%20u64%20nr_switches;%0a%0a%20%20struct%20cfs_rq%20cfs;%0a%20%20struct%20rt_rq%20rt;%0a%20%20struct%20dl_rq%20dl;%0a%20%20/*%20skip%20*/%0a%20%20unsigned%20long%20nr_uninterruptible;%0a%0a%20%20struct%20task_struct%20*curr,%20*dle,%20*stop;%0a%20%20/*%20skip%20*/%0a%7d;>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> rq {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>raw_spinlock_t</span> lock;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> nr_running;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> load_wait load;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> nr_load_updates;
</span></span><span style=display:flex><span>  u64 nr_switches;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> cfs_rq cfs;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rt_rq rt;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> dl_rq dl;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> nr_uninterruptible;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>curr, <span style=color:#f92672>*</span>dle, <span style=color:#f92672>*</span>stop;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>};</span></span></code></pre></div></div><ul><li>lock : 런큐 자료구조를 변경할 때 경쟁 조건을 피하기 위한 락</li><li>nr_running : 런큐에 삽입된 모든 프로세스 개수</li><li>nr_switches : 컨텍스트 스위칭을 수행한 개수</li><li>cfs, rt : cfs, rt 런큐</li><li>nr_uninterruptible : 런큐에 있는 태스크 중 TASK_UNINTERRUPTIBLE 상태의 프로세스 개수</li><li>curr : 해당 런큐에서 CPU를 점유하면서 실행 중인 프로세스의 태스크 디스크립터</li><li>idle : idle 프로세스의 태스크 디스크립터</li><li>cfs_task : cfs 런큐에 삽입된 모든 일반 프로세스의 연결 리스트</li></ul><h3 id=runqueues-변수>runqueues 변수</h3><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=DECLARE_PER_CPU_SHARED_ALIGNED%28struct%20rq,%20runqueues%29;%0a#define%20cpu_rq%28cpu%29%20%28&amp;per_cpu%28runqueues,%20%28cpu%29%29%29%0a#define%20this_rq%28%29%20this_cpu_ptr%28&amp;runqueues%29>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#a6e22e>DECLARE_PER_CPU_SHARED_ALIGNED</span>(<span style=color:#66d9ef>struct</span> rq, runqueues);
</span></span><span style=display:flex><span><span style=color:#75715e>#define cpu_rq(cpu) (&amp;per_cpu(runqueues, (cpu)))
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define this_rq() this_cpu_ptr(&amp;runqueues)</span></span></span></code></pre></div></div><h2 id=cfs-스케줄러>CFS 스케줄러</h2><ul><li>CFS(Completely Fair Scheduler)</li><li>2.6.23 버전 이후로 적용된 리눅스 기본 스케줄러</li><li>특징<ul><li>타임 슬라이스 : 스케줄러가 프로세스에게 부여한 실행 시간</li><li>우선순위<ul><li>우선순위가 높은 프로세스에 대해 가장 먼저 CPU 에서 실행 시키고, 더 많은 타임 슬라이스를 할당해준다.</li></ul></li><li>가상 실행 시간(vruntime)<ul><li>프로세스가 그동안 실행 시간을 정규화한 시간 정보</li></ul></li></ul></li></ul><h3 id=cfs-스케줄러-알고리즘>CFS 스케줄러 알고리즘</h3><ul><li><p>load weight : 프로세스의 우선순위에 주는 가중치</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%20set_load_weight%28struct%20task_struct%20*p%29%0a%7b%0a%20%20int%20prio%20=%20p-%3estatic_prio%20-%20MAX_RT_PRIO;%0a%20%20struct%20load_weight%20*load%20=%20&amp;p-%3ese.load;%0a%20%20/*%20skip%20*/%0a%20%20if%20%28update_load%20&&%20p-%3esched_class%20==%20&amp;fiar_sched_class%29%20%7b%0a%20%20%20%20reweight_task%28p,%20prio%29;%0a%20%20%7d%20else%20%7b%0a%20%20%20%20load-%3eweight%20=%20scale_load%28sched_prio_to_weight[prio]%29;%0a%20%20%20%20load-%3einv_weight%20=%20sched_prio_to_wmult[prio];%0a%20%20%7d%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>set_load_weight</span>(<span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>p)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> prio <span style=color:#f92672>=</span> p<span style=color:#f92672>-&gt;</span>static_prio <span style=color:#f92672>-</span> MAX_RT_PRIO;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> load_weight <span style=color:#f92672>*</span>load <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>p<span style=color:#f92672>-&gt;</span>se.load;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (update_load <span style=color:#f92672>&amp;&amp;</span> p<span style=color:#f92672>-&gt;</span>sched_class <span style=color:#f92672>==</span> <span style=color:#f92672>&amp;</span>fiar_sched_class) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>reweight_task</span>(p, prio);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    load<span style=color:#f92672>-&gt;</span>weight <span style=color:#f92672>=</span> <span style=color:#a6e22e>scale_load</span>(sched_prio_to_weight[prio]);
</span></span><span style=display:flex><span>    load<span style=color:#f92672>-&gt;</span>inv_weight <span style=color:#f92672>=</span> sched_prio_to_wmult[prio];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li><p>타임 슬라이스</p><ul><li>$$(time slice) = \frac{(load weight of process)}{(sum of load weight in CFS runqueue)} \time (scheduling latency)$$</li></ul></li><li><p>vruntime : 프로세스가 그동안 실행한 시간을 정규화한 시간 정보</p></li><li><p>CFS 스케줄러는 런큐에 등록된 프로세스 중 vruntime이 가장 작은 프로세스를 다음에 실행할 프로세스로 선택</p></li><li><p>update_curr()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%20update_curr%28struct%20cfs_rq%20*cfs_rq%29%0a%7b%0a%20%20/*%20skip%20*/%0a%20%20u64%20delta_exec;%0a%20%20/*%20skip%20*/%0a%20%20curr-%3evruntime%20+=%20calc_delta_fair%28delta_exec,%20curr%29;%0a%20%20/*%20skip%20*/%0a%7d%0astatic%20inline%20u64%20calc_delta_fair%28u64%20delta,%20struct%20sched_entity%20*se%29%0a%7b%0a%20%20if%20%28unlikely%28se-%3eload.weight%20!=%20NICE_0_LOAD%29%29%0a%20%20%20%20delta%20=%20__cal_delta%28delta,%20NICE_0_Load,%20&amp;se-%3eload%29;%0a%20%20return%20delta;%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>update_curr</span>(<span style=color:#66d9ef>struct</span> cfs_rq <span style=color:#f92672>*</span>cfs_rq)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  u64 delta_exec;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  curr<span style=color:#f92672>-&gt;</span>vruntime <span style=color:#f92672>+=</span> <span style=color:#a6e22e>calc_delta_fair</span>(delta_exec, curr);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>inline</span> u64 <span style=color:#a6e22e>calc_delta_fair</span>(u64 delta, <span style=color:#66d9ef>struct</span> sched_entity <span style=color:#f92672>*</span>se)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>unlikely</span>(se<span style=color:#f92672>-&gt;</span>load.weight <span style=color:#f92672>!=</span> NICE_0_LOAD))
</span></span><span style=display:flex><span>    delta <span style=color:#f92672>=</span> <span style=color:#a6e22e>__cal_delta</span>(delta, NICE_0_Load, <span style=color:#f92672>&amp;</span>se<span style=color:#f92672>-&gt;</span>load);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> delta;
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><ul><li>$$vruntime += delta_exc * \frac{1024}{load weight}$$</li></ul></li><li><p>위의 공식대로라면, 휴면상태였던 프로세스 또는 새롭게 생성된 프로세스는 CPU를 더 많이 할당받게 된다. 따라서 주기적으로 vruntime의 최소값을 설정해준다.</p></li><li><p>update_min_vruntime()</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%20update_min_vruntime%28struct%20cfs_rq%20*cfs_rq%29%0a%7b%0a%20%20struct%20sched_entity%20*curr%20=%20cfs_rq-%3ecurr;%0a%20%20struct%20rb_node%20*leftmost%20=%20rb_first_cached%28&amp;cfs_rq-%3etasks_timeline%29;%0a%0a%20%20u64%20vruntime%20=%20cfs_rq-%3emin_vruntime;%0a%20%20/*%20skip%20*/%0a%20%20/*%20ensure%20we%20never%20gain%20time%20by%20being%20placed%20backwards.%20*/%0a%20%20cfs_rq-%3emin_vruntime%20=%20max_vruntime%28cfs_rq-%3emin_vruntime,%20vruntime%29;%0a%20%20/*%20skip%20*/%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>update_min_vruntime</span>(<span style=color:#66d9ef>struct</span> cfs_rq <span style=color:#f92672>*</span>cfs_rq)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> sched_entity <span style=color:#f92672>*</span>curr <span style=color:#f92672>=</span> cfs_rq<span style=color:#f92672>-&gt;</span>curr;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rb_node <span style=color:#f92672>*</span>leftmost <span style=color:#f92672>=</span> <span style=color:#a6e22e>rb_first_cached</span>(<span style=color:#f92672>&amp;</span>cfs_rq<span style=color:#f92672>-&gt;</span>tasks_timeline);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  u64 vruntime <span style=color:#f92672>=</span> cfs_rq<span style=color:#f92672>-&gt;</span>min_vruntime;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* ensure we never gain time by being placed backwards. */</span>
</span></span><span style=display:flex><span>  cfs_rq<span style=color:#f92672>-&gt;</span>min_vruntime <span style=color:#f92672>=</span> <span style=color:#a6e22e>max_vruntime</span>(cfs_rq<span style=color:#f92672>-&gt;</span>min_vruntime, vruntime);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li></ul><h3 id=cfs-관련-세부-함수>CFS 관련 세부 함수</h3><h4 id=타임-슬라이스-관리>타임 슬라이스 관리</h4><ul><li>프로세스가 타임 슬라이스를 소진했는지 점검, 프로세스의 타임 슬라이스를 업데이트, 타임 슬라이스를 모두 소진한 프로세스를 선점될 조건임을 마킹</li><li>scheduler_tick()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="void%20scheduler_tick%28void%29%0a%7b%0a%20%20int%20cpu%20=%20smp_processor_id%28%29;%0a%20%20struct%20rq%20*rq%20=%20cpu_rq%28cpu%29;%0a%20%20struct%20task_struct%20*curr%20=%20rq-%3ecurr;%0a%20%20struct%20rq_flags%20rf;%0a%0a%20%20sched_clock_tick%28%29;%0a%0a%20%20rq_lock%28rq,%20&amp;rf%29;%0a%0a%20%20update_rq_clock%28rq%29;%0a%20%20curr-%3esched_class-%3etask_tick%28rq,%20curr,%200%29;%0a%20%20/*%20skip%20*/%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>scheduler_tick</span>(<span style=color:#66d9ef>void</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> cpu <span style=color:#f92672>=</span> <span style=color:#a6e22e>smp_processor_id</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq <span style=color:#f92672>=</span> <span style=color:#a6e22e>cpu_rq</span>(cpu);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>curr <span style=color:#f92672>=</span> rq<span style=color:#f92672>-&gt;</span>curr;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rq_flags rf;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sched_clock_tick</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rq_lock</span>(rq, <span style=color:#f92672>&amp;</span>rf);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>update_rq_clock</span>(rq);
</span></span><span style=display:flex><span>  curr<span style=color:#f92672>-&gt;</span>sched_class<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>task_tick</span>(rq, curr, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li>task_tick_fair()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%20task_tick_fair%28struct%20rq%20*rq,%20struct%20task_struct%20*curr,%20int%20queued%29%0a%7b%0a%20%20struct%20cfs_rq%20*cfs_rq;%0a%20%20struct%20shced_entity%20*se%20=%20&amp;curr-%3ese;%0a%0a%20%20for_each_sched_entity%28se%29%20%7b%0a%20%20%20%20cfs_rq%20=%20cfs_rq_of%28se%29;%0a%20%20%20%20entity_tick%28cfs_rq,%20se,%20queued%29;%0a%20%20%7d%0a%20%20/*%20skip%20*/%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>task_tick_fair</span>(<span style=color:#66d9ef>struct</span> rq <span style=color:#f92672>*</span>rq, <span style=color:#66d9ef>struct</span> task_struct <span style=color:#f92672>*</span>curr, <span style=color:#66d9ef>int</span> queued)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> cfs_rq <span style=color:#f92672>*</span>cfs_rq;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> shced_entity <span style=color:#f92672>*</span>se <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>curr<span style=color:#f92672>-&gt;</span>se;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>for_each_sched_entity</span>(se) {
</span></span><span style=display:flex><span>    cfs_rq <span style=color:#f92672>=</span> <span style=color:#a6e22e>cfs_rq_of</span>(se);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>entity_tick</span>(cfs_rq, se, queued);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><ul><li>eneity_tick()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=static%20void%0aentity_tick%28struct%20cfs_rq%20*cfs_rq,%20struct%20sched_entity%20*curr,%20int%20queued%29%0a%7b%0a%20%20update_curr%28cfs_rq%29;%0a%0a%20%20update_load_avg%28curr,%20UPDATE_TG%29;%0a%20%20update_cfs_shares%28curr%29;%0a%20%20/*%20skip%20*/%0a%20%20if%20%28cfs_rq-%3enr_running%20%3e%201%29%0a%20%20%20%20check_preempt_tick%28cfs_rq,%20curr%29;%0a%7d>
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>entity_tick</span>(<span style=color:#66d9ef>struct</span> cfs_rq <span style=color:#f92672>*</span>cfs_rq, <span style=color:#66d9ef>struct</span> sched_entity <span style=color:#f92672>*</span>curr, <span style=color:#66d9ef>int</span> queued)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>update_curr</span>(cfs_rq);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>update_load_avg</span>(curr, UPDATE_TG);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>update_cfs_shares</span>(curr);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (cfs_rq<span style=color:#f92672>-&gt;</span>nr_running <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>check_preempt_tick</span>(cfs_rq, curr);
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li></ul></li><li>check_preempt_tick()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%0acheck_preempt_tick%28struct%20cfs_rq%20*cfs_rq,%20struct%20sched_entity%20*curr%29%0a%7b%0a%20%20unsigned%20long%20ideal_runtime,%20delta_exec;%0a%20%20struct%20sched_entity%20*se;%0a%20%20s64%20delta;%0a%0a%20%20ideal_runtime%20=%20sched_slice%28cfs_rq,%20curr%29;%0a%20%20delta_exec%20=%20curr-%3esum_exec_runtime%20-%20curr-%3eprev_sum_exec_runtime;%0a%20%20if%20%28delta_exec%20%3e%20ideal_runtime%29%20%7b%0a%20%20%20%20resched_curr%28rq_of%28cfs_rq%29%29;%0a%20%20%20%20/*%20skip%20*/%0a%20%20%7d%0a%0a%20%20if%20%28delta_exec%20%3c%20sysctl_sched_min_granularity%29%0a%20%20%20%20return;%0a%0a%20%20se%20=%20__pick_first_entity%28cfs_rq%29;%0a%20%20delta%20=%20curr-%3evruntime%20-%20se-%3evruntime;%0a%0a%20%20if%20%28delta%20%3c%20e%29%0a%20%20%20%20return;%0a%0a%20%20if%20%28delta%20%3e%20ideal_runtime%29%0a%20%20%20%20resched_curr%28rq_off%28cfs_rq%29%29;%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>check_preempt_tick</span>(<span style=color:#66d9ef>struct</span> cfs_rq <span style=color:#f92672>*</span>cfs_rq, <span style=color:#66d9ef>struct</span> sched_entity <span style=color:#f92672>*</span>curr)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> ideal_runtime, delta_exec;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> sched_entity <span style=color:#f92672>*</span>se;
</span></span><span style=display:flex><span>  s64 delta;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ideal_runtime <span style=color:#f92672>=</span> <span style=color:#a6e22e>sched_slice</span>(cfs_rq, curr);
</span></span><span style=display:flex><span>  delta_exec <span style=color:#f92672>=</span> curr<span style=color:#f92672>-&gt;</span>sum_exec_runtime <span style=color:#f92672>-</span> curr<span style=color:#f92672>-&gt;</span>prev_sum_exec_runtime;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (delta_exec <span style=color:#f92672>&gt;</span> ideal_runtime) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>resched_curr</span>(<span style=color:#a6e22e>rq_of</span>(cfs_rq));
</span></span><span style=display:flex><span>    <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (delta_exec <span style=color:#f92672>&lt;</span> sysctl_sched_min_granularity)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  se <span style=color:#f92672>=</span> <span style=color:#a6e22e>__pick_first_entity</span>(cfs_rq);
</span></span><span style=display:flex><span>  delta <span style=color:#f92672>=</span> curr<span style=color:#f92672>-&gt;</span>vruntime <span style=color:#f92672>-</span> se<span style=color:#f92672>-&gt;</span>vruntime;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (delta <span style=color:#f92672>&lt;</span> e)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (delta <span style=color:#f92672>&gt;</span> ideal_runtime)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>resched_curr</span>(<span style=color:#a6e22e>rq_off</span>(cfs_rq));
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div><ul><li><ol><li>프로세스가 소진한 타임 슬라이스 읽기</li></ol></li><li><ol start=2><li>프로세스 선점 요청 : 프로세스가 타임 슬라이스를 모두 소진했으면 선점 요청을 한다.</li></ol></li><li>프로세스가 선점 요청을 하면, 인터럽트를 핸들링한 후 또는 시스템 콜을 핸들링한 후 유저 공간으로 복귀하기 전에 프로세스가 선점된다.</li></ul></li></ul><h4 id=vruntime-관리와-관련된-세부-함수>vruntime 관리와 관련된 세부 함수</h4><ul><li>프로세스를 vruntime 기준으로 CFS 런큐의 레드 블랙 트리에 등록</li><li>CFS가 다음 프로세스를 레드 블랙 트리에서 선택(pick)하는 과정</li><li>enqueue_entity()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%0aenqueue_entity%28struct%20cfs_rq%20*cfs_rq,%20struct%20sched_entity%20*se,%20int%20flags%29%0a%7b%0a%20%20bool%20renorm%20=%20!%28flags%20&%20ENQUEUE_WAKEUP%29%20%7c%7c%20%28flags%20&%20ENQUEUE_MIGRATED%29;%0a%20%20bool%20curr%20=%20cfs_rq-%3ecurr%20==%20se;%0a%20%20/*%20skip%20*/%0a%20%20update_curr%28cfs_rq%29;%0a%20%20/*%20skip%20*/%0a%20%20account_tntity_enqueue%28cfs_rq,%20se%29;%0a%20%20/*%20skip%20*/%0a%20%20if%20%28!curr%29%0a%20%20%20%20__enqueue_entity%28cfs_rq,%20se%29;%0a%20%20se-%3eon_rq%20=%201;%0a%20%20/*%20skip%20*/%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>enqueue_entity</span>(<span style=color:#66d9ef>struct</span> cfs_rq <span style=color:#f92672>*</span>cfs_rq, <span style=color:#66d9ef>struct</span> sched_entity <span style=color:#f92672>*</span>se, <span style=color:#66d9ef>int</span> flags)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>bool</span> renorm <span style=color:#f92672>=</span> <span style=color:#f92672>!</span>(flags <span style=color:#f92672>&amp;</span> ENQUEUE_WAKEUP) <span style=color:#f92672>||</span> (flags <span style=color:#f92672>&amp;</span> ENQUEUE_MIGRATED);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>bool</span> curr <span style=color:#f92672>=</span> cfs_rq<span style=color:#f92672>-&gt;</span>curr <span style=color:#f92672>==</span> se;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>update_curr</span>(cfs_rq);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>account_tntity_enqueue</span>(cfs_rq, se);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>curr)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>__enqueue_entity</span>(cfs_rq, se);
</span></span><span style=display:flex><span>  se<span style=color:#f92672>-&gt;</span>on_rq <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>/* skip */</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li><li>__enqueue_entity()<div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data="static%20void%20__enqueue_entity%28struct%20cfs_rq%20*cfs_rq,%20struct%20sched_entity%20*se%29%0a%7b%0a%20%20struct%20rb_node%20**link%20=%20&amp;cfs_rq-%3etasks_timeline.rb_root.rb_node;%0a%20%20struct%20rb_node%20*parent%20=%20NULL;%0a%20%20struct%20shced_entity%20*entry;%0a%20%20bool%20leftmost%20=%20true;%0a%0a%20%20while%20%28*link%29%20%7b%0a%20%20%20%20parent%20=%20*link;%0a%20%20%20%20entry%20=%20rb_entry%28parent,%20struct%20sched_entity,%20run_node%29;%0a%0a%20%20%20%20if%20%28entity_before%28se,%20entry%29%29%20%7b%0a%20%20%20%20%20%20link%20=%20&amp;parent-%3erb_left;%0a%20%20%20%20%7d%20else%20%7b%0a%20%20%20%20%20%20link%20=%20&amp;parent-%3erb_right;%0a%20%20%20%20%20%20leftmost%20=%20false;%0a%20%20%20%20%7d%0a%20%20%7d%0a%0a%20%20rb_link_node%28&amp;se-%3erun_node,%20parent,%20link%29;%0a%20%20rb_insert_color_cached%28&amp;se-%3erun_node,%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;cfs_rq-%3etasks_timeline,%20leftmost%29;%0a%7d">
<i class="bi bi-copy"></i></button></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>__enqueue_entity</span>(<span style=color:#66d9ef>struct</span> cfs_rq <span style=color:#f92672>*</span>cfs_rq, <span style=color:#66d9ef>struct</span> sched_entity <span style=color:#f92672>*</span>se)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rb_node <span style=color:#f92672>**</span>link <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>cfs_rq<span style=color:#f92672>-&gt;</span>tasks_timeline.rb_root.rb_node;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> rb_node <span style=color:#f92672>*</span>parent <span style=color:#f92672>=</span> NULL;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>struct</span> shced_entity <span style=color:#f92672>*</span>entry;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>bool</span> leftmost <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> (<span style=color:#f92672>*</span>link) {
</span></span><span style=display:flex><span>    parent <span style=color:#f92672>=</span> <span style=color:#f92672>*</span>link;
</span></span><span style=display:flex><span>    entry <span style=color:#f92672>=</span> <span style=color:#a6e22e>rb_entry</span>(parent, <span style=color:#66d9ef>struct</span> sched_entity, run_node);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>entity_before</span>(se, entry)) {
</span></span><span style=display:flex><span>      link <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>parent<span style=color:#f92672>-&gt;</span>rb_left;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      link <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>parent<span style=color:#f92672>-&gt;</span>rb_right;
</span></span><span style=display:flex><span>      leftmost <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rb_link_node</span>(<span style=color:#f92672>&amp;</span>se<span style=color:#f92672>-&gt;</span>run_node, parent, link);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rb_insert_color_cached</span>(<span style=color:#f92672>&amp;</span>se<span style=color:#f92672>-&gt;</span>run_node,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&amp;</span>cfs_rq<span style=color:#f92672>-&gt;</span>tasks_timeline, leftmost);
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></li></ul><h2 id=선점-스케줄링>선점 스케줄링</h2><ul><li>선점 스케줄링 : CPU에서 실행 중인 프로세스를 비우고 새로운 프로세스를 CPU에서 실행시킴</li></ul><h3 id=선점-스케줄링-진입점>선점 스케줄링 진입점</h3><ul><li>인터럽트 핸들링 후 : 인터럽트 핸들러를 실행한 후 실행을 멈춘 프로세스로 복귀하기 전</li><li>시스템 콜 핸들링 후 : 시스템 콜 함수를 처리한 후 유저 공간으로 복귀하기 직전</li></ul><h4 id=선점-스케줄링의-진입점커널-모드-중-인터럽트-발생>선점 스케줄링의 진입점:커널 모드 중 인터럽트 발생</h4><ul><li>arm 기준<ul><li><p>인터럽트가 발생하면 실행되는 __irq_svc 레이블에서 선점 스케줄링을 시작한다.:</p><ol><li>인터럽트 발생 후 인터럽트 핸들러 처리</li><li>프로세스 선점 스케줄링 조건 점검</li><li>프로세스 선점 스케줄링 실행</li></ol></li><li><p><code>__irq_svc</code>:</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=#ZgotmplZ>
<i class="bi bi-copy"></i></button></div><pre><code>__irq_svc:
  svc_entry
  irq_handler

#ifdef CONFIG_PREEMPTION
  ldr	r8, [tsk, #TI_PREEMPT]		@ get preempt count
  ldr	r0, [tsk, #TI_FLAGS]		@ get flags
  teq	r8, #0				@ if preempt count != 0
  movne	r0, #0				@ force flags to 0
  tst	r0, #_TIF_NEED_RESCHED
  blne	svc_preempt
#endif

svc_exit r5, irq = 1			@ return from exception
UNWIND(.fnend		)
ENDPROC(__irq_svc)</code></pre></div></li><li><p>책은 라즈베리 파이를 기준으로 하는데, 책에서는 CONFIG_PREEMPT가 비활서오하 되어 있어서, 커널 코드가 실행되는 도중 인터럽트가 발생했을 때 선점 스케줄링을 시도하지 않는다.</p></li><li><p>하지만 대부분의 상용 리눅스 시스템에서는 CONFIG_PREEMPT가 활성화 되어 있다고 한다.</p></li><li><p>어셈블리를 해석해보면 r8 이 0이고 r0 & TIF_NEED_RESCHED 이 0이 아니라면 <code>svc_preempt()</code>를 호출하는 구조이다.</p></li><li><p><code>svc_preempt</code>:</p><div class=codeblock><div class=copy-button-box><button class=copy-button state=copy data=#ZgotmplZ>
<i class="bi bi-copy"></i></button></div><pre><code>#ifdef CONFIG_PREEMPTION
svc_preempt:
  mov	r8, lr
1:	bl	preempt_schedule_irq		@ irq en/disable is done inside
  ldr	r0, [tsk, #TI_FLAGS]		@ get new tasks TI_FLAGS
  tst	r0, #_TIF_NEED_RESCHED
  reteq	r8				@ go again
  b	1b
#endif</code></pre></div></li><li><p>그냥 preempt_schedule_irq 호출 하고 return하는 코드들이다.</p></li><li><p>여기까지가 architecture별로 다른 부분이고 preempt_schedule_irq() 부터는 다시 공통 c 코드로 돌아간다.</p></li></ul></li><li>x86 기준:<ul><li>잡담 : 문서를 읽기 싫어서 사고 과정이 다음과 같았습니다. preempt_schedule_irq()는 공통 코드니까 이걸 호출하는 부분을 x86에서 찾으면 되겠다.</li><li>근데 common 을 사용하는 거 같기는 한데 정확히는 못찾았다. ㅠㅠ 일단 한시간 동안 이걸 찾는데 실패했으니 오늘은 여기까지</li></ul></li></ul></div><hr><div class=list-files><ul class=section-tree></ul></div></article><script src=/js/wikilink.js></script><div><script src=https://utteranc.es/client.js repo=minuk-dev/minuk-dev.github.io issue-term=pathname theme=github-dark crossorigin=anonymous async></script></div></main><footer class=footer><div class=footer-left></div><div class=footer-right><ul class=social><li><a href=/about>About</a></li><li><a href=https://github.com/minuk-dev>Github</a></li></ul></div></footer></body><script src=/js/sidebar.js></script><script src=/js/dir_toggle.js></script><script src=/js/codeblock_copy.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css><script type=module>
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs";
mermaid.initialize({
  startOnLoad: true,
  theme: "dark",
});
</script></html>
<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>learning-coredns</title><style>html body{font-family:raleway,sans-serif;background-color:#fff}:root{--accent:#00a3d2;--border-width:5px}</style><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/copy-btn.css><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script src=/js/copy-btn.js></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script>$(document).on("click",function(){$(".collapse").collapse("hide")})</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-98056974-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-98056974-1")</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><meta name=google-site-verification content="g_3tJyj-KkW-_wKx7Ij5GimHV1nKPZXetCz8ydbBAfA"></head><body><nav class="navbar navbar-default navbar-fixed-top"><div class=container><div class=navbar-header><a class="navbar-brand visible-xs" href=#>learning-coredns
</a><button class=navbar-toggle data-target=.navbar-collapse data-toggle=collapse>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/wiki/>Wiki</a></li><li><a href=/posts/>Posts</a></li><li><a href=/about/>About</a></li></ul></div></div></nav><main><div class=navigator style=display:flex><div style=display:flex><div class=parent-doc style=flex:none><button class="btn btn-link" onclick='(function(e){e.querySelector("a").click()})(this)'>
<i class="fa fa-arrow-left"></i>
[[Book reviews]]</button></div></div></div><div><h2>learning-coredns</h2><a href=https://github.com/minuk-dev/minuk-dev.github.io/blame/master/content/wiki/coredns.md><h5>created : Wed, 28 Sep 2022 11:30:48 +0900</h5><h5>modified : Wed, 02 Nov 2022 00:19:28 +0900</h5></a><a href=https://minuk.dev/tags/coredns><kbd class=item-tag>coredns</kbd></a></div><aside class=navbar id=nav-toc style=text-align:left><nav id=TableOfContents><ul><li><a href=#공부-이유>공부 이유</a></li><li><a href=#공부-방법>공부 방법</a></li><li><a href=#1장-소개>1장 소개</a></li><li><a href=#2장-dns-소개>2장 DNS 소개</a></li><li><a href=#3장-coredns-구성>3장 CoreDNS 구성</a><ul><li><a href=#coredns-커맨드라인-옵션>CoreDNS 커맨드라인 옵션</a></li><li><a href=#corefile-구문>Corefile 구문</a></li><li><a href=#플러그인>플러그인</a></li><li><a href=#dns-서버-구성-예시>DNS 서버 구성 예시</a></li></ul></li><li><a href=#4장-영역-데이터-관리>4장 영역 데이터 관리</a><ul><li><a href=#file-플러그인>file 플러그인</a></li><li><a href=#auto-플러그인>auto 플러그인</a></li><li><a href=#git-과-auto-플러그인-사용>Git 과 auto 플러그인 사용</a></li><li><a href=#hosts-플러그인>hosts 플러그인</a></li><li><a href=#aws-route53-플러그인>AWS Route53 플러그인</a></li></ul></li><li><a href=#5장-서비스-검색>5장 서비스 검색</a><ul><li><a href=#서비스-검색-문제-해결>서비스 검색 문제 해결</a></li><li><a href=#coredns-및-etcd로-서비스-검색>CoreDNS 및 etcd로 서비스 검색</a></li></ul></li><li><a href=#6장-쿠버네티스>6장 쿠버네티스</a><ul><li><a href=#plugin-구조-분석>Plugin 구조 분석</a></li></ul></li><li><a href=#개인-생각>개인 생각</a></li></ul></nav></aside><div align=start class=content data-spy=scroll data-offset=20 data-target=#nav-toc style=position:relative><h2 id=공부-이유>공부 이유</h2><ul><li>네트워크 부분에서 모호하게 된 영역이여서</li><li><a href=https://summerofcode.withgoogle.com/programs/2022/projects/R8SxC38F>google summer code 에 작년 관련 프로젝트가</a>에 있어서 관심이 가서</li><li>어짜피 공부해야할 내용인데 책으로 있으면 안할 이유가 없어서</li><li>kubecon 에서 간략하게 소개해줬는데 흥미가 가서, [[coredns-into-and-deep-dive]]</li></ul><h2 id=공부-방법>공부 방법</h2><ul><li>일단 기본적으로는 책에 있는 내용을 정리하면서 읽기</li><li>추가적으로 궁금한거 (구현부, 기여할만한지) 등도 추가로 정리하면서 읽기</li></ul><h2 id=1장-소개>1장 소개</h2><ul><li>제약사항:<ul><li>완전 재귀를 지원하지 않는다.</li><li>동적 업데이트를 지원하지 않는다.</li><li>DNSSEC (Domain Name SYstem Security 확장)을 제한적으로 지원한다.</li></ul></li></ul><h2 id=2장-dns-소개>2장 DNS 소개</h2><ul><li><p>DNS 란?:</p><ul><li>Resolver : DNS Client</li><li>Name server : DNS server</li></ul></li><li><p>도메인명과 네임스페이스:</p><ul><li>루트 노드는 길이가 0의 null 라벨이라는 특별한 라벨이 존재</li></ul></li><li><p>도메인, 위임, 영역:</p><ul><li>위임 : 서브도메인을 만들어 관리를 넘기는 것</li></ul></li><li><p>리소스 레코드:</p><ul><li>레코드 타입:<ul><li>A : IPv4 주소</li><li>AAAA : IPv6 주소</li><li>CNAME : 도메인명을 다른 도메인명 (Canonical name)으로 매핑</li><li>MX : Mail Exchange</li><li>NS : 네임서버</li><li>PTR : IP 주소를 도메인명에 다시 매핑 (포인터)</li><li>SOA : Start Of Authority : 영역에 대한 매개 변수 제공</li></ul></li><li>RDATA : 레코드별 데이터</li></ul></li><li><p>DNS 서버 및 권한:</p><ul><li>영역 전송 : 다른 DNS 서버의 영역 정보를 로드하는 것, 이때 영역 전송을 하는 것을 주 DNS 서버, 영역 전송을 받은 것을 보조 DNS 서버라고 부른다.</li></ul></li><li><p>해석기:</p><ul><li>도메인명에 대한 정보를 요청하고 DNS 질의로 변환하고 DNS 서버로 전송한다.</li><li><code>getaddrinfo()</code>, <code>gethostbyname()</code> 과 같은 함수를 통해서 사용된다.</li></ul></li><li><p>해석과 재귀</p></li><li><p>캐시:</p><ul><li>루트 DNS 서버는 13개 뿐이다.:<ul><li>UDP 패킷의 실질적인 크기 제한으로 인해 13개로 제한하도록 결정되었다.</li></ul></li></ul></li></ul><h2 id=3장-coredns-구성>3장 CoreDNS 구성</h2><h3 id=coredns-커맨드라인-옵션>CoreDNS 커맨드라인 옵션</h3><ul><li><code>-conf</code> : CoreDNS의 설정 파일의 경로를 지정한다. 기본값은 CoreDNS의 작업 디렉터리에 있는 Corefile이다.</li><li><code>-cpu</code> : CoreDNS가 사용할 수 있는 최대 CPU 백분율을 지정한다. 기본값은 100%이다.</li><li><code>-dns.port</code> : CoreDNS가 Listen 하는 포트를 지정한다. 기본값 : 53</li><li><code>-help</code></li><li><code>-pidfile</code> : pid를 저장할 파일 경로 지정</li><li><code>-plugins</code></li><li><code>-quiet</code></li><li><code>-version</code></li></ul><h3 id=corefile-구문>Corefile 구문</h3><pre tabindex=0><code># comment
&lt;label&gt;, &lt;label2&gt; {
  &lt;statement...&gt;
  {$env_var}
}

&lt;snippet_name&gt; {
  &lt;label_name&gt; {
    ...
  }
}

import &lt;snippet_name&gt;
import &lt;config_filename&gt;

# Server Block
foo.example {
}

# Root Server Block
. {
}

# Specific Port
foo.example:1053 {
}

# Protocol prefix
tsl://foo.example {
}

grpc://bar.example {
}
</code></pre><h3 id=플러그인>플러그인</h3><ul><li><p>root : CoreDNS에 대한 작업 디렉터리를 설정한다.</p><pre tabindex=0><code>. {
  root /etc/coredns/zones
}
</code></pre></li><li><p>file : DNS를 영역의 주 DNS 서버로 설정하고 파일에서 영역 데이터를 로드한다.</p><pre tabindex=0><code>file DBFILE [ZONES...] {
  transfer to ADDRESS...
  reload DURATION
}
</code></pre><pre tabindex=0><code>foo.example {
  file db.foo.example {
    transfer to 10.0.0.1
  }
}
</code></pre></li><li><p>secondary : CoreDNS를 영역의 보조 DNS 서버로 구성하고 마스터 DNS 서버에서 영역 데이터를 로드한다.</p><pre tabindex=0><code>secondary [ZONES...] {
  transfer from ADDRESS
  transfer to ADDRESS
}
</code></pre></li><li><p>forward : 하나 이상의 전달기에게 질의를 전달한 CoreDNS를 구성한다.</p><pre tabindex=0><code>forward FROM TO...
</code></pre><pre tabindex=0><code>foo.example {
  forward foo.example 10.0.0.1
}
</code></pre><pre tabindex=0><code>forward FROM TO... {
  except IGNORED_NAMES...
  force_tcp
  prefer_udp
  expire DURATION
  max_fails INTEGER
  health_check DURATION
  policy random|round_robin|sequential
  tls CERT KEY CA
  tls_servername NAME
}
</code></pre></li><li><p>cache : 질의에 대한 응답을 캐시하도록 구성한다.</p><pre tabindex=0><code>cache [TTL] [ZONES...] {
  success CAPACITY [TTL] [MINTTL]
  denial CAPACITY [TTL] [MINTTL]
  prefetch AMOUNT [DURATION] [PERCENTAGE%]
}
</code></pre><pre tabindex=0><code>foo.example {
  forward . 10.0.0.1
  cache 600
}
</code></pre></li><li><p>errors : 에러를 기록하도록 구성한다.</p><pre tabindex=0><code>errors {
  consolidate DURATION REGEXP
}
</code></pre><pre tabindex=0><code>foo.example {
  file db.foo.example
  errors
}
</code></pre></li><li><p>log : 받은 각 질의를 로깅하도록 한다. BIND와 유사한 방식</p><pre tabindex=0><code>log [NAMES...] [FORMAT]
</code></pre><ul><li><a href=https://coredns.io/plugins/log/>format list</a></li></ul></li></ul><h3 id=dns-서버-구성-예시>DNS 서버 구성 예시</h3><h4 id=캐싱-전용-dns-서버>캐싱 전용 DNS 서버</h4><pre tabindex=0><code>. {
  forward . 8.8.8.8 8.8.4.4
  cache
  errors
  log
}
</code></pre><h4 id=주-dns-서버>주 DNS 서버</h4><pre tabindex=0><code>foo.example {
  root /etc/coredns/zones
  file db.foo.example
  errors
  log
}

. {
  forward 8.8.8.8 8.8.4.4
  cache
  errors
  log
}
</code></pre><h4 id=보조-dns-서버>보조 DNS 서버</h4><pre tabindex=0><code>(logerrors) {
  errors
  log
}

bar.exmple {
  transfer from 10.0.0.1
  import logerrors
}

foo.example {
  file db.foo.example
  root /etc/coredns/zones
  import logerrors
}

. {
  forward 8.8.8.8 8.8.4.4
  cache
  impor logerrors
}
</code></pre><h2 id=4장-영역-데이터-관리>4장 영역 데이터 관리</h2><ul><li>여기서부터는 책만 보기에는 뭔가 기억에 안남을거 같아서, 실습으로 한다.</li><li>사용하는 명령어는 coredns, dig, host, nslookup 을 사용해서 하고 있다.</li><li>추가로, kubernetes 에서는 coredns 를 어떻게 설정하고 있나 궁금해서 찾아봤다:<ul><li><a href=https://github.com/kubernetes/kubernetes/blob/50097acf156f8942d01301619603c61765dbf646/cmd/kubeadm/app/phases/addons/dns/manifests.go>kubeadm에서 addon 으로 붙어있는 coredns manifest</a></li></ul></li></ul><h3 id=file-플러그인>file 플러그인</h3><ul><li>reload 는 기본으로 1분이며 0이면 비활성화, 30s 와 같은 형태로 쓸수 있다.</li></ul><h4 id=실습>실습</h4><pre tabindex=0><code># Corefile
foo.example {
  file db.foo.example
}
</code></pre><pre tabindex=0><code># db.foo.example
@ 3600 IN SOA ns1.foo.example. root.foo.example. (
  2019041900
  3600
  600
  604800
  600 )
  3600 IN NS ns1.foo.example.
  3600 IN NS ns2.foo.example.

ns1 IN A 10.0.0.53
    IN AAAA 2001:db8:42:1::53
ns2 IN A 10.0.1.53
    IN AAAA 2001:db8:42:2::53
www IN A 10.0.0.1
    IN AAAA 2001:db8:42:1:1
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>coredns <span style=color:#75715e># 위 파일들이 있는 디렉토리에서</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dig @localhost ns1.foo.example
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 출력</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; @localhost ns1.foo.example</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ; (2 servers found)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; global options: +cmd</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; Got answer:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 36641</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 2, ADDITIONAL: 1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; WARNING: recursion requested but not available</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; OPT PSEUDOSECTION:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ; EDNS: version: 0, flags:; udp: 4096</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; QUESTION SECTION:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;ns1.foo.example.               IN      A</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; ANSWER SECTION:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ns1.foo.example.        3600    IN      A       10.0.0.53</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; AUTHORITY SECTION:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># foo.example.            3600    IN      NS      ns1.foo.example.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># foo.example.            3600    IN      NS      ns2.foo.example.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; Query time: 0 msec</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; SERVER: ::1#53(::1)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; WHEN: Thu Sep 29 18:21:14 KST 2022</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ;; MSG SIZE  rcvd: 155</span>
</span></span></code></pre></div><h3 id=auto-플러그인>auto 플러그인</h3><pre tabindex=0><code>auto [ZONES...] {
  directory DIR [REGEX ORIGIN_TEMPLATE]
  transfer to ADDRESS...
  reload DURATION
}
</code></pre><h3 id=git-과-auto-플러그인-사용>Git 과 auto 플러그인 사용</h3><ul><li>git-sync 와 auto 플러그인을 결합해서 git repo 에 있는 dns 내용을 끌어다가 동기화 시킬수 있다.</li></ul><h3 id=hosts-플러그인>hosts 플러그인</h3><ul><li><p>host 문법</p><pre tabindex=0><code>&lt;IP address&gt; &lt;canonical name&gt; [aliases...]
</code></pre></li></ul><pre tabindex=0><code>hosts [FILE [ZONES...]] {
  [INLINE]
  ttl SECONDS
  no_reverse
  reload DURATIOn
  fallthrough [ZONES...]
}
</code></pre><ul><li>hosts 플러그인은 A, AAAA, A PTR 레코드를 만든다.</li></ul><h3 id=aws-route53-플러그인>AWS Route53 플러그인</h3><pre tabindex=0><code>route53 [ZONE:HOSTED_ZONE_ID...] {
  [aws_access_key AWS_ACCESS_KEY_ID AWS_SECRET_ACCESS_KEY]
  upstream
  credentials PROFILE [FILENAME]
  fallthrough [ZONES...]
}
</code></pre><h2 id=5장-서비스-검색>5장 서비스 검색</h2><ul><li><a href=https://www.rfc-editor.org/rfc/rfc6763.html>RFC 6763</a> : DNS-Based Service Discovery 에 관한 RFC 문서:<ul><li>CoreDNS 는 DNS-SD 에 대한 전문적인 지원은 제공하지 않는다.</li></ul></li></ul><h3 id=서비스-검색-문제-해결>서비스 검색 문제 해결</h3><ul><li>초기에는 hosts 파일을 수정하였으나, 최근에는 DNS 서버를 제공하고 resolver 를 통해서 해결한다.:<ul><li>장점 : SRV 레코드를 통해서 같은 ip 주소에 여러 서비스를 호스팅할 수 있어진다.</li></ul></li></ul><h3 id=coredns-및-etcd로-서비스-검색>CoreDNS 및 etcd로 서비스 검색</h3><h4 id=etcd-플러그인>etcd 플러그인</h4><ul><li>SkyDNS 메시지 형식</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;host&#34;</span>: <span style=color:#e6db74>&#34;192.0.2.10&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;port&#34;</span>: <span style=color:#ae81ff>20020</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;priority&#34;</span>: <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;weight&#34;</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><p>책에서는 이렇게 나와있는데 솔직히 잘 이해가 안된다. 왜 port 가 있지?</p><ul><li><a href=https://github.com/coredns/coredns/tree/master/plugin/etcd>github etcd plugin source</a></li><li><a href=https://www.joinc.co.kr/w/man/12/srv>SRV record 설명</a> 을 읽어보니까 좀 이해가 된다. srv record 로 질의를 하면 port를 알 수 있다는걸 알게 되었다.</li></ul></li><li><p>실습은 적당히 따라해보긴 했는데, 나중에 서비스 만들때 찾아보면 되는 정도인듯 하다. 외우기에는 너무 많고 한번 해본다고 경험치가 확 올라가진 않는 느낌</p></li></ul><h2 id=6장-쿠버네티스>6장 쿠버네티스</h2><ul><li>책 내용을 좀 읽어봤는데 이건 그냥 coredns 의 kubernetes plugin 을 별도로 읽고 공부해야지 좀 이해할것 같다.</li></ul><h3 id=plugin-구조-분석>Plugin 구조 분석</h3><ul><li><p>caddy 를 coredns 를 실행시켜주고 plugin 으로 setup 에서 <code>plugin.Register(pluginName, setup)</code> 을 실행시켜서 등록한다. <a href=https://github.com/coredns/coredns/blob/0a8ef296ab7b0d6be9bf3deaa8bf4be69e40c300/plugin/kubernetes/setup.go#L33>관련코드</a></p></li><li><p>기본적으로 parsing 작업해주고, <code>k.InitKubeCache()</code> 를 호출하면서 <code>newdnsController()</code> 를 실행시켜주면서 kubernetes 내부 자원들을 확인하면서 동작한다. <a href=https://github.com/coredns/coredns/blob/0a8ef296ab7b0d6be9bf3deaa8bf4be69e40c300/plugin/kubernetes/kubernetes.go#L255>관련코드</a></p></li><li><p>newdnsController 는 pod, endpoint, svc, ns 를 기본적으로 확인한다. <a href=https://github.com/coredns/coredns/blob/0a8ef296ab7b0d6be9bf3deaa8bf4be69e40c300/plugin/kubernetes/controller.go#L110>관련코드</a></p></li><li><p>궁금증이 많이 해결되는 코드 분석이였는데, 기존에 가지고 있던 궁금증은:</p><ul><li>kubernetes 의 자원이 변경되는 것을 어떻게 coredns 는 관측하는가</li><li>어떤 기준으로 자원들이 관측되는가, crd 도 관측시킬수 있는가</li><li>plugin 은 어떻게 동작하는가</li></ul></li><li><p>이에 대한 답은:</p><ul><li>controller 를 붙여서 informer 로부터 정보를 받는다.</li><li>coredns 에 코드적으로 들어가 있기 때문에, 만약 crd로 연결하고 싶으면 svc 로 하던가, coredns 를 커스텀 해야한다.</li><li>기본적으로 coredns 는 caddy 를 사용하고, setup 함수를 인자로 넘기면서 실행을 위임한다.</li></ul></li></ul><h4 id=클러스터-dns-디플로이먼트-리소스>클러스터 DNS 디플로이먼트 리소스</h4><ul><li>역할 기반 액세스 제어:<ul><li>CoreDNS 는 클러스터 전체의 모든 서비스를 API 에서 데이터를 읽을수 있도록 하기 위해 더 많은 접근 권한의 서비스 어카운트가 필요하다.</li></ul></li><li>기본적으로 coredns 는 2개의 replica 가 뜨게 된다.:<ul><li>이를 극복하기 위해서 dns-autoscaler 를 배포한다.</li><li><a href=https://kubernetes.io/docs/tasks/administer-cluster/dns-horizontal-autoscaling/>관련 k8s 문서</a></li></ul></li></ul><h4 id=coredns-확장>CoreDNS 확장</h4><ul><li>pods disabled, pods insecure, pods verified</li><li>와일드카드 질의</li></ul><h2 id=개인-생각>개인 생각</h2><ul><li>더 정리하는게 의미가 있나 싶어서 여기까지만 정리한다. 실제로 세팅할때 책을 참고하면 될거 같다.</li></ul></div><script src=/js/wikilink.js></script><div><script src=https://utteranc.es/client.js repo=minuk-dev/minuk-dev.github.io issue-term=pathname theme=github-dark crossorigin=anonymous async></script></div></main><footer class=footer><div class=footer-left></div><div class=footer-right><ul class=social><li><a href=/about>About</a></li><li><a href=https://github.com/minuk-dev>Github</a></li></ul></div></footer>
<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://unpkg.com/simpledotcss/simple.css><link rel=stylesheet href=/css/main.css><meta name=generator content="Hugo 0.140.0"><meta name=description content="minuk.dev wiki"><meta name=keywords content="hugo,site,new"><meta name=author content="Min-Uk.Lee"><title>LXC |
minuk dev wiki
</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script></head><body><header class=header><div class=header_left><a href=/><img class=logo src=/images/Rb.png alt=logo>
MinUk.Dev</a></div><div class=header_middle>LXC</div></header><main><article class=main><div class=title><h1 class=title-header>LXC</h1></div><a href=https://github.com/minuk-dev/minuk-dev.github.io/blame/master/content/wiki/LXC.md><h5>created : Sat, 02 Jul 2022 03:27:34 +0900</h5><h5>modified : Sat, 02 Jul 2022 04:49:19 +0900</h5></a><div class=article-meta><div class="breadcumb content"><i class="bi bi-folder"></i>
[[devops]]</div></div><div class=list-terms><ul><i class="bi bi-tags" title=Tags></i>
<a href=/tags/devops class=tag-btn>devops</a></ul></div><aside class=navbar id=nav-toc style=text-align:left><nav id=TableOfContents><ul><li><ul><li><a href=#lxc-란>LXC 란</a></li><li><a href=#lxc가-namespace와-cgroup-을-어떻게-사용하는가>lxc가 namespace와 cgroup 을 어떻게 사용하는가:</a></li><li><a href=#docker는-lxc를-사용하는가>Docker는 LXC를 사용하는가?</a></li></ul></li></ul></nav></aside><div class=content><h3 id=lxc-란>LXC 란</h3><ul><li><a href=https://github.com/lxc/lxc>원문</a></li><li>2008년부터 개발 시작</li><li>분리된 커널을 돌리고 모든 하드웨어를 시뮬레이팅하는 것을 오버헤드 없이 하는 것을 목표로 함.</li><li>Unprivileged containers 는 어떠한 권한 없이 돌아가는 컨테이너를 의미.:<ul><li>UID와 GID를 격리</li><li>이를 위해서 서로 다른 범위를 사용. host의 100000번 이후를 0으로 내부적으로 매핑</li><li>이러한 것들은 몇가지 제약을 가져왔고 아래 3가지 setuid code를 이용해 이를 극복:<ul><li>lxc-user-nic</li><li>newuidmap</li><li>newgidmap</li></ul></li></ul></li><li>일반적으로 LXC의 목표는 커널상의 모든 보안 기능을 사용 가능하게 하는데에 있음. 이를 통해서 LXC는 그들의 요구에 따라 복잡하게 튜닝할수 있게 함.</li><li>LXC는 모든 권한 없이도 잘 돌아가지만 일반적으로 몇가지 유용한 것들은 꽤나 제한적임. 대표적인 2가지 문제는 Network와 Usernamespaces 임.:<ul><li>Network : host의 network namespace는 격리 수준을 낮추고 attack vector를 증가시킴. host와 container가 똑같은 network namespace를 사용한다는 것은 sysfs mount가 거부될수 있음을 의미함.</li><li>user namespaces는 보안 증가에는 효율적이지만 privileged helper에 의하지 않고 unprivileged 유저가 container에 그들의 uid를 매핑하는 게 허락되있음. POSIX 시스템에서는 65536 UIDs와 GIDs 로도 모든 기능을 사용 가능한게 보장되어 있음.</li></ul></li></ul><hr><h3 id=lxc가-namespace와-cgroup-을-어떻게-사용하는가>lxc가 namespace와 cgroup 을 어떻게 사용하는가:</h3><ul><li><a href=https://github.com/lxc/lxc/blob/a5e32dabc641ab5e8a04b3359bb2c61895684b77/src/lxc/start.c#L860>lxc_init 함수를 통해 lxc를 초기화 할때 cgroup_init을 호출한다.</a></li><li><a href=https://github.com/lxc/lxc/blob/97592484fa8f16fb354322b4b6c727450868a8f9/src/lxc/namespace.c#L38>lxc 는 권한 문제에서 자유로우면서도 안전하게 동작시키기 위해 lxc_namespace_t 를 추가로 선언해서 관리한다.</a></li></ul><hr><h3 id=docker는-lxc를-사용하는가>Docker는 LXC를 사용하는가?</h3><ul><li><a href=https://hwan-shell.tistory.com/116>docker와 container 차이 설명글</a></li><li>위 글에 따르면, libcontainer를 별도로 사용한다.</li><li>궁금점 : 그러면 lxc는 아무도 사용안하나?<ul><li>나는 지금 메인은 도커와 containerd 라고 생각하는데 containerd 도 <a href=https://github.com/containerd/cgroups>cgroup을 사용하기 위한 별도의 구현체</a> 가 있는 것으로 보아, 의존성 없이 kernel의 cgroup과 namespace을 직접 사용하는 것 같다.</li><li>lxc는 <a href=https://ubuntu.com/server/docs/containers-lxd>ubuntu lxd</a> 쪽에서만 자료가 좀 나온다.</li></ul></li></ul></div><hr><div class=list-files><ul class=section-tree></ul></div></article><script src=/js/wikilink.js></script><div><script src=https://utteranc.es/client.js repo=minuk-dev/minuk-dev.github.io issue-term=pathname theme=github-dark crossorigin=anonymous async></script></div></main><footer class=footer><div class=footer-left></div><div class=footer-right><ul class=social><li><a href=/about>About</a></li><li><a href=https://github.com/minuk-dev>Github</a></li></ul></div></footer></body><script src=/js/dir_toggle.js></script><script src=/js/codeblock_copy.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css><script type=module>
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs";
mermaid.initialize({
  startOnLoad: true,
  theme: "dark",
});
</script></html>
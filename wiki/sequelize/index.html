<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Sequelize</title><style>html body{font-family:raleway,sans-serif;background-color:#fff}:root{--accent:#00a3d2;--border-width:5px}</style><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/copy-btn.css><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script src=/js/copy-btn.js></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script>$(document).on("click",function(){$(".collapse").collapse("hide")})</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-98056974-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-98056974-1")</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><meta name=google-site-verification content="g_3tJyj-KkW-_wKx7Ij5GimHV1nKPZXetCz8ydbBAfA"></head><body><nav class="navbar navbar-default navbar-fixed-top"><div class=container><div class=navbar-header><a class="navbar-brand visible-xs" href=#>Sequelize
</a><button class=navbar-toggle data-target=.navbar-collapse data-toggle=collapse>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/wiki/>Wiki</a></li><li><a href=/posts/>Posts</a></li><li><a href=/about/>About</a></li></ul></div></div></nav><main><div class=navigator style=display:flex><div style=display:flex><div class=parent-doc style=flex:none><button class="btn btn-link" onclick='(function(e){e.querySelector("a").click()})(this)'>
<i class="fa fa-arrow-left"></i>
[[Javascript]]</button></div></div></div><div><h2>Sequelize</h2><a href=https://github.com/minuk-dev/minuk-dev.github.io/blame/master/content/wiki/Sequelize.md><h5>created : Tue, 07 Apr 2020 20:31:57 +0900</h5><h5>modified : Tue, 15 Mar 2022 02:41:22 +0900</h5></a><a href=https://minuk.dev/tags/js><kbd class=item-tag>js</kbd></a>
<a href=https://minuk.dev/tags/sequelize><kbd class=item-tag>sequelize</kbd></a></div><aside class=navbar id=nav-toc style=text-align:left><nav id=TableOfContents><ul><li><a href=#setting-up-a-connection>Setting up a connection</a></li><li><a href=#note-connection-pool-production>Note: connection pool (production)</a></li><li><a href=#testing-the-connection>Testing the connection</a></li></ul><ul><li><a href=#data-retrieval--finders>Data retrieval / Finders</a><ul><li><a href=#find---search-for-one-specific-element-in-the-database>find - Search for one specific element in the database</a></li><li><a href=#findandcountall---search-for-multiple-elements-in-the-database-returns-both-data-and-total-count>findAndCountAll - Search for multiple elements in the database, returns both data and total count</a></li><li><a href=#findall---search-for-multiple-elements-in-the-database>findAll - Search for multiple elements in the database</a></li><li><a href=#complex-filtering--or--not-queries>Complex filtering / OR / NOT queries</a></li></ul></li></ul></nav></aside><div align=start class=content data-spy=scroll data-offset=20 data-target=#nav-toc style=position:relative><h1 id=installation>Installation</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm install --save sequelize
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># One of the following</span>
</span></span><span style=display:flex><span>npm install --save pg pg-hstore <span style=color:#75715e># Postgres</span>
</span></span><span style=display:flex><span>npm install -save mysql2 <span style=color:#75715e># mysql</span>
</span></span><span style=display:flex><span>npm install --save mariadb <span style=color:#75715e># mariadb</span>
</span></span><span style=display:flex><span>npm install --save sqlite3 <span style=color:#75715e># sqlite</span>
</span></span><span style=display:flex><span>npm install --save tedious <span style=color:#75715e># Microsoft SQL Server</span>
</span></span></code></pre></div><h1 id=configuration-typescript>Configuration (Typescript)</h1><h2 id=setting-up-a-connection>Setting up a connection</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Sequelize</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;sequelize&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DBConfituration</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>database</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>user</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>password</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>host</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dialect</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;mysql&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;postgres&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;sqlite&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;mariadb&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;msqle&#34;</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dbConfiguration</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>DBConfiguration</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>database</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;graph&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>user</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;graph&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>password</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;graph&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>host</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;localhost&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dialect</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;mysql&#34;</span>
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sequelize</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Sequelize</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dbConfiguration</span>.<span style=color:#a6e22e>database</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dbConfiguration</span>.<span style=color:#a6e22e>user</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dbConfiguration</span>.<span style=color:#a6e22e>password</span>,
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>host</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>dbConfiguration</span>.<span style=color:#a6e22e>host</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dialect</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>dbConfgiguration</span>.<span style=color:#a6e22e>dialect</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sequelize</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Sequelize</span>(<span style=color:#e6db74>&#39;postgres://user:pass@example.con:5432/dbname&#39;</span>);
</span></span></code></pre></div><h2 id=note-connection-pool-production>Note: connection pool (production)</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sequelize</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Sequelize</span>(<span style=color:#75715e>/* ... */</span>, {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>pool</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>acquire</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30000</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>idle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10000</span>,
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=testing-the-connection>Testing the connection</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>sequelize</span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>authenticate</span>()
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>then</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Connection has been established successfully.&#39;</span>);
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>  .<span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>err</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;Unable to connect to the database:&#39;</span>, <span style=color:#a6e22e>err</span>);
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><ul><li>Sample Code (Typescript)</li></ul><h1 id=model-usage>Model usage</h1><h2 id=data-retrieval--finders>Data retrieval / Finders</h2><h3 id=find---search-for-one-specific-element-in-the-database>find - Search for one specific element in the database</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// search for known ids
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>Project</span>.<span style=color:#a6e22e>findByPk</span>(<span style=color:#ae81ff>123</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>project</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// project will be an instance of Project and stores the content of the table entry
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// with id 123. if such an entry is not defined you will get null
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// search for attributes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>Project</span>.<span style=color:#a6e22e>findOne</span>({ <span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;aProject&#39;</span>} }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>project</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// project will be the first entry of the Projects table with the title &#39;aProject&#39; || null
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Project</span>.<span style=color:#a6e22e>findOne</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;aProject&#39;</span>},
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>attributes</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;id&#39;</span>, [<span style=color:#e6db74>&#39;name&#39;</span>, <span style=color:#e6db74>&#39;title&#39;</span>]]
</span></span><span style=display:flex><span>}).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>project</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// project will be the first entry of the Projects table with the title &#39;aProject&#39; || null
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// project.get(&#39;title&#39;) will contain the name of the project
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>###</span> <span style=color:#a6e22e>findOrCreate</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>Search</span> <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>a</span> <span style=color:#a6e22e>specific</span> <span style=color:#a6e22e>element</span> <span style=color:#a6e22e>or</span> <span style=color:#a6e22e>create</span> <span style=color:#a6e22e>it</span> <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>not</span> <span style=color:#a6e22e>available</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>User</span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>findOrCreate</span>({<span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;sdepold&#39;</span>}, <span style=color:#a6e22e>defaults</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>job</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Technical Lead JavaScript&#39;</span>}})
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>then</span>(([<span style=color:#a6e22e>user</span>, <span style=color:#a6e22e>created</span>]) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>get</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>plain</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    }))
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>created</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>     findOrCreate returns an array containing the object that was found or created and a boolean that
</span></span></span><span style=display:flex><span><span style=color:#75715e>     will be true if a new object was created and false if not, like so:
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>    [ {
</span></span></span><span style=display:flex><span><span style=color:#75715e>        username: &#39;sdepold&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>        job: &#39;Technical Lead JavaScript&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>        id: 1,
</span></span></span><span style=display:flex><span><span style=color:#75715e>        createdAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET),
</span></span></span><span style=display:flex><span><span style=color:#75715e>        updatedAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET)
</span></span></span><span style=display:flex><span><span style=color:#75715e>      },
</span></span></span><span style=display:flex><span><span style=color:#75715e>      true ]
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e> In the example above, the array spread on line 3 divides the array into its 2 parts and passes them
</span></span></span><span style=display:flex><span><span style=color:#75715e>  as arguments to the callback function defined beginning at line 39, which treats them as &#34;user&#34; and
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &#34;created&#34; in this case. (So &#34;user&#34; will be the object from index 0 of the returned array and
</span></span></span><span style=display:flex><span><span style=color:#75715e>  &#34;created&#34; will equal &#34;true&#34;.)
</span></span></span><span style=display:flex><span><span style=color:#75715e>    */</span>
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>User</span>.<span style=color:#a6e22e>create</span>({ <span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;fnord&#39;</span>, <span style=color:#a6e22e>job</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;omnomnom&#39;</span> })
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>then</span>(() =&gt; <span style=color:#a6e22e>User</span>.<span style=color:#a6e22e>findOrCreate</span>({<span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;fnord&#39;</span>}, <span style=color:#a6e22e>defaults</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>job</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;something else&#39;</span>}}))
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>then</span>(([<span style=color:#a6e22e>user</span>, <span style=color:#a6e22e>created</span>]) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>get</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>plain</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    }))
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>created</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>    In this example, findOrCreate returns an array like this:
</span></span></span><span style=display:flex><span><span style=color:#75715e>    [ {
</span></span></span><span style=display:flex><span><span style=color:#75715e>        username: &#39;fnord&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>        job: &#39;omnomnom&#39;,
</span></span></span><span style=display:flex><span><span style=color:#75715e>        id: 2,
</span></span></span><span style=display:flex><span><span style=color:#75715e>        createdAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET),
</span></span></span><span style=display:flex><span><span style=color:#75715e>        updatedAt: Fri Mar 22 2013 21: 28: 34 GMT + 0100(CET)
</span></span></span><span style=display:flex><span><span style=color:#75715e>      },
</span></span></span><span style=display:flex><span><span style=color:#75715e>      false
</span></span></span><span style=display:flex><span><span style=color:#75715e>    ]
</span></span></span><span style=display:flex><span><span style=color:#75715e>    The array returned by findOrCreate gets spread into its 2 parts by the array spread on line 3, and
</span></span></span><span style=display:flex><span><span style=color:#75715e>    the parts will be passed as 2 arguments to the callback function beginning on line 69, which will
</span></span></span><span style=display:flex><span><span style=color:#75715e>    then treat them as &#34;user&#34; and &#34;created&#34; in this case. (So &#34;user&#34; will be the object from index 0
</span></span></span><span style=display:flex><span><span style=color:#75715e>    of the returned array and &#34;created&#34; will equal &#34;false&#34;.)
</span></span></span><span style=display:flex><span><span style=color:#75715e>    */</span>
</span></span><span style=display:flex><span>  })
</span></span></code></pre></div><h3 id=findandcountall---search-for-multiple-elements-in-the-database-returns-both-data-and-total-count>findAndCountAll - Search for multiple elements in the database, returns both data and total count</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>Project</span>
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>findAndCountAll</span>({
</span></span><span style=display:flex><span>     <span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>          [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>like</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;foo%&#39;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>     },
</span></span><span style=display:flex><span>     <span style=color:#a6e22e>offset</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>     <span style=color:#a6e22e>limit</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>result</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>count</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>rows</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>User</span>.<span style=color:#a6e22e>findAndCountAll</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>include</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>     { <span style=color:#a6e22e>model</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Profile</span>, <span style=color:#a6e22e>required</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span> }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>limit</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>User</span>.<span style=color:#a6e22e>findAndCountAll</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>include</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>     { <span style=color:#a6e22e>model</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Profile</span>, <span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>active</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span> }}
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>limit</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=findall---search-for-multiple-elements-in-the-database>findAll - Search for multiple elements in the database</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// find multiple entries
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>Project</span>.<span style=color:#a6e22e>findAll</span>().<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>projects</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// projects will be an array of all Project instances
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// search for specific attributes - hash usage
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>Project</span>.<span style=color:#a6e22e>findAll</span>({ <span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;A Project&#39;</span> } }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>projects</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// projects will be an array of Project instances with the specified name
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// search within a specific range
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>Project</span>.<span style=color:#a6e22e>findAll</span>({ <span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>] } }).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>projects</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// projects will be an array of Projects having the id 1, 2 or 3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// this is actually doing an IN query
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Project</span>.<span style=color:#a6e22e>findAll</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>and</span>]<span style=color:#f92672>:</span> {<span style=color:#a6e22e>a</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span>},           <span style=color:#75715e>// AND (a = 5)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>or</span>]<span style=color:#f92672>:</span> [{<span style=color:#a6e22e>a</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span>}, {<span style=color:#a6e22e>a</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>6</span>}],  <span style=color:#75715e>// (a = 5 OR a = 6)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>gt</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>6</span>,                <span style=color:#75715e>// id &gt; 6
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>gte</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>6</span>,               <span style=color:#75715e>// id &gt;= 6
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>lt</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,               <span style=color:#75715e>// id &lt; 10
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>lte</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,              <span style=color:#75715e>// id &lt;= 10
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>ne</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span>,               <span style=color:#75715e>// id != 20
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>between</span>]<span style=color:#f92672>:</span> [<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>10</span>],     <span style=color:#75715e>// BETWEEN 6 AND 10
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>notBetween</span>]<span style=color:#f92672>:</span> [<span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>15</span>], <span style=color:#75715e>// NOT BETWEEN 11 AND 15
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#66d9ef>in</span>]<span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>],           <span style=color:#75715e>// IN [1, 2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>notIn</span>]<span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>],        <span style=color:#75715e>// NOT IN [1, 2]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>like</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;%hat&#39;</span>,         <span style=color:#75715e>// LIKE &#39;%hat&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>notLike</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;%hat&#39;</span>,       <span style=color:#75715e>// NOT LIKE &#39;%hat&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>iLike</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;%hat&#39;</span>,         <span style=color:#75715e>// ILIKE &#39;%hat&#39; (case insensitive)  (PG only)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>notILike</span>]<span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;%hat&#39;</span>,      <span style=color:#75715e>// NOT ILIKE &#39;%hat&#39;  (PG only)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>overlap</span>]<span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>],       <span style=color:#75715e>// &amp;&amp; [1, 2] (PG array overlap operator)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>contains</span>]<span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>],      <span style=color:#75715e>// @&gt; [1, 2] (PG array contains operator)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>contained</span>]<span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>],     <span style=color:#75715e>// &lt;@ [1, 2] (PG array contained by operator)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>any</span>]<span style=color:#f92672>:</span> [<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>]            <span style=color:#75715e>// ANY ARRAY[2, 3]::INTEGER (PG only)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>status</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>not</span>]<span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>           <span style=color:#75715e>// status NOT FALSE
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h3 id=complex-filtering--or--not-queries>Complex filtering / OR / NOT queries</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>Project</span>.<span style=color:#a6e22e>findOne</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;a project&#39;</span>,
</span></span><span style=display:flex><span>    [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>or</span>]<span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>] },
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> { [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>gt</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span> } }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Project</span>.<span style=color:#a6e22e>findOne</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>where</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;a project&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>or</span>]<span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>        [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>],
</span></span><span style=display:flex><span>        { [<span style=color:#a6e22e>Op</span>.<span style=color:#a6e22e>gt</span>]<span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span> }
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>})
</span></span></code></pre></div></div><script src=/js/wikilink.js></script><div><script src=https://utteranc.es/client.js repo=minuk-dev/minuk-dev.github.io issue-term=pathname theme=github-dark crossorigin=anonymous async></script></div></main><footer class=footer><div class=footer-left></div><div class=footer-right><ul class=social><li><a href=/about>About</a></li><li><a href=https://github.com/minuk-dev>Github</a></li></ul></div></footer>
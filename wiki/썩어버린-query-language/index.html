<!doctype html><html lang=ko-kr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>썩어버린 Query Language</title><style>html body{font-family:raleway,sans-serif;background-color:#fff}:root{--accent: #00a3d2;--border-width:  5px }</style><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/copy-btn.css><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script src=/js/copy-btn.js></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script>$(document).on('click',function(){$('.collapse').collapse('hide');})</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-98056974-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-98056974-1');</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><meta name=google-site-verification content="g_3tJyj-KkW-_wKx7Ij5GimHV1nKPZXetCz8ydbBAfA"></head><body><nav class="navbar navbar-default navbar-fixed-top"><div class=container><div class=navbar-header><a class="navbar-brand visible-xs" href=#>썩어버린 Query Language</a>
<button class=navbar-toggle data-target=.navbar-collapse data-toggle=collapse>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/wiki/>Wiki</a></li><li><a href=/posts/>Posts</a></li><li><a href=/about/>About</a></li></ul><ul class="nav navbar-nav navbar-right"><li class=navbar-icon><a href=mailto:makerdark98@gmail.com><i class="fa fa-envelope-o"></i></a></li><li class=navbar-icon><a href=https://github.com/makerdark98/><i class="fa fa-github"></i></a></li><li><div style=max-width:250px;display:inline-block;max-height:40px><script async src="https://cse.google.com/cse.js?cx=003491619885022567520:wnnypdnx4aj"></script><div class=gcse-search></div></div></li></ul></div></div></nav><main><div class=navigator style=display:flex><div style=display:flex><a href=/wiki/><button class="btn btn-link"><i class="fa fa-arrow-left"></i>&nbsp;Front Page</button></a></div><div style=margin-left:auto><div style=display:flex><div style=margin-left:auto><div class=wiki-history></div></div></div><script src=/js/localhistory.js></script><script>var now="썩어버린 Query Language"
pushHistory(now);</script></div></div><div><h2>썩어버린 Query Language</h2><a href=https://github.com/makerdark98/makerdark98.github.io/blame/master/src/content/wiki/%ec%8d%a9%ec%96%b4%eb%b2%84%eb%a6%b0%20Query%20Language.md><h5>created : Tue, 07 Apr 2020 20:18:38 +0900</h5><h5>modified : Wed, 08 Apr 2020 12:44:29 +0900</h5></a></div><aside class=navbar id=nav-toc style=text-align:left><nav id=TableOfContents><ul><li><a href=#데이터베이스의-역사>데이터베이스의 역사</a></li><li><a href=#query-optimizer>Query Optimizer</a></li></ul><ul><li><a href=#썩었다>썩었다?</a></li><li><a href=#우리도-한번-고이는-것-정도는-해보자>우리도 한번 고이는 것 정도는 해보자</a></li></ul><ul><li><a href=#index란>Index란?</a></li><li><a href=#이런-쿼리는-가급적-쓰지-말자>이런 쿼리는 가급적 쓰지 말자</a></li><li><a href=#쿼리-최적화의-좋은-예시>쿼리 최적화의 좋은 예시</a></li><li><a href=#pagination-이야기-row-lookup>Pagination 이야기 (Row lookup)</a></li></ul><ul><li><a href=#막간을-이용한-책팔이>막간을 이용한 책팔이</a></li></ul></nav></aside><div align=start class=content data-spy=scroll data-offset=20 data-target=#nav-toc style=position:relative><h1 id=-1-sql-structured-query-language># 1. SQL (Structured Query Language)?</h1><ul><li>관계형 데이터베이스들에서 원하는 데이터를 가져오기 위한 언어</li><li>우리는 왜 이걸 사용하고 있을까?</li></ul><h2 id=데이터베이스의-역사>데이터베이스의 역사</h2><ul><li>관계형 데이터베이스가 데이터베이스 전쟁의 승자이기 때문이다.</li><li>계층형 데이터베이스를 비롯한 수많은 종류들의 데이터베이스가 있었으나 문제들이 많아 점점 관계형 데이터베이스들만이 살아남았다. (대부분 성능상의 문제)</li><li>관계형이 살아남은 이유는 질의 최적화기 (query optimizer)이다.</li></ul><h2 id=query-optimizer>Query Optimizer</h2><ul><li>쿼리를 최적화해주는 무언가</li><li>이걸 발전시키기 위해 수많은 연구가 진행되어 현재의 성능을 가지게 된다.</li><li>그럴려면 구조화된 query 언어가 필요하고 이게 현재 사용하는 SQL이다.</li></ul><p><img src=https://www.researchgate.net/profile/Martin_Boissier/publication/332803446/figure/fig2/AS:754092716593152@1556801122020/The-different-steps-of-the-SQL-Pipeline-leading-from-an-SQL-string-to-executable.png alt=https://www.researchgate.net/profile/Martin_Boissier/publication/332803446/figure/fig2/AS:754092716593152@1556801122020/The-different-steps-of-the-SQL-Pipeline-leading-from-an-SQL-string-to-executable.png></p><h1 id=2-썩어버린-query-language>2. 썩어버린 query language</h1><h2 id=썩었다>썩었다?</h2><ul><li>흔히 고인물들을 보고 고이다못해 썩어버렸다는 말을 쓴다.</li><li>지금 SQL이 그러하다. 썩어버리지 않는다면 DB의 최고성능을 끌어올리기 힘들다.</li></ul><h2 id=우리도-한번-고이는-것-정도는-해보자>우리도 한번 고이는 것 정도는 해보자</h2><ul><li>Index만 알아도 사실 고이는건 쌉가능이다.</li><li>기왕이면 partitioning, sharding 정도는 알고 있자</li></ul><h1 id=3-index>3. Index</h1><h2 id=index란>Index란?</h2><ul><li>데이터를 나타낼수 있는 key (Search Key)</li><li>일반적으로는 Tree (대부분의 경우 B-Tree), 간혹 Hash Table을 사용한다.</li><li>B-Tree</li></ul><p><img src=https://www.lucidchart.com/publicSegments/view/08895b1f-2111-4790-a99e-e5d9b101f7a3/image.png alt=https://www.lucidchart.com/publicSegments/view/08895b1f-2111-4790-a99e-e5d9b101f7a3/image.png></p><h2 id=이런-쿼리는-가급적-쓰지-말자>이런 쿼리는 가급적 쓰지 말자</h2><ul><li>물론 기능상 필요하고, 정말 가끔 도는 쿼리면 큰 문제 없다.</li><li>like 가 덕지덕지 붙은 query</li><li>index를 타지 않고 Full Scan 하는 query</li></ul><h2 id=쿼리-최적화의-좋은-예시>쿼리 최적화의 좋은 예시</h2><p><img src=https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9371e4ab-2f42-4c84-b00c-d55cb91399c4/Untitled.png alt=https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9371e4ab-2f42-4c84-b00c-d55cb91399c4/Untitled.png></p><h2 id=pagination-이야기-row-lookup>Pagination 이야기 (Row lookup)</h2><ul><li>다들 게시판 또는 일부 데이터만을 구현할 떄 뒷 페이지로 갈수록 느려지는 느낌을 못받으시나요?</li></ul><p><img src=https://s3-us-west-2.amazonaws.com/secure.notion-static.com/07984ce2-565f-42a0-ac02-77bda9c5ab00/Untitled.png alt=https://s3-us-west-2.amazonaws.com/secure.notion-static.com/07984ce2-565f-42a0-ac02-77bda9c5ab00/Untitled.png></p><pre><code>SELECT id, xValue, yValue, zValue, createdAt
FROM Position
LIMIT 2000000, 1000

SELECT id, xValue, yValue, zValue, createdAt
FROM (
    SELECT id
    FROM Position
    LIMIT 2000000, 1000
) q
JOIN Position p
ON p.id = q.id
</code></pre><h1 id=4-sql이-항상-db에서-무언가를-조회할-최선은-아니다-nosql---not-only-sql>4. SQL이 항상 DB에서 무언가를 조회할 최선은 아니다. (NoSQL - Not only SQL)</h1><ul><li><p>임피던스 불일치(Impedance Mismatch)에 지친 개발자들&mldr;</p><p><img src=https://s3-us-west-2.amazonaws.com/secure.notion-static.com/632fa9df-3893-4a59-92e4-068f80f6d0a9/Untitled.png alt=https://s3-us-west-2.amazonaws.com/secure.notion-static.com/632fa9df-3893-4a59-92e4-068f80f6d0a9/Untitled.png></p></li><li><p>위와 같이 다른것들도 고려는 해보자(?)</p></li></ul><h1 id=5-잡설>5. 잡설</h1><ul><li>주변에서 워낙 Spring을 사용하니 종종 부딪히는 문제들이 눈에 보인다.</li><li>다음을 검색해서 해결하길 바란다.<ul><li>PreparedStatement 와 Statement의 차이</li><li>FetchSize, Cursor의 개념</li><li>Rule Hint</li></ul></li><li>발표자들은 보통 항상 발표시간이 아쉽다. 오랜시간 공부한걸 발표시간 내에 모두 전달할수 없다. 각자 찾아보자</li></ul><h2 id=막간을-이용한-책팔이>막간을 이용한 책팔이</h2><p>오늘 발표 내용의 대부분은 아래 책의 12개의 챕터 중 1/2 챕터 분량밖에 안된다. 강추</p><p><a href=http://www.yes24.com/Product/Goods/59566585>데이터 중심 애플리케이션 설계</a></p><h1 id=references>References</h1><ul><li>역사 및 대부분의 개념 출처<ul><li>데이터 중심 어플리케이션 설계 (Designing Data-Intensive Applications)</li></ul></li><li>인덱스 개념 및 그림 출처</li></ul><p><a href=https://d2.naver.com/helloworld/1155>NAVER D2</a></p><p><a href=https://chartworld.tistory.com/18>[DB개념] :: Index Structures (인덱스 구조)</a></p><p><a href=https://velog.io/@litien/%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9DPartitioning>파티셔닝(Partitioning)</a></p><ul><li>Row lookup</li></ul><p><a href=https://blog.lulab.net/database/optimize-pagination-sql-by-join-instead-of-limit/#fn:2>Pagination을 위한 최적화 SQL (LIMIT vs JOIN)</a></p><ul><li>NoSQL</li></ul><p><a href=https://en.wikipedia.org/wiki/NoSQL>NoSQL</a></p></div><script src=/js/wikilink.js></script><div><script src=https://utteranc.es/client.js repo=makerdark98/makerdark98.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></main><footer><p class="copyright text-muted">© All rights reserved. Powered by <a href=https://gohugo.io>Hugo</a> and <a href=https://github.com/calintat/minimal>Minimal</a>.</p></footer></body></html>